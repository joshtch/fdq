"use strict";function _toConsumableArray(r){if(Array.isArray(r)){for(var e=0,n=Array(r.length);e<r.length;e++)n[e]=r[e];return n}return Array.from(r)}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function r(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},FDQ=function(){function r(r,e,n){return r|(1<<1+(0|n)-(0|e))-1<<e}function e(r,e){return"number"==typeof r?n(r,e):i(r,e)}function n(r,e){return r>=so?t(r,e):a(r,e)}function t(r,e){return(r^so)===e}function a(r,e){return!(e<Zi||e>uo)&&0!=(r&1<<e)}function i(r,e){return o(r,e)!==eo}function o(r,e){for(var n=r.length,t=0;t<n&&l(r,t)<=e;t+=Gi)if(l(r,t+Wi)>=e)return t;return eo}function u(r){return"number"==typeof r?s(r):v(r)}function s(r){return r>=so?f(r):c(r)}function f(r){return r^so}function c(r){var e=ur(r);return r===1<<e?e:io}function v(r){if(r.length!==Gi)return io;var e=l(r,ji);return e===l(r,Pi)?e:io}function l(r,e){return r.charCodeAt(e)<<16|r.charCodeAt(e+1)}function d(r){return String.fromCharCode(r>>>16&65535,65535&r)}function p(r,e){return String.fromCharCode(r>>>16&65535,65535&r,e>>>16&65535,65535&e)}function h(r){if(!r.length)return[];(r=r.slice(0)).sort(function(r,e){return r-e});for(var e=[],n=void 0,t=void 0,a=0;a<r.length;a++){var i=r[a];0===a?(t=i,n=i):(i>n+1&&(e.push(t,n),t=i),n=i)}return e.push(t,n),e}function g(r){return"number"==typeof r?m(r):y(r)}function m(r){return r>=so?b(r):k(r)}function b(r){return[r^so]}function k(r){for(var e=[],n=0;n<uo;++n)(r&1<<n>>>0)>0&&e.push(n);return e}function y(r){for(var e=[],n=0,t=r.length;n<t;n+=Gi)for(var a=l(r,n),i=l(r,n+Wi);a<=i;++a)e.push(a);return e}function x(r,e){return"number"==typeof r?_(r,e):E(r,e)}function _(r,e){return r>=so?w(r,e):S(r,e)}function w(r,e){var n=r^so;return e.indexOf(n)>=0?n:io}function S(r,e){for(var n=0;n<e.length;++n){var t=e[n];if(t<=uo&&(r&1<<t)>0)return t}return io}function E(r,e){for(var n=0;n<e.length;n++){var t=e[n];if(i(r,t))return t}return io}function A(r){return r?r.length===Gi?de(r):(r=N(r),r=D(r),de(r)):Qi}function N(r){if(!r)return Xi;var e=r.length;if(e<=Gi)return r;for(var n=l(r,0),t=l(r,0+Wi),a=Xi,i=Xi,o=Gi;o<e;o+=Gi){var u=l(r,o);u<n||u===n&&l(r,o+Wi)<t?a+=r[o]+r[o+1]+r[o+2]+r[o+3]:i+=r[o]+r[o+1]+r[o+2]+r[o+3]}return""+N(a)+r[0]+r[1]+r[0+Wi]+r[0+Wi+1]+N(i)}function D(r){if(!r)return Xi;var e=r.length;if(e===Gi)return r;for(var n=r[ji]+r[ji+1],t=l(r,Pi),a=Pi,i=Gi;i<e;i+=Gi){var o=l(r,i),u=l(r,i+Wi);o<=t+1?u>t&&(t=u,a=i+Wi):(n+=r[a]+r[a+1]+r[i]+r[i+1],t=u,a=i+Wi)}return n+r[a]+r[a+1]}function C(r,e){if(r===e)return r;var n="number"==typeof r,t="number"==typeof e;return n&&t?O(r,e):n?R(r,e):t?R(e,r):B(r,e)}function O(r,e){var n=e>=so;return r>=so?n?M(r,e):V(r,e):n?V(e,r):T(r,e)}function V(r,e){var n=r^so;return n<=uo&&e&1<<n?r:Qi}function M(r,e){return r===e?r:Qi}function T(r,e){return ge(r&e)}function R(r,e){return r>=so?q(r,e):L(r,e)}function q(r,e){for(var n=r^so,t=0,a=e.length;t<a;t+=Gi){var i=l(e,t),o=l(e,t+Wi);if(n<i)break;if(n<=o)return r}return Qi}function L(r,e){for(var n=Qi,t=0,a=e.length;t<a;t+=Gi){var i=l(e,t);if(i>uo)break;for(var o=l(e,t+Wi),u=i,s=$i(uo,o);u<=s;++u){var f=1<<u;r&f&&(n|=f)}}return ge(n)}function B(r,e){var n=r.length,t=e.length;if(0==(n|t))return Qi;for(var a=Xi,i=0,o=0,u=l(r,ji),s=l(r,Pi),f=l(e,ji),c=l(e,Pi);;)if(s<f){if((i+=Gi)>=n)break;u=l(r,i),s=l(r,i+Wi)}else if(c<u){if((o+=Gi)>=t)break;f=l(e,o),c=l(e,o+Wi)}else{var v=$i(s,c);if(a+=p(zi(u,f),v),v+=2,u=f=v,s<v){if((i+=Gi)>=n)break;u=l(r,i),s=l(r,i+Wi)}if(c<v){if((o+=Gi)>=t)break;f=l(e,o),c=l(e,o+Wi)}}return a===Xi?Qi:de(a)}function I(r,n){return e(r,n)?Yr(n):re()}function U(r){return"number"==typeof r?r>=so?"soldom(["+(r^so)+","+(r^so)+"])":"numdom(["+ae(r)+"])":"string"==typeof r?"strdom(["+ue(r)+"])":r instanceof Array?"arrdom(["+r+"])":"???dom("+r+")"}function F(r,e){if(r&&e){var n=void 0;do{if(n=0,r.length>Gi){var t=j(r,P(e));n+=r.length-t.length,r=t}if(e.length>Gi){var a=j(e,P(r));n+=e.length-a.length,e=a}}while(0!==n)}return[r,e]}function j(r,e){for(var n=r[ji]+r[ji+1],t=l(r,Pi),a=Pi,i=Gi,o=r.length;i<o;i+=Gi){var u=l(r,i),s=l(r,i+Wi);u-t>e&&(n+=r[a]+r[a+1]+r[i]+r[i+1]),t=s,a=i+Wi}return n+=r[a]+r[a+1]}function P(r){for(var e=ro,n=0,t=r.length;n<t;n+=Gi){var a=l(r,n),i=1+l(r,n+Wi)-a;i<e&&(e=i)}return e}function $(r,e){return"number"==typeof r&&(r=fe(r)),"number"==typeof e&&(e=fe(e)),z(r,e)}function z(r,e){for(var n=Xi,t=0,a=r.length;t<a;t+=Gi)n+=H(e,l(r,t),l(r,t+Wi));return A(n)}function H(r,e,n){for(var t=Xi,a=0,i=r.length;a<i;a+=Gi){var o=l(r,a),u=l(r,a+Wi);t+=p($i(ro,e*o),$i(ro,n*u))}return t}function J(r,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return"number"==typeof r&&(r=fe(r)),"number"==typeof e&&(e=fe(e)),W(r,e,n)}function W(r,e){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],t=Xi,a=0,i=e.length;a<i;a+=Gi)t+=G(r,l(e,a),l(e,a+Wi),n);return A(t)}function G(r,e,n,t){for(var a=Xi,i=0,o=r.length;i<o;i+=Gi){var u=l(r,i),s=l(r,i+Wi);if(n>0){var f=u/n,c=e>0?s/e:ro,v=Ji(f),d=Hi(c);v<=d?a+=p(v,d):t&&(a+=p(d,d))}}return a}function Q(r,e){return"number"==typeof r&&(r=fe(r)),"number"==typeof e&&(e=fe(e)),X(r,e)}function X(r,e){for(var n=Xi,t=0,a=e.length;t<a;t+=Gi)n+=Y(r,l(e,t),l(e,t+Wi));return A(n)}function Y(r,e,n){for(var t=Xi,a=0,i=r.length;a<i;a+=Gi){var o=l(r,a),u=l(r,a+Wi),s=n?o/n:Zi,f=e?u/e:ro,c=Ji(s),v=Hi(f);c<=v&&(t+=p(c,v))}return t}function K(r){return"number"==typeof r?Z(r):er(r)}function Z(r){return r>=so?1:rr(r)}function rr(r){switch(r){case 0:return 0;case 1:case 2:return 1;case 3:return 2}return(1&r)+(r>>1&1)+(r>>2&1)+(r>>3&1)+(r>>4&1)+(r>>5&1)+(r>>6&1)+(r>>7&1)+(r>>8&1)+(r>>9&1)+(r>>10&1)+(r>>11&1)+(r>>12&1)+(r>>13&1)+(r>>14&1)+(r>>15&1)+(r>>16&1)+(r>>17&1)+(r>>18&1)+(r>>19&1)+(r>>20&1)+(r>>21&1)+(r>>22&1)+(r>>23&1)+(r>>24&1)+(r>>25&1)+(r>>26&1)+(r>>27&1)+(r>>28&1)+(r>>29&1)+(r>>30&1)+(r>>31&1)|0}function er(r){for(var e=0,n=0,t=r.length;n<t;n+=Gi)e+=1+l(r,n+Wi)-l(r,n);return e}function nr(r){if("number"==typeof r){if(r>=so)return r^so;r=fe(r)}return tr(r)}function tr(r){if(!r)return io;for(var e=er(r),n=Hi(e/2),t=void 0,a=void 0,i=0,o=r.length;i<o;i+=Gi){t=l(r,i);var u=1+(a=l(r,i+Wi))-t;if(n<u)break;n-=u}return t+n}function ar(r){return"number"==typeof r?ir(r):sr(r)}function ir(r){return r>=so?or(r):ur(r)}function or(r){return r^so}function ur(r){if(1==(0|r))return 0;if(2==(0|r))return 1;if(3==(0|r))return 0;switch((r&-r)%37|0){case 0:return-1;case 1:return 0;case 2:return 1;case 3:return 26;case 4:return 2;case 5:return 23;case 6:return 27;case 7:return 0;case 8:return 3;case 9:return 16;case 10:return 24;case 11:return 30;case 12:return 28;case 13:return 11;case 14:return 0;case 15:return 13;case 16:return 4;case 17:return 7;case 18:return 17;case 19:return 0;case 20:return 25;case 21:return 22;case 22:return-1;case 23:return 15;case 24:return 29;case 25:return 10;case 26:return 12;case 27:return 6;case 28:return 0;case 29:return 21;case 30:return 14;case 31:return 9;case 32:return 5;case 33:return 20;case 34:return 8;case 35:return 19}return 18}function sr(r){return r?l(r,ji):io}function fr(r){return"number"==typeof r?cr(r):dr(r)}function cr(r){return r>=so?vr(r):lr(r)}function vr(r){return r^so}function lr(r){var e=30;switch(0|r){case 0:return-1;case 1:return 0;case 2:case 3:return 1}do{if(r&1<<e)break;e=e-1|0}while((0|e)>=0);return 0|e}function dr(r){return r?l(r,r.length-Wi):io}function pr(r){var e=r.length;return 0===e?io:r[e-1]}function hr(r){return"number"==typeof r&&r>=so}function gr(r){return void 0===Yi&&(Yi=Yr(0)),r===Yi}function mr(r){return!br(r)}function br(r){return 0===ar(r)}function kr(r){return void 0===Ki&&(Ki=Kr(0,1)),r===Ki}function yr(r){return xr(r)&&2===K(r)}function xr(r){return kr(r)||!gr(r)&&br(r)}function _r(r,e){return e?Lr(r,0):qr(r,0)}function wr(r){return r===Qi}function Sr(r,e){return"number"==typeof r?Er(r,e):Dr(r,e)}function Er(r,e){return r>=so?Ar(r,e):ge(Nr(r,e))}function Ar(r,e){return(r^so)>=e?Qi:r}function Nr(r,e){switch(e){case 0:return 0;case 1:return 1&r;case 2:return 3&r;case 3:return 7&r;case 4:return 15&r;case 5:return 31&r;case 6:return 63&r;case 7:return 127&r;case 8:return 255&r;case 9:return 511&r;case 10:return 1023&r;case 11:return 2047&r;case 12:return 4095&r;case 13:return 8191&r;case 14:return 16383&r;case 15:return 32767&r;case 16:return 65535&r;case 17:return 131071&r;case 18:return 262143&r;case 19:return 524287&r;case 20:return 1048575&r;case 21:return 2097151&r;case 22:return 4194303&r;case 23:return 8388607&r;case 24:return 16777215&r;case 25:return 33554431&r;case 26:return 67108863&r;case 27:return 134217727&r;case 28:return 268435455&r;case 29:return 536870911&r;case 30:return 1073741823&r}return r}function Dr(r,e){for(var n=0,t=r.length;n<t;n+=Gi){var a=l(r,n),i=l(r,n+Wi);if(a>=e)return n?de(r.slice(0,n)):Qi;if(e<=i){if(0===n&&e===a+1){var o=r.slice(0,Wi);return de(o+o)}return de(r.slice(0,n+Wi)+d(e-1))}}return r}function Cr(r,e){return"number"==typeof r?Or(r,e):Tr(r,e)}function Or(r,e){return r>=so?Vr(r,e):de(Mr(r,e))}function Vr(r,e){return(r^so)<=e?Qi:r}function Mr(r,e){switch(e){case 0:return 2147483646&r;case 1:return 2147483644&r;case 2:return 2147483640&r;case 3:return 2147483632&r;case 4:return 2147483616&r;case 5:return 2147483584&r;case 6:return 2147483520&r;case 7:return 2147483392&r;case 8:return 2147483136&r;case 9:return 2147482624&r;case 10:return 2147481600&r;case 11:return 2147479552&r;case 12:return 2147475456&r;case 13:return 2147467264&r;case 14:return 2147450880&r;case 15:return 2147418112&r;case 16:return 2147352576&r;case 17:return 2147221504&r;case 18:return 2146959360&r;case 19:return 2146435072&r;case 20:return 2145386496&r;case 21:return 2143289344&r;case 22:return 2139095040&r;case 23:return 2130706432&r;case 24:return 2113929216&r;case 25:return 2080374784&r;case 26:return 2013265920&r;case 27:return 1879048192&r;case 28:return 1610612736&r;case 29:return 1073741824&r;case 30:return 0}return e<0?r:0}function Tr(r,e){for(var n=0,t=r.length;n<t;n+=Gi){var a=l(r,n),i=l(r,n+Wi);if(a>e)return de(n?r.slice(n):r);if(i===e)return n>=t-Gi?Qi:de(r.slice(n+Gi));if(e<=i)return de(d(e+1)+r.slice(n+Wi))}return Qi}function Rr(r,e){return e<=Zi?r:e>ro?re():Cr(r,e-1)}function qr(r,e){return e>=ro?r:e<Zi?re():Sr(r,e+1)}function Lr(r,e){return"number"==typeof r?Br(r,e):de(Fr(r,e))}function Br(r,e){return r>=so?Ir(r,e):Ur(r,e)}function Ir(r,e){return e===(r^so)?Qi:r}function Ur(r,e){if(e>30)return de(r);var n=1<<e;return ge((r|n)^n)}function Fr(r,e){for(var n=-1,t=-1,a=0,i=r.length;a<i;a+=Gi){var o=l(r,a);if(e<o)break;var u=l(r,a+Wi);if(e<=u)return jr(r,i,a,o,u,e,n,t);n=o,t=u}return r}function jr(r,e,n,t,a,i,o,u){if(e===Gi){if(a-t==1)return((t===i?a:t)|so)>>>0;if(t===a)return Qi}else if(n&&e===2*Gi&&t===a&&o===u)return(o|so)>>>0;if(n===e-Gi&&i===a){if(t===a&&u<=uo){var s=e-Gi;return be(r.slice(0,s),s)}if(a-1<=uo)return be(r.slice(0,-Wi)+d(a-1),e)}var f=r.slice(0,n),c=r.slice(n+Gi);return a===i?t===i?f+c:f+p(t,a-1)+c:t===i?f+p(t+1,a)+c:f+p(t,i-1)+p(i+1,a)+c}function Pr(r,e){var n="number"==typeof r,t="number"==typeof e;return n&&t?$r(r,e):n?Wr(r,e):t?Wr(e,r):Xr(r,e)}function $r(r,e){return r>=so?e>=so?zr(r,e):Hr(r,e):e>=so?Hr(e,r):Jr(r,e)}function zr(r,e){return r!==e}function Hr(r,e){var n=r^so;return n>uo||0==(e&1<<n)}function Jr(r,e){return 0==(r&e)}function Wr(r,e){return r>=so?Gr(r,e):Qr(r,e)}function Gr(r,e){for(var n=r^so,t=0,a=e.length;t<a;t+=Gi){var i=l(e,t),o=l(e,t+Wi);if(n<i)return!0;if(n<=o)return!1}return!0}function Qr(r,e){for(var n=0,t=e.length,a=0;a<=uo;++a)if(r&1<<a){for(;n<t;){var i=l(e,n),o=l(e,n+Wi);if(a>=i&&a<=o)return!1;if(i>uo)return!0;if(i>a)break;n+=Gi}if(n>=t)return!0}return!0}function Xr(r,e){for(var n=r.length,t=e.length,a=0,i=0,o=l(r,ji),u=l(r,Pi),s=l(e,ji),f=l(e,Pi);;)if(u<s){if((a+=Gi)>=n)break;o=l(r,a),u=l(r,a+Wi)}else{if(!(f<o))return!1;if((i+=Gi)>=t)break;s=l(e,i),f=l(e,i+Wi)}return!0}function Yr(r){return(r|so)>>>0}function Kr(r,e){return r===e?Yr(r):e<=uo?Zr(r,e):p(r,e)}function Zr(r,e){return(1<<1+e-r)-1<<r}function re(){return Qi}function ee(r){return 0===r?Yr(0):1===r?Kr(0,1):ke([0,0,r,r])}function ne(r){return r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16}function te(r,e){return"number"==typeof r?ae(r):"string"==typeof r?ue(r):e?r.slice(0):r}function ae(r){return r>=so?ie(r):oe(r)}function ie(r){var e=r^so;return[e,e]}function oe(r){if(r===Qi)return[];var e=[],n=-1,t=-1;if(1&r&&(n=0,t=0),2&r&&(0!==n&&(n=1),t=1),4&r&&(0===t?(e.push(0,0),n=2):1!==t&&(n=2),t=2),8&r&&(t<0?n=3:2!==t&&(e.push(n,t),n=3),t=3),r>=16)for(var a=4;a<=uo;++a)r&1<<a&&(t<0?n=a:t!==a-1&&(e.push(n,t),n=a),t=a);return e.push(n,t),e}function ue(r){if(r===Qi)return[];for(var e=[],n=0,t=r.length;n<t;n+=Gi){var a=l(r,n),i=l(r,n+Wi);e.push(a,i)}return e}function se(r){return"number"==typeof r?fe(r):"string"==typeof r?r:le(r)}function fe(r){return r>=so?ce(r):ve(r)}function ce(r){var e=r^so;return p(e,e)}function ve(r){if(r===Qi)return Xi;var e=Xi,n=-1,t=-1;if(1&r&&(n=0,t=0),2&r&&(0!==n&&(n=1),t=1),4&r&&(0===t?(e=p(0,0),n=2):1!==t&&(n=2),t=2),8&r&&(t<0?n=3:2!==t&&(e+=p(n,t),n=3),t=3),r>=16)for(var a=4;a<=uo;++a)r&1<<a&&(t<0?n=a:t!==a-1&&(e+=p(n,t),n=a),t=a);return e+=p(n,t)}function le(r){for(var e=Xi,n=0,t=r.length;n<t;n+=oo)e+=p(r[n],r[n+1]);return e}function de(r){return"number"==typeof r?he(r):me(r)}function pe(r){return r instanceof Array&&(r=le(r)),de(r)}function he(r){return r>=so?r:ge(r)}function ge(r){var e=u(r);return e===io?r:Yr(e)}function me(r){var e=r.length;if(!e)return Qi;var n=l(r,0),t=l(r,e-Wi);return e===Gi&&n===t?Yr(n):t<=uo?be(r,e):r}function be(e,n){if(0===n)return Qi;for(var t=l(e,0),a=l(e,0+Wi),i=r(Qi,t,a),o=Gi;o<n;o+=Gi)i=r(i,l(e,o),l(e,o+Wi));return i}function ke(r){var e=r.length;return 0===e?Qi:e===oo&&r[0]===r[1]?Yr(r[0]):pr(r)<=uo?ye(r,e):le(r)}function ye(e,n){for(var t=0,a=0;a<n;a+=oo)t=r(t,e[a],e[a+1]);return t}function xe(r,e){if(!r)return Qi;if(!e)return Qi;if(0===ar(r)&&0===ar(e))return Kr(0,fr(r));var n="number"==typeof e;if("number"==typeof r){if(n)return de(we(r,e));var t=de(Ee(r,e));return t===Xi?Qi:t}var a=void 0,i=de(A(a=n?De(r,e):_e(r,e)));return i===Xi?Qi:i}function _e(r,e){var n=F(r,e);r=n[0],e=n[1];for(var t=Xi,a=0,i=r.length;a<i;a+=Gi)t+=Oe(l(r,a),l(r,a+Wi),e);return t}function we(r,e){if(r>=so){var n=r^so;if(e>=so){var t=n-(e^so);return t<0?Qi:Yr(t)}return n<=uo?Ne(n,n,e):Ce(n,n,e)}return Se(r,e)}function Se(r,e){if(n(r,0)&&n(e,0))return ne(r);for(var t=0;0==(r&1<<t);)++t;for(var a=t,i=t,o=1<<++t,u=Qi;o<=r&&t<=uo;)(o&r)>0&&(i!==t-1&&(u|=Ne(a,i,e),a=t),i=t),o=1<<++t;return u|Ne(a,i,e)}function Ee(r,e){if(r>=so){var n=r^so;return n<=uo?Ve(n,n,e):Oe(n,n,e)}return Ae(r,e)}function Ae(r,e){if(r>=so){var t=r^so;return Ve(t,t,e)}if(n(r,0)&&0===ar(e))return ne(r);for(var a=0;0==(r&1<<a);)++a;for(var i=a,o=a,u=1<<++a,s=Qi;u<=r&&a<=uo;)(u&r)>0&&(o!==a-1&&(s|=Ve(i,o,e),i=a),o=a),u=1<<++a;return s|Ve(i,o,e)}function Ne(r,e,n){if(n>=so){var t=n^so;return Te(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,o=a,u=1<<++a,s=Qi;u<=n&&a<=uo;)(u&n)>0&&(o!==a-1&&(s|=Te(r,e,i,o),i=a),o=a),u=1<<++a;return s|Te(r,e,i,o)}function De(r,e){if(0===ar(r)&&0===ar(e))return Kr(0,fr(r));for(var n=Xi,t=0,a=r.length;t<a;t+=Gi)n+=Ce(l(r,t),l(r,t+Wi),e);return n}function Ce(r,e,n){if(n===Qi)return Qi;if(n>=so){var t=n^so;return Me(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,o=a,u=1<<++a,s=Xi;u<=n&&a<=uo;)(u&n)>0&&(o!==a-1&&(s+=Me(r,e,i,o),i=a),o=a),u=1<<++a;return s+Me(r,e,i,o)}function Oe(r,e,n){for(var t=Xi,a=0,i=n.length;a<i;a+=Gi)t+=Me(r,e,l(n,a),l(n,a+Wi));return t}function Ve(r,e,n){for(var t=Qi,a=0,i=n.length;a<i;a+=Gi)t|=Te(r,e,l(n,a),l(n,a+Wi));return t}function Me(r,e,n,t){var a=e-n;return a>=Zi?p(zi(Zi,r-t),a):Xi}function Te(r,e,n,t){var a=e-n;return a>=Zi?Zr(zi(Zi,r-t),a):Qi}function Re(r,e){if(!r)return Qi;if(!e)return Qi;var n="number"==typeof r,t="number"==typeof e,a=void 0;if(n&&t){if(Le(r,e))return de(Ie(r,e));a=Be(r,e)}else a=n?Fe(r,e):t?Fe(e,r):qe(r,e);return de(A(a))}function qe(r,e){var n=F(r,e);r=n[0],e=n[1];for(var t=Xi,a=0,i=r.length;a<i;a+=Gi)t+=Pe(l(r,a),l(r,a+Wi),e);return t}function Le(r,e){return fr(r)+fr(e)<=uo}function Be(r,e){if(r>=so){var n=r^so;return je(n,n,e)}for(var t=0;0==(r&1<<t);)++t;for(var a=t,i=t,o=1<<++t,u=Xi;o<=r&&t<=uo;)(o&r)>0&&(i!==t-1&&(u+=je(a,i,e),a=t),i=t),o=1<<++t;return u+je(a,i,e)}function Ie(r,e){if(r>=so){var n=r^so;return Ue(n,n,e)}for(var t=0;0==(r&1<<t);)++t;for(var a=t,i=t,o=1<<++t,u=Qi;o<=r&&t<=uo;)(o&r)>0&&(i!==t-1&&(u|=Ue(a,i,e),a=t),i=t),o=1<<++t;return u|Ue(a,i,e)}function Ue(r,e,n){if(n>=so){var t=n^so;return ze(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,o=a,u=1<<++a,s=Qi;u<=n&&a<=uo;)(u&n)>0&&(o!==a-1&&(s|=ze(r,e,i,o),i=a),o=a),u=1<<++a;return s|ze(r,e,i,o)}function Fe(r,e){if(r>=so){var n=r^so;return Pe(n,n,e)}for(var t=0;0==(r&1<<t);)++t;for(var a=t,i=t,o=1<<++t,u=Xi;o<=r&&t<=uo;)(o&r)>0&&(i!==t-1&&(u+=Pe(a,i,e),a=t),i=t),o=1<<++t;return u+Pe(a,i,e)}function je(r,e,n){if(n>=so){var t=n^so;return $e(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,o=a,u=1<<++a,s=Xi;u<=n&&a<=uo;)(u&n)>0&&(o!==a-1&&(s+=$e(r,e,i,o),i=a),o=a),u=1<<++a;return s+$e(r,e,i,o)}function Pe(r,e,n){for(var t=Xi,a=0,i=n.length;a<i;a+=Gi)t+=$e(r,e,l(n,a),l(n,a+Wi));return t}function $e(r,e,n,t){var a=r+n;return a<=ro?p(a,$i(ro,e+t)):Xi}function ze(r,e,n,t){return Zr(r+n,e+t)}function He(r){r.log||(r.log=po.log.bind(po)),r.error||(r.error=po.error.bind(po)),r.warn||(r.warn=po.warn.bind(po)),r.trace||(r.trace=po.trace.bind(po)),r.time||(r.time=po.time.bind(po)),r.timeEnd||(r.timeEnd=po.timeEnd.bind(po)),po=r}function Je(){return po}function We(){for(var r=arguments.length,e=Array(r),n=0;n<r;n++)e[n]=arguments[n];throw new Error(e.join(": "))}function Ge(r,e,n){var t=0|e||ko;t||We("fixme");var a=Math.max(Ze(t),0|n),i={_class:"$trie",buffer:Qe(t,a),bits:a,lastNode:go,count:0};if(r)for(var o=0,u=r.length;o<u;++o)rn(i,r[o],o);return i}function Qe(r,e){switch(e){case wo:return new Uint8Array(r);case 16:return new Uint16Array(r);case Eo:return new Uint32Array(r);case Ao:return new Float64Array(r)}We("Unsupported bit size")}function Xe(r){var e=r.lastNode+bo;for(r.lastNode=e;e+bo>=r.buffer.length;)Ye(r);return e}function Ye(r){var e=r.buffer.length,n=~~(1.1*e);e+yo>n&&(n=yo+e),Ke(r,n)}function Ke(r,e){var n=Ze(e);r.bits=Math.max(r.bits,n);var t=Qe(e,r.bits);t.set(r.buffer,0),r.buffer=t}function Ze(r){return r<256?wo:r<65536?So:r<4294967296?Eo:Ao}function rn(r,e,n){return an(r,n),en(r,go,e,0,e.length,n)}function en(r,e,n,t,a,i){if(t>=a){var o=r.buffer,u=e+mo,s=r.buffer[u];return s||++r.count,o[u]=i+1,s-1}var f=n.charCodeAt(t)-32;return e=on(r,e,f%10),e=on(r,e,Math.floor(f/10)),en(r,e,n,t+1,a,i)}function nn(r,e,n){return an(r,n),tn(r,go,e+1,n)}function tn(r,e,n,t){if(0===n){var a=r.buffer,i=e+mo,o=r.buffer[i];return o||++r.count,a[i]=t+1,o-1}return e=on(r,e,n%10),n=Math.floor(n/10),tn(r,e,n,t)}function an(r,e){var n=Ze(e);n>r.bits&&(r.bits=n,Ke(r,r.buffer.length))}function on(r,e,n){e+=n;var t=r.buffer[e];return t||(t=Xe(r),r.buffer[e]=t),t}function un(r,e){return sn(r,go,e,0,e.length)}function sn(r,e,n,t,a){var i=r.buffer;if(t>=a)return i[e+mo]-1;var o=n.charCodeAt(t)-32;return(e=i[e+o%10])&&(e=i[e+Math.floor(o/10)])?sn(r,e,n,t+1,a):xo}function fn(r,e){return un(r,e)!==xo}function cn(r,e){return vn(r,go,e+1)}function vn(r,e,n){var t=r.buffer;return 0===n?t[e+mo]-1:(e=t[e+n%10])?(n=Math.floor(n/10),vn(r,e,n)):xo}function ln(){return{_class:"$config",allVarNames:[],_varNamesTrie:Ge(),varStratConfig:_n(),valueStratName:"min",targetedVars:"all",varDistOptions:{},beforeSpace:void 0,afterSpace:void 0,rngCode:"",_defaultRng:void 0,allConstraints:[],constantCache:{},initialDomains:[],_propagators:[],_varToPropagators:[],_constrainedAway:[],_constraintHash:{}}}function dn(r,e){var n=r.varStratConfig,t=r.valueStratName,a=r.targetedVars,i=r.varDistOptions,o=r.constantCache,u=r.allVarNames,s=r.allConstraints,f=r.initialDomains,c=r._propagators,v=r._varToPropagators,l=r._constrainedAway;return{_class:"$config",_varNamesTrie:Ge(u),varStratConfig:n,valueStratName:t,targetedVars:a instanceof Array?a.slice(0):a,varDistOptions:JSON.parse(JSON.stringify(i)),rngCode:r.rngCode,_defaultRng:r.rngCode?void 0:r._defaultRng,constantCache:o,allVarNames:u.slice(0),allConstraints:s.slice(0),initialDomains:e?e.map(de):f,_propagators:c&&c.slice(0),_varToPropagators:v&&v.slice(0),_constrainedAway:l&&l.slice(0),_constraintHash:{}}}function pn(r){return hn(r,!0)}function hn(r,e){return xn(r,e,Kr(Zi,ro))}function gn(r,e,n){return e===n?kn(r,e):mn(r,!0,e,n)}function mn(r,e,n,t){return xn(r,e,Kr(n,t))}function bn(r,e,n,t,a){return xn(r,e,pe(n),t,a)}function kn(r,e){return void 0!==r.constantCache[e]?r.constantCache[e]:yn(r,!0,e)}function yn(r,e,n){return xn(r,e,Kr(n,n))}function xn(r,e,n,t){if(!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])){var a=r.allVarNames.length;!0===e?e="__"+String(a)+"__":("string"!=typeof e&&We("Var names should be a string or anonymous, was: "+JSON.stringify(e)),e||We("Var name cannot be empty string"),String(parseInt(e,10))===e&&We("Don't use numbers as var names ("+e+")")),a<100&&fn(r._varNamesTrie,e)&&We("Var name already part of this config. Probably a bug?",e);var i=u(n);return i===eo||r.constantCache[i]||(r.constantCache[i]=a),r.initialDomains[a]=n,r.allVarNames.push(e),rn(r._varNamesTrie,e,a),a}var o=un(r._varNamesTrie,e);r.initialDomains[o]=n}function _n(r){return{_class:"$var_strat_config",type:r&&r.type||"naive",priorityByName:r&&r.priorityByName,_priorityByIndex:void 0,inverted:!(!r||!r.inverted),fallback:r&&r.fallback}}function wn(r,e,n,t){"varStratOverride"===e&&We("deprecated, should be wiped internally");var a=!1;switch(e){case"varStrategyFallback":a=!0;case"varStrategy":"function"==typeof n&&We("functions no longer supported",n),"string"==typeof n&&We("strings should be passed on as {type:value}",n),"object"!==(void 0===n?"undefined":_typeof(n))&&We("varStrategy should be object",n),n.name&&We("name should be type"),n.dist_name&&We("dist_name should be type");var i=_n(n);if(a){for(var o=r.varStratConfig;o.fallback;)o=o.fallback;o.fallback=i}else for(r.varStratConfig=i;i.fallback;)i.fallback=_n(i.fallback),i=i.fallback;break;case"valueStrategy":r.valueStratName=n;break;case"targeted_var_names":n&&n.length||We("ONLY_USE_WITH_SOME_TARGET_VARS"),r.targetedVars=n;break;case"varStratOverrides":for(var u in n)wn(r,"varValueStrat",n[u],u);break;case"varValueStrat":if(r.varDistOptions||(r.varDistOptions={}),r.varDistOptions[t]=n,"markov"===n.valtype){var s=n.matrix;s||(n.expandVectorsWith?s=n.matrix=[{vector:[]}]:We("FDO: markov var missing distribution (needs matrix or expandVectorsWith)"));for(var f=0,c=s.length;f<c;++f){var v=s[f];v.boolean&&We("row.boolean was deprecated in favor of row.boolVarName"),void 0!==v.booleanId&&We("row.booleanId is no longer used, please use row.boolVarName");var l=v.boolVarName;"function"==typeof l&&(l=l(n)),l&&("string"!=typeof l&&We("row.boolVarName, if it exists, should be the name of a var or a func that returns that name, was/got: "+l+" ("+(void 0===l?"undefined":_typeof(l))+")"),v._boolVarIndex=un(r._varNamesTrie,l))}}break;case"beforeSpace":r.beforeSpace=n;break;case"afterSpace":r.afterSpace=n;break;case"var":return We("REMOVED. Replace `var` with `varStrategy`");case"val":return We("REMOVED. Replace `var` with `valueStrategy`");case"rng":"string"==typeof n?r.rngCode=n:"number"==typeof n?r.rngCode="return "+n+";":r._defaultRng=n;break;default:We("unknown option")}}function Sn(r,e){r._propagators.push(e)}function En(r){for(var e=new Array(r.allVarNames.length),n=r._propagators,t=r.initialDomains,a=0,i=n.length;a<i;++a){var o=n[a];An(o.index1,t,e,a),o.index2>=0&&An(o.index2,t,e,a),o.index3>=0&&An(o.index3,t,e,a)}r._varToPropagators=e}function An(r,e,n,t){hr(e[r])||(n[r]?n[r].indexOf(t)<0&&n[r].push(t):n[r]=[t])}function Nn(r,e,n,t){var a=e,i=void 0,o=!1;switch(e){case"reifier":o=!0,a=t;case"plus":case"min":case"ring-mul":case"ring-div":case"mul":case"sum":case"product":var u="product"===e||"sum"===e,s=void 0;void 0===(i=u?t:n[2])?(s=o?gn(r,0,1):pn(r),i=r.allVarNames[s]):"number"==typeof i?(s=kn(r,i),i=r.allVarNames[s]):"string"!=typeof i?We("expecting result var name to be absent or a number or string: `"+i+"`"):(s=un(r._varNamesTrie,i))<0&&We("Vars must be defined before using them ("+i+")"),u?t=s:n[2]=i;break;case"distinct":case"eq":case"neq":case"lt":case"lte":case"gt":case"gte":break;default:We("UNKNOWN_PROPAGATOR "+e)}if(Dn(r,n),On(r,a+"|"+n.join(","),i))return i;var f=Ln(e,Cn(r,n),t);return r.allConstraints.push(f),i}function Dn(r,e){for(var n=0,t=e.length;n<t;++n)if("number"==typeof e[n]){var a=kn(r,e[n]);e[n]=r.allVarNames[a]}}function Cn(r,e){for(var n=[],t=0,a=e.length;t<a;++t){var i=e[t],o=un(r._varNamesTrie,i);o===xo&&We("CONSTRAINT_VARS_SHOULD_BE_DECLARED","name=",i,"index=",t,"names=",e),n[t]=o}return n}function On(r,e,n){r._constraintHash||(r._constraintHash={});var t=r._constraintHash[e];if(!0===t){if(void 0!==n)throw new Error("How is this possible?");return!0}return void 0!==t?(Nn(r,"eq",[n,t]),!0):(r._constraintHash[e]=n||!0,!1)}function Vn(r){var e=r.allConstraints;r._propagators=[];for(var n=0,t=e.length;n<t;++n){var a=e[n];if(a.varNames){Je().warn("saw constraint.varNames, converting to varIndexes, log out result and update test accordingly"),a.varIndexes=a.varNames.map(function(e){return un(r._varNamesTrie,e)});var i=a.param;delete a.param,delete a.varNames,a.param=i}if(-1===a.varIndexes[1])throw new Error("nope? "+ho(a));Mn(r,a.name,a.varIndexes,a.param,a)}}function Mn(r,e,n,t,a){switch(e){case"plus":return Vt(r,n[0],n[1],n[2]);case"min":return Mt(r,n[0],n[1],n[2]);case"ring-mul":return Tt(r,n[0],n[1],n[2]);case"ring-div":return Et(r,n[0],n[1],n[2]);case"mul":return St(r,n[0],n[1],n[2]);case"sum":return Rt(r,n.slice(0),t);case"product":return qt(r,n.slice(0),t);case"distinct":return Dt(r,n.slice(0));case"reifier":return kt(r,t,n[0],n[1],n[2]);case"neq":return Nt(r,n[0],n[1]);case"eq":return yt(r,n[0],n[1]);case"gte":return At(r,n[0],n[1]);case"lte":return wt(r,n[0],n[1]);case"gt":return _t(r,n[0],n[1]);case"lt":return xt(r,n[0],n[1]);default:We("UNEXPECTED_NAME: "+e)}}function Tn(r){var e=r.varDistOptions;for(var n in e){var t=un(r._varNamesTrie,n);t<0&&We("Found markov var options for an unknown var name (name="+n+")");var a=e[n];if(a&&"markov"===a.valtype)return Lt(r,t)}}function Rn(r){for(var e=r.varStratConfig;e;){if(e.priorityByName){for(var n={},t=e.priorityByName,a=0,i=t.length;a<i;++a)n[un(r._varNamesTrie,t[a])]=i-a;e._priorityByIndex=n}e=e.fallback}}function qn(r){r._varNamesTrie||(r._varNamesTrie=Ge(r.allVarNames)),r._defaultRng||(r._defaultRng=r.rngCode?Function(r.rngCode):Math.random),Vn(r),Tn(r),En(r),Rn(r)}function Ln(r,e,n){return{_class:"$constraint",name:r,varIndexes:e,param:n}}function Bn(r,n,t,a){for(var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=[],u=[],s=0,f=0;f<n.length;f++){var c=n[f];if(c>0){var v=t[f];e(r,v)&&(s+=c,u.push(s),o.push(v))}}if(0!==u.length)return 1===u.length?o[0]:In(a,s,u,o,i)}function In(r,e,n,t,a){var i=r(),o=i;a&&(o=i*e);for(var u=0;u<n.length&&!(n[u]>o);u++);return t[u]}function Un(r,e,n,t){var a=e.valueStratName,i=e.varDistOptions,o=e.allVarNames[n],u=i[o]&&i[o].valtype;return u&&(a=u),"function"==typeof a?a(r,n,t):Fn(a,r,e,n,t)}function Fn(r,e,n,t,a){switch(r){case"max":return $n(e,t,a);case"markov":return Qn(e,n,t,a);case"mid":return zn(e,t,a);case"min":case"naive":return Pn(e,t,a);case"minMaxCycle":return Wn(e,t,a);case"list":return jn(e,n,t,a);case"splitMax":return Jn(e,t,a);case"splitMin":return Hn(e,t,a);case"throw":return We("Throwing an error because val-strat requests it")}We("unknown next var func",r)}function jn(r,e,n,t){var a=r.vardoms[n],i=e.allVarNames[n],o=e.varDistOptions[i],u=o.list,s="";o.fallback&&(s=o.fallback.valtype);var f=u;switch("function"==typeof u&&(f=u(r,i,t)),t){case No:var c=x(a,f);return c===io?Fn(s||"naive",r,e,n,No):(r._lastChosenValue=c,Yr(c));case Do:return r._lastChosenValue>=0?Lr(a,r._lastChosenValue):Fn(s||"naive",r,e,n,Do)}return Co}function Pn(r,e,n){var t=r.vardoms[e];switch(n){case No:var a=ar(t);return r._lastChosenValue=a,Yr(a);case Do:return Lr(t,r._lastChosenValue)}return Co}function $n(r,e,n){var t=r.vardoms[e];switch(n){case No:var a=fr(t);return r._lastChosenValue=a,Yr(a);case Do:return Lr(t,r._lastChosenValue)}return Co}function zn(r,e,n){var t=r.vardoms[e];switch(n){case No:var a=nr(t);return r._lastChosenValue=a,Yr(a);case Do:return Lr(t,r._lastChosenValue)}return Co}function Hn(r,e,n){var t=r.vardoms[e],a=fr(t);switch(n){case No:var i=ar(t),o=i+Math.floor((a-i)/2);return r._lastChosenValue=o,C(t,Kr(i,o));case Do:return C(t,Kr(r._lastChosenValue+1,a))}return Co}function Jn(r,e,n){var t=r.vardoms[e],a=ar(t);switch(n){case No:var i=fr(t),o=a+Math.floor((i-a)/2);return r._lastChosenValue=o,C(t,Kr(o+1,i));case Do:return C(t,Kr(a,r._lastChosenValue))}return Co}function Wn(r,e,n){return Gn(e)?Pn(r,e,n):$n(r,e,n)}function Gn(r){return r%2==0}function Qn(r,e,n,t){var a=r.vardoms[n];switch(t){case No:var i=e.allVarNames[n],o=e.varDistOptions[i],u=o.expandVectorsWith,s=o.random||e._defaultRng,f=ht("number"==typeof u,o.legend,a),c=f.length;if(!c)return Co;var v=Bn(a,mt(r,o.matrix,u,c),f,s);return null==v?Co:(r._lastChosenValue=v,Yr(v));case Do:return Lr(a,r._lastChosenValue)}return Co}function Xn(r,e){var n=e.varStratConfig;return Kn(r,e,Yn(n.type),n)}function Yn(r){switch(r){case"naive":return null;case"size":return Zn;case"min":return rt;case"max":return et;case"markov":return nt;case"list":return tt;case"throw":return We("Throwing an error because var-strat requests it")}return We("unknown next var func",r)}function Kn(r,e,n,t){var a=0,i=r._unsolved,o=i[a++];if(n)for(var u=i.length;a<u;a++){var s=i[a];Oo===n(r,e,s,o,t)&&(o=s)}return o}function Zn(r,e,n,t){var a=K(r.vardoms[n])-K(r.vardoms[t]);return a<0?Oo:a>0?Mo:Vo}function rt(r,e,n,t){var a=ar(r.vardoms[n])-ar(r.vardoms[t]);return a<0?Oo:a>0?Mo:Vo}function et(r,e,n,t){var a=fr(r.vardoms[n])-fr(r.vardoms[t]);return a>0?Oo:a<0?Mo:Vo}function nt(r,e,n,t,a){var i=e.varDistOptions,o=e.allVarNames[n];if(i[o]&&"markov"===i[o].valtype)return Oo;var u=e.allVarNames[t];return i[u]&&"markov"===i[u].valtype?Mo:at(r,e,n,t,a.fallback)}function tt(r,e,n,t,a){var i=a._priorityByIndex,o=i[n],u=i[t];if(!o&&!u)return at(r,e,n,t,a.fallback);var s=a.inverted;return u?o&&o>u?s?Mo:Oo:s?Oo:Mo:s?Mo:Oo}function at(r,e,n,t,a){if(!a)return Vo;var i=a.type;switch(i){case"size":return Zn(r,e,n,t);case"min":return rt(r,e,n,t);case"max":return et(r,e,n,t);case"markov":return nt(r,e,n,t,a);case"list":return tt(r,e,n,t,a);case"throw":return We("nope")}return We("Unknown var dist fallback name: "+i)}function it(r,e,n,t,a,i){i=!0;var o=r.varDistOptions,s=e||r.initialDomains,f=r.allVarNames,c=i?function(r){return ot(f[r])}:t?st:ut,v=f.map(function(r,e){var n=ft(s[e]),t=": "+c(e)+" = "+n,a=o[r];if(a&&("list"!==a.valtype||a.list&&a.list.length))switch(t+=" @"+a.valtype,a.valtype){case"markov":"expandVectorsWith"in a&&(t+="expand("+(a.expandVectorsWith||0)+")"),"legend"in a&&(t+=" legend("+a.legend.join(" ")+")"),"matrix"in a&&(t+=" matrix("+JSON.stringify(a.matrix).replace(/"/g,"")+")");break;case"list":"function"==typeof a.list?t+=" prio(???func???)":t+=" prio("+a.list.join(" ")+")";break;case"max":case"mid":case"min":case"minMaxCycle":case"naive":case"splitMax":case"splitMin":break;default:Je().warn("Unknown value strategy override: "+a.valtype),t+=" @? "+JSON.stringify(a)}return i||r===String(e)||(t+=" # "+ot(r)),t}),l=n?[]:r.allConstraints.map(function(r){var e=r.varIndexes,n=e.map(c);e.forEach(function(r,e){var t=u(s[r]);t>=0&&(n[e]=t)});var o="";if("number"==typeof r.param){var f=u(s[r.param]);o=f>=0?f:c(r.param)}var v="",l="";switch(r.name){case"reifier":var d=void 0;switch(r.param){case"eq":d="==";break;case"neq":d="!=";break;case"lt":d="<";break;case"lte":d="<=";break;case"gt":d=">";break;case"gte":d=">=";break;default:We("what dis param: "+d)}v+=n[2]+" = "+n[0]+" "+d+"? "+n[1];break;case"plus":v+=n[2]+" = "+n[0]+" + "+n[1];break;case"min":v+=n[2]+" = "+n[0]+" - "+n[1];break;case"ring-mul":v+=n[2]+" = "+n[0]+" * "+n[1];break;case"ring-div":v+=n[2]+" = "+n[0]+" / "+n[1];break;case"mul":v+=n[2]+" = "+n[0]+" * "+n[1];break;case"sum":v+=o+" = sum("+n.join(" ")+")";break;case"product":v+=o+" = product("+n.join(" ")+")";break;case"markov":v+="# markov("+n+")";break;case"distinct":v+="distinct("+n+")";break;case"eq":v+=n[0]+" == "+n[1];break;case"neq":v+=n[0]+" != "+n[1];break;case"lt":v+=n[0]+" < "+n[1];break;case"lte":v+=n[0]+" <= "+n[1];break;case"gt":v+=n[0]+" > "+n[1];break;case"gte":v+=n[0]+" >= "+n[1];break;default:Je().warn("unknown constraint: "+r.name),v+="unknown = "+JSON.stringify(r)}var p=v;if((v.indexOf(i?"'":"$")<0||"distinct"===r.name&&n.length<=1||("product"===r.name||"sum"===r.name)&&0===n.length)&&(t||(l+=(l?", ":" # ")+"dropped; constraint already solved ("+v+") ("+e.map(c)+", "+c(r.param)+")"),v=""),!t||a){if(n.forEach(function(r,n){"string"==typeof r&&(p=p.replace(r,ft(s[e[n]])))}),"number"==typeof r.param&&"string"==typeof o&&(p=p.replace(o,ft(s[r.param]))),v||!t){for(var h=Math.max(0,30-v.length);h>=0;--h)v+=" ";v+="      # "+p}v+=l}return v}).filter(function(r){return!!r}),d=n?r._propagators.map(function(r){var e=r.index1,n=r.index2,a=r.index3,i=e>=0?u(s[e]):-1,o=i>=0?i:e<0?void 0:c(e),f=n>=0?u(s[n]):-1,v=f>=0?f:n<0?void 0:c(n),l=a>=0?u(s[a]):-1,d=l>=0?l:a<0?void 0:c(a),p="",h="";switch(r.name){case"reified":var g=void 0;switch(r.arg3){case"eq":g="==";break;case"neq":g="!=";break;case"lt":g="<";break;case"lte":g="<=";break;case"gt":g=">";break;case"gte":g=">=";break;default:We("what dis param: "+g)}p+=d+" = "+o+" "+g+"? "+v;break;case"eq":p+=o+" == "+v;break;case"lt":p+=o+" < "+v;break;case"lte":p+=o+" <= "+v;break;case"mul":p+=d+" = "+o+" * "+v;break;case"div":p+=d+" = "+o+" / "+v;break;case"neq":p+=o+" != "+v;break;case"min":p+=d+" = "+o+" - "+v;break;case"ring":switch(r.arg1){case"plus":p+=d+" = "+o+" + "+v;break;case"min":p+=d+" = "+o+" - "+v;break;case"ring-mul":p+=d+" = "+o+" * "+v;break;case"ring-div":p+=d+" = "+o+" / "+v;break;default:throw new Error("Unexpected ring op:"+r.arg1)}break;case"markov":return"";default:Je().warn("unknown propagator: "+r.name),p+="unknown = "+JSON.stringify(r)}var m=p;return p.indexOf("$")<0&&(t||(h+=(h?", ":" # ")+"dropped; constraint already solved ("+p+")"),p=""),t||("string"==typeof o&&(m=m.replace(o,ft(s[e]))),"string"==typeof v&&(m=m.replace(v,ft(s[n]))),"string"==typeof d&&(m=m.replace(d,ft(s[a]))),p+=" ".repeat(Math.max(0,30-p.length))+"      # initial: "+m,p+=h),p}).filter(function(r){return!!r}):[];return["## constraint problem export","@custom var-strat = "+JSON.stringify(r.varStratConfig),"@custom val-strat = "+r.valueStratName,v.join("\n")||"# no vars",l.join("\n")||d.join("\n")||"# no constraints","@custom targets "+("all"===r.targetedVars?" = all":"("+r.targetedVars.map(function(e){return c(un(r._varNamesTrie,e))}).join(" ")+")"),"## end of export"].join("\n\n")}function ot(r){return"number"==typeof r?r:"'"+r+"'"}function ut(r){return"$"+r+"$"}function st(r){var e=r.toString(36);return e[0]<"a"&&(e="$"+e),e}function ft(r){var e=te(r);if(2===e.length&&e[0]===e[1])return String(e[0]);if(e.length>2){for(var n=[],t=0,a=e.length;t<a;t+=2)n.push("["+e[t]+" "+e[t+1]+"]");e=n}return"["+e.join(" ")+"]"}function ct(r){switch(void 0===r?"undefined":_typeof(r)){case"object":if(!r)return null;if(r instanceof Array)return r.map(function(r){return ct(r)});var e={};for(var n in r)e[n]=ct(r[n]);return e;case"function":var t={__THIS_IS_A_FUNCTION:1,__source:r.toString()};for(var a in r)t[a]=ct(r[a]);return t;case"string":case"number":case"boolean":case"undefined":return r}We("config value what?",r)}function vt(r,e,n,t){for(var a=[];r.more&&a.length<n;)ia(r,e,t),"end"!==r.status&&a.push(r.space);return a}function lt(r,e,n,t){t>=to&&Je().time("      - FD Solution Construction Time");for(var a=0;a<r.length;++a){var i=Da(r[a],e);n.push(i),t>=ao&&(Je().log("      - FD solution() ::::::::::::::::::::::::::::"),Je().log(JSON.stringify(i)),Je().log("                      ::::::::::::::::::::::::::::"))}t>=to&&Je().timeEnd("      - FD Solution Construction Time")}function dt(r,e,n){function t(){return r[vr]}function a(e){return r[vr+e]}function i(){++vr}function o(r,e){t()!==r&&cr("Expected "+(e?e+" ":"")+"`"+r+"`, found `"+t()+"`"),i()}function u(){for(;vr<lr&&f(t());)i()}function s(){for(;!h();){var r=t();if(l(r))i();else{if(!v(r))break;E()}}}function f(r){return" "===r||"\t"===r}function c(r){return"\n"===r||"\r"===r}function v(r){return"#"===r}function l(r){return f(r)||c(r)}function d(){if(u(),vr<lr){var r=t();"#"===r?E():c(r)?i():cr("Expected EOL but got `"+t()+"`")}}function p(){if(vr>=lr)return!0;var r=t();return"#"===r||c(r)}function h(){return vr>=lr}function g(){i(),u();var r=m();if(u(),","===t()){r=[r];do{i(),u(),r.push(m()),u()}while(!h()&&","===t())}"="===t()&&(i(),u());var n=x();u();var a=_();d(),"string"==typeof r?e.decl(r,n,a,!0):r.forEach(function(r){return e.decl(r,n,a,!0)})}function m(){return"'"===t()?b():k()}function b(){o("'","start of Quoted identifier");for(var e=vr,n=t();!h()&&!c(n)&&"'"!==n;)i(),n=t();return h()&&cr("Quoted identifier must be closed"),e===vr&&cr("Expected to parse identifier, found none"),o("'","end of Quoted identifier"),r.slice(e,vr-1)}function k(){var e=vr;for(t()>="0"&&t()<="9"&&cr("Unquoted ident cant start with number");!h()&&y(t());)i();return e===vr&&cr("Expected to parse identifier, found none ["+t()+"]"),r.slice(e,vr)}function y(r){return r>="a"&&r<="z"||r>="A"&&r<="Z"||r>="0"&&r<="9"||"_"===r||"$"===r||"-"===r||r>"~"}function x(){var r=t(),e=void 0;switch(r){case"[":if(o("[","domain start"),u(),e=[],"["===t())do{i(),u();var n=q();u(),","===t()&&(i(),u());var a=q();u(),o("]","range-end"),u(),e.push(n,a),","===t()&&(i(),u())}while("["===t());else if("]"!==t())do{u();var s=q();u(),","===t()&&(i(),u());var f=q();u(),e.push(s,f),","===t()&&(i(),u())}while("]"!==t());return o("]","domain-end"),0===e.length&&cr("Empty domain [] in dsl, this problem will always reject"),e;case"*":return i(),[Zi,ro];case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":var c=q();return u(),[c,c]}cr("Expecting valid domain start, found `"+r+"`")}function _(){if("@"===t()){i();for(var e={},n=vr;t()>="a"&&t()<="z";)i();var a=r.slice(n,vr);switch(a){case"list":w(e);break;case"markov":S(e);break;case"max":case"mid":case"min":case"naive":break;case"minMaxCycle":case"splitMax":case"splitMin":default:cr("implement me (var mod) [`"+a+"`]")}return e.valtype=a,e}}function w(e){u(),"prio("!==r.slice(vr,vr+5)&&cr("Expecting the priorities to follow the `@list`"),vr+=5,e.list=nr(),o(")","list end")}function S(e){for(;;){if(u(),"matrix("===r.slice(vr,vr+7)){var n="return "+r.slice(vr+7,vr=r.indexOf(")",vr)),t=Function(n);e.matrix=t(),-1===vr&&cr("The matrix must be closed by a `)` but did not find any")}else if("legend("===r.slice(vr,vr+7))vr+=7,e.legend=nr(),u(),o(")","legend closer");else{if("expand("!==r.slice(vr,vr+7))break;vr+=7,e.expandVectorsWith=q(),u(),o(")","expand closer")}i()}}function E(){for(o("#","comment start");!h()&&!c(t());)i();h()||i()}function A(){if(!V()){var r=T();u();var n=C();switch(u(),n){case"=":N(r);break;case"==":e.eq(r,T());break;case"!=":e.neq(r,T());break;case"<":e.lt(r,T());break;case"<=":e.lte(r,T());break;case">":e.gt(r,T());break;case">=":e.gte(r,T());break;case"&":e.neq(e.mul(r,T()),e.num(0));break;case"!&":e.mul(r,T(),e.num(0));break;case"|":e.neq(e.plus(r,T()),e.num(0));break;case"!|":e.eq(r,e.num(0)),e.eq(T(),e.num(0));break;case"^":e.eq(e.plus(e.isEq(r,0),e.isEq(T(),0)),1);break;case"!^":e.eq(e.isEq(r,e.num(0)),e.isEq(T(),e.num(0)));break;case"->":var t=T();e.lte(e.isNeq(r,e.num(0)),e.isNeq(t,e.num(0))),e.lte(e.isEq(t,e.num(0)),e.isEq(r,e.num(0)));break;case"!->":e.gt(r,e.num(0)),e.eq(T(),e.num(0));break;default:n&&cr("Unknown cop that starts with: ["+n+"]")}d()}}function N(r){var n="string"==typeof r&&!e.hasVar(r);n&&(r=e.decl(r));var a=T(r,n);u();var i=t();return h()||c(i)||v(i)?(e.eq(a,r),a):D(a,r,n)}function D(r,n,t){var a=O();switch(u(),a){case"==?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isEq(r,T(),n);case"!=?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isNeq(r,T(),n);case"<?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isLt(r,T(),n);case"<=?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isLte(r,T(),n);case">?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isGt(r,T(),n);case">=?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isGte(r,T(),n);case"|?":return t&&e.decl(n,[0,1],void 0,!1,!0),Q(n,[r,T()]);case"!|?":return t&&e.decl(n,[0,1],void 0,!1,!0),J(n,[r,T()]);case"&?":return t&&e.decl(n,[0,1],void 0,!1,!0),j(n,[r,T()]);case"!&?":return t&&e.decl(n,[0,1],void 0,!1,!0),z(n,[r,T()]);case"+":return e.plus(r,T(),n);case"-":return e.minus(r,T(),n);case"*":return e.mul(r,T(),n);case"/":return e.div(r,T(),n);default:return void 0!==a&&cr("Expecting right paren or rop, got: `"+a+"`"),r}}function C(){var r=t();switch(r){case"=":return i(),"="===t()?(i(),"=="):"=";case"!":return i(),"="===(r=t())?(i(),"!="):"&"===r?(i(),"!&"):"^"===r?(i(),"!^"):"|"===r?(i(),"!|"):"-"===r&&">"===a(1)?(i(),i(),"!->"):"!";case"<":return i(),"="===t()?(i(),"<="):"<";case">":return i(),"="===t()?(i(),">="):">";case"&":case"|":case"^":return i(),r;case"#":cr("Expected to parse a cop but found a comment instead");break;case"-":if(">"===a(1))return i(),i(),"->"}h()&&cr("Expected to parse a cop but reached eof instead"),cr("Unknown cop char: `"+r+"`")}function O(){var r=t();switch(r){case"=":return i(),"="===t()?(i(),o("?","reifier suffix"),"==?"):"=";case"!":if(i(),"="===t())return o("=","middle part of !=? op"),o("?","reifier suffix"),"!=?";if("|"===t())return o("|","middle part of !|? op"),o("?","reifier suffix"),"!|?";if("&"===t())return o("&","middle part of !&? op"),o("?","reifier suffix"),"!&?";cr("invalid rop char after ! ["+t()+"]");break;case"<":return i(),"="===t()?(i(),o("?","reifier suffix"),"<=?"):(o("?","reifier suffix"),"<?");case">":return i(),"="===t()?(i(),o("?","reifier suffix"),">=?"):(o("?","reifier suffix"),">?");case"|":return i(),o("?","reifier suffix"),"|?";case"&":return i(),o("?","reifier suffix"),"&?";case"+":case"-":case"*":case"/":return i(),r;default:cr("Expecting right paren or rop, got: `"+r+"`")}}function V(){if("all("===r.slice(vr,vr+4))L();else if("distinct("===r.slice(vr,vr+9))B(9);else if("diff("===r.slice(vr,vr+5))B(5);else if("nall("===r.slice(vr,vr+5))X();else if("none("===r.slice(vr,vr+5))Y();else if("same("===r.slice(vr,vr+5))K();else if("some("===r.slice(vr,vr+5))Z();else{if("xnor("!==r.slice(vr,vr+5))return!1;rr()}return!0}function M(){var r=[];for(u();!h()&&")"!==t();){var e=T();r.push(e),u(),","===t()&&(i(),u())}return r}function T(r,n){var a=t(),o=void 0;if("("===a)o=R();else if("["===a){var u=x();o=u[0]===u[1]&&2===u.length?u[0]:e.decl(void 0,u)}else if(a>="0"&&a<="9")o=q();else{var s=m(),f=t();"sum"===s&&"("===f?o=I(r):"product"===s&&"("===f?o=U(r):"all"===s&&"?"===f&&(i(),"("===t())?(n&&e.decl(r,[0,1],void 0,!1,!0),o=F(r)):"diff"===s&&"?"===f&&(i(),"("===t())?(n&&e.decl(r,[0,1],void 0,!1,!0),o=P(r)):"nall"===s&&"?"===f&&(i(),"("===t())?(n&&e.decl(r,[0,1],void 0,!1,!0),o=$(r)):"none"===s&&"?"===f&&(i(),"("===t())?(n&&e.decl(r,[0,1],void 0,!1,!0),o=H(r)):"same"===s&&"?"===f&&(i(),"("===t())?(n&&e.decl(r,[0,1],void 0,!1,!0),o=W(r)):"some"===s&&"?"===f&&(i(),"("===t())?(n&&e.decl(r,[0,1],void 0,!1,!0),o=G(r)):"?"===f?cr("Unknown reifier constraint func: ["+s+"]"):o=s}return o}function R(){o("(","group open"),u();var r=T();if(u(),"="===t()&&"="!==t())return N(r),u(),o(")","group closer"),r;if(")"===t())return i(),r;var e=D(r);return u(),o(")","group closer"),e}function q(){for(var e=vr;t()>="0"&&t()<="9";)i();return e===vr&&cr("Expecting to parse a number but did not find any digits ["+e+","+vr+"]["+t()+"]"),parseInt(r.slice(e,vr),10)}function L(){vr+=4,u();var r=M(),n=e.product(r,e.decl(void 0,[1,ro]));return u(),o(")","ALL closer"),n}function B(r){vr+=r,u();var n=M();n.length||cr("Expecting at least one expression"),e.distinct(n),u(),o(")","distinct call closer"),d()}function I(r){o("(","sum call opener"),u();var n=M(),t=e.sum(n,r);return u(),o(")","sum closer"),t}function U(r){o("(","product call opener"),u();var n=M(),t=e.product(n,r);return u(),o(")","product closer"),t}function F(r){o("(","isall call opener"),u();var e=j(r,M());return u(),o(")","isall closer"),e}function j(r,n){var t=e.decl();return e.product(n,t),e.isNeq(t,e.num(0),r)}function P(r){o("(","isdiff call opener"),u();for(var n=M(),t=[],a=0;a<n.length;++a)for(var i=n[a],s=a+1;s<n.length;++s){var f=n[s];t.push(e.isNeq(i,f))}return e.isEq(e.sum(t),e.num(t.length),r),u(),o(")","isdiff closer"),r}function $(r){o("(","isnall call opener"),u();var e=z(r,M());return u(),o(")","isnall closer"),e}function z(r,n){var t=e.decl();return e.product(n,t),e.isEq(t,e.num(0),r)}function H(r){o("(","isnone call opener"),u();var e=J(r,M());return u(),o(")","isnone closer"),e}function J(r,n){var t=e.decl();return e.sum(n,t),e.isEq(t,e.num(0),r)}function W(r){o("(","issame call opener"),u();for(var n=M(),t=[],a=1;a<n.length;++a){var i=e.decl(void 0,[0,1]);e.isEq(n[a-1],n[a],i),t.push(i)}var s=e.decl();e.sum(t,s);var f=e.isEq(s,e.num(t.length),r);return u(),o(")","issame closer"),f}function G(r){o("(","issome call opener"),u();var e=Q(r,M());return u(),o(")","issome closer"),e}function Q(r,n){var t=e.decl();return e.sum(n,t),e.isNeq(t,e.num(0),r)}function X(){vr+=5,u();var r=M();e.product(r,e.num(0)),u(),o(")","nall closer"),d()}function Y(){vr+=5,u();var r=M();e.sum(r,e.num(0)),u(),o(")","none closer"),d()}function K(){vr+=5,u();for(var r=M(),n=1;n<r.length;++n)e.eq(r[n-1],r[n]);u(),o(")","same closer"),d()}function Z(){vr+=5,u();var r=M();e.sum(r,e.decl(void 0,[1,ro])),u(),o(")","some closer"),d()}function rr(){vr+=5,u();var r=M();u(),o(")","xnor() closer"),d();var n=e.decl(),t=e.decl();e.sum(r,n),e.product(r,t),e.plus(e.isEq(n,0),e.isNeq(t,0),1)}function er(){for(var e=vr;t()>="0"&&t()<="9";)i();return r.slice(e,vr)}function nr(){var r=[];u();for(var e=er();e;)r.push(parseInt(e,10)),u(),","===t()&&(++vr,u()),e=er();return r.length||cr("Expected to parse a list of at least some numbers but found none"),r}function tr(){for(var r=[];;){if(u(),p()&&cr("Missing target char at eol/eof"),")"===t())break;","===t()&&(i(),u(),p()&&cr("Trailing comma not supported")),","===t()&&cr("Double comma not supported");var e=m();r.push(e)}return r.length||cr("Expected to parse a list of at least some identifiers but found none"),r}function ar(){for(var r="";!h()&&!c(t());)r+=t(),i();return r}function ir(){if(o("@"),"custom"===r.slice(vr,vr+6)){vr+=6,u();var n=m();switch(u(),"="===t()&&(i(),u(),"="===t()&&cr("Unexpected double eq sign")),n){case"var-strat":or();break;case"val-strat":ur();break;case"set-valdist":u();var a=m(),s=sr();e.setValueDistributionFor(a,JSON.parse(s));break;case"targets":fr();break;case"nobool":case"noleaf":case"free":u(),","===t()&&cr("Leading comma not supported"),p()&&cr("Expected to parse some var values"),ar();break;default:cr("Unsupported custom rule: "+n)}}else cr("Unknown atrule");d()}function or(){u();var r=!1;"f"===t()&&("fallback"!==m()&&cr("Expecting `fallback` here"),r=!0,u());var n=!1;if("i"===t()&&("inverted"!==m()&&cr("Expecting `inverted` here"),n=!0,u()),"l"===t()||"("===t()){"l"===t()&&("list"!==m()&&cr("Unexpected ident after `inverted` (only expecting `list` or the list)"),u()),o("(");var a=tr();a.length?wn(e.config,r?"varStrategyFallback":"varStrategy",{type:"list",inverted:n,priorityByName:a}):wn(e.config,r?"varStrategyFallback":"varStrategy",{type:"naive"}),u(),o(")")}else{"="===t()&&(i(),u()),n&&cr("The `inverted` keyword is only valid for a prio list");var s=m();"list"===s&&cr("Use a grouped list of idents for vardist=list"),"naive"!==s&&"size"!==s&&"min"!==s&&"max"!==s&&"throw"!==s&&cr("Unknown var dist ["+s+"]"),wn(e.config,r?"varStrategyFallback":"varStrategy",{type:s})}}function ur(){var r=m();d(),e.config.valueStratName=r}function sr(){return u(),"="===t()&&(i(),u()),ar()}function fr(){if(u(),"all"===r.slice(vr,vr+3))vr+=3,e.config.targetedVars="all";else{o("(","ONLY_USE_WITH_SOME_TARGET_VARS"),u(),","===t()&&cr("Leading comma not supported");var n=tr();n.length&&(e.config.targetedVars=n),o(")")}}function cr(e){throw n&&Je().log(r.slice(0,vr)+"##|PARSER_IS_HERE["+e+"]|##"+r.slice(vr)),e="Importer parser error: "+e+", source at #|#: `"+r.slice(Math.max(0,vr-70),vr)+"#|#"+r.slice(vr,Math.min(r.length,vr+70))+"`",new Error(e)}e||(e=new To);for(var vr=0,lr=r.length;!h();)!function(){switch(s(),t()){case":":return g();case"#":return E();case"@":return ir();default:if(!h())A()}}();return e}function pt(r,e){for(var n=r.vardoms,t=0;t<e.length;t++){var a=e[t],i=n[a._boolVarIndex];if(void 0===i||1===u(i))break}return a}function ht(r,e,n){return r?gt(e,n):e}function gt(r,e){var n=void 0;n=r?r.slice(0):[];for(var t=g(e),a=0;a<t.length;++a){var i=t[a];n.indexOf(i)<0&&n.push(i)}return n}function mt(r,e,n,t){var a=pt(r,e).vector;if(null!=n){var i=t-(a=a?a.slice(0):[]).length;if(i>0)for(var o=0;o<i;++o)a.push(n);return a}return a&&a.length===t||We("E_EACH_MARKOV_VAR_MUST_HAVE_PROB_VECTOR_OR_ENABLE_EXPAND_VECTORS"),a}function bt(r,e,n,t,a,i,o,u,s,f,c){return{_class:"$propagator",name:r,stepper:e,index1:void 0===n?-1:n,index2:void 0===t?-1:t,index3:void 0===a?-1:a,arg1:void 0===i?"":i,arg2:void 0===o?"":o,arg3:void 0===u?"":u,arg4:void 0===s?"":s,arg5:void 0===f?"":f,arg6:void 0===c?"":c}}function kt(r,e,n,t,a){var i=void 0,o=void 0,u=void 0,s=void 0,f=void 0;switch(e){case"eq":i="neq",o=Ut,u=ra,s=Ft,f=ea;break;case"neq":i="eq",o=ra,u=Ut,s=ea,f=Ft;break;case"lt":o=jt,s=$t,i="gte",u=Jt,f=Gt;break;case"lte":o=Ht,s=Wt,i="gt",u=Pt,f=zt;break;case"gt":return kt(r,"lt",t,n,a);case"gte":return kt(r,"lte",t,n,a);default:We("UNKNOWN_REIFIED_OP")}Sn(r,bt("reified",na,n,t,a,o,u,e,i,s,f))}function yt(r,e,n){Sn(r,bt("eq",Ut,e,n))}function xt(r,e,n){Sn(r,bt("lt",jt,e,n))}function _t(r,e,n){xt(r,n,e)}function wt(r,e,n){Sn(r,bt("lte",Ht,e,n))}function St(r,e,n,t){Sn(r,bt("mul",Kt,e,n,t))}function Et(r,e,n,t){Sn(r,bt("div",Bt,e,n,t))}function At(r,e,n){wt(r,n,e)}function Nt(r,e,n){Sn(r,bt("neq",ra,e,n))}function Dt(r,e){for(var n=0;n<e.length;n++)for(var t=e[n],a=0;a<n;++a)Nt(r,t,e[a])}function Ct(r,e,n,t,a,i,o,u){Ot(r,i,o,u,e,t),Ot(r,u,o,i,n,a),Ot(r,u,i,o,n,a)}function Ot(r,e,n,t,a,i){Sn(r,bt("ring",ta,e,n,t,a,i))}function Vt(r,e,n,t){Ct(r,"plus","min",Re,xe,e,n,t)}function Mt(r,e,n,t){Sn(r,bt("min",Xt,e,n,t))}function Tt(r,e,n,t){Ct(r,"mul","div",$,Q,e,n,t)}function Rt(r,e,n){switch(e.length){case 0:return void We("SUM_REQUIRES_VARS");case 1:return void yt(r,n,e[0]);case 2:return void Vt(r,e[0],e[1],n)}var t=void 0,a=Math.floor(e.length/2);a>1?(t=pn(r),Rt(r,e.slice(0,a),t)):t=e[0];var i=pn(r);Rt(r,e.slice(a),i),Vt(r,t,i,n)}function qt(r,e,n){switch(e.length){case 0:return void We("PRODUCT_REQUIRES_VARS");case 1:return void yt(r,n,e[0]);case 2:return void Tt(r,e[0],e[1],n)}var t=Math.floor(e.length/2),a=void 0;t>1?(a=pn(r),qt(r,e.slice(0,t),a)):a=e[0];var i=pn(r);qt(r,e.slice(t),i),Tt(r,a,i,n)}function Lt(r,e){Sn(r,bt("markov",Qt,e))}function Bt(r,e,n,t,a){var i=r.vardoms[n],o=r.vardoms[t],u=r.vardoms[a];r.vardoms[a]=It(i,o,u)}function It(r,e,n){return C(n,J(r,e))}function Ut(r,e,n,t){var a=r.vardoms,i=C(a[n],a[t]);a[n]=i,a[t]=i}function Ft(r,e){return Pr(r,e)}function jt(r,e,n,t){var a=r.vardoms[n],i=r.vardoms[t],o=ar(a),u=fr(i);r.vardoms[n]=Sr(a,u),r.vardoms[t]=Cr(i,o)}function Pt(r,e,n,t){return jt(r,e,t,n)}function $t(r,e){return ar(r)>=fr(e)}function zt(r,e){return $t(e,r)}function Ht(r,e,n,t){var a=r.vardoms[n],i=r.vardoms[t],o=ar(a),u=fr(i);r.vardoms[n]=Sr(a,u+1),r.vardoms[t]=Cr(i,o-1)}function Jt(r,e,n,t){return Ht(r,e,t,n)}function Wt(r,e){return ar(r)>fr(e)}function Gt(r,e){return Wt(e,r)}function Qt(r,e,n){var t=r.vardoms[n];if(hr(t)){var a=ar(t),i=e.varDistOptions[e.allVarNames[n]],o=i.expandVectorsWith,u=ht(null!=o,i.legend,t),s=mt(r,i.matrix,o,u.length),f=u.indexOf(a);(f<0||f>=s.length||0===s[f])&&(r.vardoms[n]=re())}}function Xt(r,e,n,t,a){var i=Yt(r.vardoms[n],r.vardoms[t],r.vardoms[a]);r.vardoms[a]=i}function Yt(r,e,n){var t=xe(r,e);return t?C(n,t):t}function Kt(r,e,n,t,a){var i=r.vardoms,o=i[n],u=i[t],s=i[a];r.vardoms[a]=Zt(o,u,s)}function Zt(r,e,n){return C(n,$(r,e))}function ra(r,e,n,t){var a=r.vardoms,i=a[n],o=a[t],s=u(i);s!==io?i===o?(a[n]=re(),a[t]=re()):a[t]=Lr(o,s):(s=u(o))!==io&&(a[n]=Lr(i,s))}function ea(r,e){var n=u(r);return n!==io&&n===u(e)}function na(r,e,n,t,a,i,o,u,s,f,c){var v=r.vardoms,l=v[a];if(gr(l))o(r,e,n,t);else if(mr(l))i(r,e,n,t);else{var d=v[n],p=v[t];c(d,p)?(v[a]=Lr(l,0),i(r,e,n,t)):f(d,p)&&(v[a]=qr(l,0),o(r,e,n,t))}}function ta(r,e,n,t,a,i,o){var u=r.vardoms,s=u[n],f=u[t],c=u[a];r.vardoms[a]=aa(s,f,c,o,i)}function aa(r,e,n,t,a){return C(n,t(r,e))}function ia(r,e,n){var t=r.stack,a=0;if(!t||0===t.length){t||(t=r.stack=[]);var i=oa(r.space,e,t,r);if(n&&n(++a)&&(n=void 0),i)return}for(;t.length>0&&!e.aborted;){var o=sa(t[t.length-1],e);if(o){var u=oa(o,e,t,r);if(n&&n(++a)&&(n=void 0),u)return}else t.pop()}r.status="end",r.more=!1}function oa(r,e,n,t){var a=ka(r,e);return a&&e.aborted,ua(a,r,e,n,t)}function ua(r,e,n,t,a){return r?(fa(a,e,t),!1):Na(e,n)?(ca(a,e,t),!0):void t.push(e)}function sa(r,e){var n=Xn(r,e);if(n!==io&&!hr(r.vardoms[n])){var t=r.next_distribution_choice++,a=Un(r,e,n,t);if(a){var i=da(r);return i.updatedVarIndex=n,i.vardoms[n]=a,i}}}function fa(r,e,n){e.failed=!0}function ca(r,e,n){r.status="solved",r.space=e,r.more=n.length>0}function va(){return ha([],void 0,0,0,"")}function la(r){var e=va();return ga(e,r),e}function da(r){return ha(r.vardoms.slice(0),r._unsolved.slice(0),void 0,void 0,void 0)}function pa(r,e){for(var n=r.vardoms,t=[],a=0,i=e.allVarNames.length;a<i;a++){var o=n[a];t[a]=se(o)}return dn(e,void 0,t)}function ha(r,e,n,t,a){return{_class:"$space",vardoms:r,_unsolved:e,next_distribution_choice:0,updatedVarIndex:-1,_lastChosenValue:-1}}function ga(r,e){Oa(r,e),ma(r,e)}function ma(r,e){var n=e.targetedVars,t=r.vardoms,a=[];if(r._unsolved=a,"all"===n)for(var i=0,o=t.length;i<o;++i)hr(t[i])||(e._varToPropagators[i]||e._constrainedAway&&e._constrainedAway.indexOf(i)>=0)&&a.push(i);else for(var u=e._varNamesTrie,s=0,f=n.length;s<f;++s)ba(n[s],u,t,a)}function ba(r,e,n,t){var a=un(e,r);a===xo&&We("E_VARS_SHOULD_EXIST_NOW ["+r+"]"),hr(n[a])||t.push(a)}function ka(r,e){if(Ea(r,e))return!0;var n=e._propagators,t=Math.ceil(r._unsolved.length*bo*.3),a=Ge(_o,t),i=0,o=[],u=1;if(r.updatedVarIndex>=0)o.push(r.updatedVarIndex);else if(ya(r,e,n,o,a,++i))return!0;for(var s=!1;o.length;){var f=[];if(Sa(r,e,n,u,o,f,a,++i)){s=!0;break}o=f,u=2}return Aa(r,e)&&(s=!0),s}function ya(r,e,n,t,a,i){for(var o=0,u=n.length;o<u;o++)if(_a(r,e,n[o],t,a,i))return!0;return!1}function xa(r,e,n,t,a,i,o){for(var u=0,s=t.length;u<s;u++)if(_a(r,e,n[t[u]],a,i,o))return!0;return!1}function _a(r,e,n,t,a,i){var o=r.vardoms,u=n.index1,s=n.index2,f=n.index3,c=o[u],v=void 0!==s&&o[s],l=void 0!==f&&o[f];if((0,n.stepper)(r,e,u,s,f,n.arg1,n.arg2,n.arg3,n.arg4,n.arg5,n.arg6),c!==o[u]){if(wr(o[u]))return!0;wa(u,a,t,i)}if(void 0!==s&&v!==o[s]){if(wr(o[s]))return!0;wa(s,a,t,i)}if(void 0!==f&&l!==o[f]){if(wr(o[f]))return!0;wa(f,a,t,i)}return!1}function wa(r,e,n,t){if("number"==typeof r)cn(e,r)!==t&&(n.push(r),nn(e,r,t));else for(var a=0,i=r.length;a<i;++a)wa(r[a],e,n,t)}function Sa(r,e,n,t,a,i,o,u){for(var s=e._varToPropagators,f=0,c=a.length;f<c;f++){var v=s[a[f]];if(v&&v.length>=t&&xa(r,e,n,v,i,o,u))return!0}return!1}function Ea(r,e){var n=e.beforeSpace;return!(!n||!n(r))&&(e.aborted=!0,!0)}function Aa(r,e){var n=e.afterSpace;return!(!n||!n(r))&&(e.aborted=!0,!0)}function Na(r,e){for(var n=r.vardoms,t=r._unsolved,a=0,i=0,o=t.length;i<o;++i){var u=t[i];hr(n[u])||(t[a++]=u)}return t.length=a,0===a}function Da(r,e){for(var n=e.allVarNames,t={},a=0,i=n.length;a<i;a++)t[n[a]]=Ca(r,a);return t}function Ca(r,e){var n=r.vardoms[e];if(wr(n))return!1;var t=u(n);return t!==io?t:te(n)}function Oa(r,e){for(var n=r.vardoms,t=e.initialDomains,a=0,i=e.allVarNames.length;a<i;a++){var o=t[a];n[a]=de(o)}}function Va(r,e,n){function t(r){return r*tu}function a(r){return r*tu+nu}function i(e,i){var o=ri(r,c+e);if(o=s(o),!(u(f(o,!0))>=0)){var v=t(o),l=n[v]++,d=v+Zo;if(l>=255)Ua(n,d,Ko);else{var p=Ia(n,d);if(l<ru){var h=a(o);Ua(n,h+l*eu,c)}Ua(n,d,p|i)}}}var o=e.varNames.length,s=e.getAlias,f=e.getDomain,c=0;return n||(n=new Uint8Array(o*tu)),n.fill(0),function(){for(c=0;c<r.length;){var e=c;switch(r[c]){case hs:i(Ys,Lo|qo),i(Ks,Lo|qo),c+=Qs;break;case gs:i(Ys,Jo|qo),i(Ks,Wo|qo),c+=Qs;break;case ws:i(Ys,Yo),i(Ks,Yo),c+=Qs;break;case _s:for(var n=ri(r,c+1),t=0;t<n;++t)i(Gs+2*t,Lo);c+=Gs+2*n;break;case ps:i(Ys,Io),i(Ks,Uo),c+=Qs;break;case bs:i(Ys,Lo),i(Ks,Lo),c+=Qs;break;case ls:for(var a=ri(r,c+1),o=0;o<a;++o)i(Gs+2*o,Lo);c+=Gs+2*a;break;case ms:for(var u=ri(r,c+1),s=0;s<u;++s)i(Gs+2*s,Go);c+=Gs+2*u;break;case ys:for(var f=ri(r,c+1),v=0;v<f;++v)i(Gs+2*v,Lo|qo);c+=Gs+2*f;break;case xs:for(var l=ri(r,c+1),d=0;d<l;++d)i(Gs+2*d,Qo);c+=Gs+2*l;break;case ks:for(var p=ri(r,c+1),h=0;h<p;++h)i(Gs+2*h,Lo);c+=Gs+2*p;break;case Os:for(var g=ri(r,c+1),m=0;m<g;++m)i(Gs+2*m,$o|qo);i(Gs+2*g,zo),c+=Gs+2*g+2;break;case Vs:for(var b=ri(r,c+1),k=0;k<b;++k)i(Gs+2*k,Lo);i(Gs+2*b,Ho),c+=Gs+2*b+2;break;case ds:for(var y=ri(r,c+1),x=0;x<y;++x)i(Gs+2*x,Bo|qo);c+=Gs+2*y;break;case Es:for(var _=ri(r,c+1),w=0;w<_;++w)i(Gs+2*w,Lo|qo);i(Gs+2*_,Lo),c+=Gs+2*_+2;break;case As:i(1,Lo|qo),i(3,Lo|qo),i(5,Lo),c+=Ws;break;case Ns:i(1,Po|qo),i(3,Po|qo),i(5,Lo),c+=Ws;break;case Rs:case qs:i(1,Lo|qo),i(3,Lo|qo),i(5,Lo|qo),c+=Ws;break;case Ss:for(var S=ri(r,c+1),E=0;E<S;++E)i(Gs+2*E,Fo);i(Gs+2*S,jo),c+=Gs+2*S+2;break;case Ds:case Cs:for(var A=ri(r,c+1),N=0;N<A;++N)i(Gs+2*N,Lo);i(Gs+2*A,Lo),c+=Gs+2*A+2;break;case Ms:for(var D=ri(r,c+1),C=0;C<D;++C)i(Gs+2*C,Lo|qo);i(Gs+2*D,Xo|qo),c+=Gs+2*D+2;break;case Ts:for(var O=ri(r,c+1),V=0;V<O;++V)i(Gs+2*V,Lo|qo);i(Gs+2*O,Lo|qo),c+=Gs+2*O+2;break;case vs:if(0!==c)return We(" ! compiler problem @",e);++c;break;case zs:return;case Bs:i(1,Lo|qo),c+=Hs;break;case Ls:i(1,Lo),c+=Hs;break;case Is:c+=Hs+ri(r,c+1);break;case Us:c+=Js+ei(r,c+1);break;case Fs:++c;break;case js:c+=2;break;case Ps:c+=3;break;case $s:c+=4;break;default:Je().error("(cnt) unknown op",c," at",c),xi(r,c,"(bnt) expecting bounty to run after the minifier and these ops should be gone")}}xi(r,c,"ML OOB")}(),n}function Ma(r,e){return r[e*tu]}function Ta(r,e){r[e*tu]=0}function Ra(r,e,n){return Ia(r,e*tu+Zo)}function qa(r,e,n,t){return Ia(r,e*tu+nu+n*eu)}function La(r,e){var n=0|Ma(r,e);return 0===n?"[ constant or marked var ]":Ba(n&&Ra(r,e,!0))}function Ba(r){var e="0".repeat(32-r.toString(2).length)+r.toString(2),n=[];return r||n.push("BOUNTY_NONE"),(r&qo)===qo?n.push("NOT_BOOLY"):n.push("BOOLY"),(r&Lo)===Lo&&n.push("OTHER"),(r&Jo)===Jo&&n.push("LTE_LHS"),(r&Wo)===Wo&&n.push("LTE_RHS"),(r&Fo)===Fo&&n.push("ISALL_ARG"),(r&jo)===jo&&n.push("ISALL_RESULT"),(r&Io)===Io&&n.push("IMP_LHS"),(r&Uo)===Uo&&n.push("IMP_RHS"),(r&Po)===Po&&n.push("ISLTE_ARG"),(r&$o)===$o&&n.push("ISSAME_ARG"),(r&zo)===zo&&n.push("ISSAME_RESULT"),(r&Ho)===Ho&&n.push("ISSOME_RESULT"),(r&Go)===Go&&n.push("NALL"),(r&Bo)===Bo&&n.push("DIFF"),(r&Qo)===Qo&&n.push("SOME"),(r&Xo)===Xo&&n.push("SUM_RESULT"),(r&Yo)===Yo&&n.push("XOR"),(r&Ko)===Ko&&n.push("JUST_IGNORE"),"[ "+e+": "+n.join(", ")+" ]"}function Ia(r,e){return r[e++]<<24|r[e++]<<16|r[e++]<<8|r[e]}function Ua(r,e,n){r[e++]=n>>24&255,r[e++]=n>>16&255,r[e++]=n>>8&255,r[e]=255&n}function Fa(r,n,t){function a(){++Fe}function i(r,e){return Ve(ri(r,e))}function o(r,e,n,t){if(!qe(e)){var a=Ra(r,e,t);return n?a:s(a)}return 0}function s(r){return(r|qo)^qo}function f(r,e){return(r&e)===e}function c(r,e){return qe(e)?0:Ma(r,e)}function v(r,e){var n=ri(r,e+1),t=i(r,e+Ys),u=c(Be,t);if(!(u>1&&u<ru&&Z(r,e,n,t,u)))if(2===n){var s=i(r,e+Ks),v=c(Be,s);if(t!==s){if(1===u)return M(r,e,t,s,t,s);if(1===v)return M(r,e,s,t,t,s);var l=Jo|Wo|Qo|Go|Io|Uo;if(u>1&&u<=ru){var d=o(Be,t),p=(d&l)>0,h=(d|l|Bo)^(l|Bo);if(f(d,Bo)&&p&&!h&&Jr(e,t,u,s))return;if(f(d,Bo|Yo)&&Gr(r,e,t,u,s))return;if(Qr(t,s,u))return}if(v>1&&v<=ru){var g=o(Be,s),m=(g|l|Bo)^(l|Bo);if((g&l)>0&&!m&&Jr(e,s,v,t))return;if(f(g,Bo|Yo)&&Gr(r,e,s,v,t))return;if(Qr(s,t,v))return;var b=De(t,!0),k=De(s,!0);if(yr(b)&&b===k)return ni(r,e,ws),Ta(Be,t),Ta(Be,s),void a()}Le+=Qs}else Pe=!0}else Le+=Gs+2*n}function l(r,e){var n=i(r,e+Ys),t=i(r,e+Ks),a=De(n,!0),u=De(t,!0),s=c(Be,n),v=c(Be,t);if(n!==t){if(!xr(a)||mr(u))return Pe=!0,!1;if(1===s)return T(r,e,n,t,!0);if(1===v)return T(r,e,n,t,!1);if(s>0){var l=o(Be,n);if(l===Io&&$r(r,n,s))return;if((l===Go||l===(Go|Io))&&Mr(r,n,s))return;if(2===s&&l===(Io|Qo)&&Br(r,e,n,s))return;if(f(l,jo)){if(lr(r,e,n,s))return;if(2===s&&sr(r,e,n,s))return}if(s>=3){if(l===(Qo|Go|Io)&&se(n,s))return;if(l===(Qo|Go|Io|Uo)&&ce(n,s))return}}kr(a)&&kr(u)&&2===v&&o(Be,t,!0)===(Uo|jo)&&Er(t,e,v,n)||(Le+=Qs)}else Pe=!0}function d(r,e){var n=ri(r,e+1),t=Gs+2*n+2,a=i(r,e+Gs+2*n),u=c(Be,a);if(u>0&&u<ru){if(1===u)return q(r,e,n,a);var s=o(Be,a);if(s===(jo|Fo)&&L(r,a,u))return;if(2===u&&s===(Go|jo)&&Dr(r,a,e,u))return;if(s===(Go|jo)&&zr(r,a,e,u))return}Le+=t}function p(r,e){var n=ri(r,e+1),t=i(r,e+Gs+2*n);if(2===n){var o=i(r,e+Ys),s=i(r,e+Ks),f=c(Be,o),v=c(Be,s);if(1===c(Be,t))return R(r,e,o,s,t,t);if(1===f&&h(o,s,t))return R(r,e,o,s,t,o);if(1===v&&h(s,o,t))return R(r,e,o,s,t,s);var l=De(t,!0),d=De(o,!0),p=De(s,!0);if(yr(l)){if(yr(d)&&hr(p)){if(gr(p))return di(r,e,2,_s,o,t),Ta(Be,o),Ta(Be,s),Ta(Be,t),void a();if(fr(d)===u(p))return di(r,e,2,ws,o,t),Ta(Be,o),Ta(Be,s),Ta(Be,t),void a()}if(hr(d)&&yr(p)){if(gr(d))return di(r,e,2,_s,s,t),Ta(Be,o),Ta(Be,s),Ta(Be,t),void a();if(fr(p)===u(d))return di(r,e,2,ws,s,t),Ta(Be,o),Ta(Be,s),Ta(Be,t),void a()}}Le=e+Xs}else Le=e+Gs+2*n+2}function h(r,e,n){var t=De(n,!0);if(mr(t))return!0;var a=De(r,!0),i=De(e,!0),o=C(a,i);return gr(t)?!!o||(Ce(r,re(),!1,!0),!1):o===i&&o!==a}function g(r,e){var n=i(r,e+1),t=i(r,e+3),a=i(r,e+5),o=c(Be,n),u=c(Be,t);return 1===c(Be,a)?j(r,e,n,t,a,a):1===o&&m(n,t,a,n,t)?j(r,e,n,t,a,n):1===u&&m(t,n,a,n,t)?j(r,e,n,t,a,t):void(Le=e+Ws)}function m(r,e,n,t,a){var i=De(t,!0),o=De(a,!0),u=De(n,!0);return mr(u)?r===t?ar(i)<ar(o):fr(o)>fr(i):gr(u)?r===t?ar(i)>=ar(o):fr(o)<=fr(i):r===t?ar(i)<ar(o)&&fr(i)>=fr(o):fr(o)>fr(i)&&ar(o)<=ar(i)}function b(r,e){var n=i(r,e+1),t=i(r,e+3),a=i(r,e+5),u=c(Be,n),s=c(Be,t),v=c(Be,a);if(xr(De(a,!0))){if(1===v)return P(r,e,n,t,a,a);var l=De(n,!0),d=De(t,!0);if(1===u&&k(n,t,n,t,l,d))return P(r,e,n,t,a,n);if(1===s&&k(t,n,n,t,l,d))return P(r,e,n,t,a,t);if(v>0&&v<ru){if(hr(l)&&f(o(Be,a),Uo)&&f(o(Be,t),Io)&&Ir(e,a,n,t,v))return;if(hr(d)&&f(o(Be,a),Uo)&&f(o(Be,n),Io)&&Fr(e,a,n,t,v))return}Le=e+Ws}else Pe=!0}function k(r,e,n,t,a,i){return r===n?ar(a)<=ar(i)&&fr(a)>fr(i):fr(i)>=fr(a)&&ar(i)<ar(a)}function y(r,e){var n=ri(r,e+1),t=Gs+2*n+2,a=i(r,e+Gs+2*n),o=c(Be,a);if(1===o)return $(r,e,n,a,o);Le+=t}function x(r,e){var n=ri(r,e+1);{if(2===n){var t=i(r,e+Ys),a=i(r,e+Ks),o=i(r,e+Zs),u=c(Be,t),s=c(Be,a);return 1===c(Be,o)?z(r,e,t,a,o,o):1===u&&_(t,a,o)?z(r,e,t,a,o,t):1===s&&_(a,t,o)?z(r,e,t,a,o,a):void(Le=e+Xs)}Le=e+Gs+2*n+2}}function _(r,e,n){var t=De(n,!0);if(gr(t))return!0;var a=De(r,!0),i=De(e,!0),o=C(a,i);return mr(t)?!!o||(Ce(r,re(),!1,!0),!1):o===i&&o!==a}function w(r,e){var n=ri(r,e+1),t=Gs+2*n+2,a=i(r,e+Gs+2*n);if(1===c(Be,a))return H(r,e,a,n);for(var o=0;o<n;++o){var u=i(r,e+Gs+2*o);if(gr(De(u,!0))){Pe=!0;break}}Le+=t}function S(r,e){var n=i(r,e+Ys),t=i(r,e+Ks),a=c(Be,n),o=c(Be,t);if(n!==t)return 1===a?J(r,e,n,t,"lhs"):1===o?J(r,e,n,t,"rhs"):void(Le+=Qs);Pe=!0}function E(r,e){var n=i(r,e+Ys),t=i(r,e+Ks),a=c(Be,n),u=c(Be,t);if(n!==t){if(!(1===a&&W(r,e,n,t,!0)||1===u&&W(r,e,n,t,!1))){if(a>0){var s=o(Be,n);if((s===Go||s===(Go|Jo))&&Vr(r,n,a))return;if(s===Jo&&Pr(r,n,a))return;if(2===a&&s===(Jo|Qo)&&Tr(r,e,n,a))return;if(a>=3){if(s===(Qo|Go|Jo)&&ue(n,a))return;if(s===(Qo|Go|Jo|Wo)&&fe(n,a))return}if(f(s,jo)){if(cr(r,e,n,a))return;if(2===a&&ur(r,e,n,a))return}}if(2===u){var v=o(Be,t);if(v===(Wo|jo)&&pr(t,e,u))return;if(v===(Wo|zo)&&Nr(t,e,u,n))return}Le+=Qs}}else Pe=!0}function A(r,e){var n=ri(r,e+1),t=i(r,e+Ys),a=c(Be,t);if(!(a>1&&a<ru&&rr(r,e,n,t,a)))if(2!==n||i(r,e+Ys)!==i(r,e+Ks)){for(var u=0;u<n;++u){var s=i(r,e+Gs+2*u),f=c(Be,s);if(f>0&&o(Be,s)===Go&&ie(s,f))return!0}Le+=Gs+2*n}else Pe=!0}function N(r,e){var n=ri(r,Le+1),t=i(r,e+Ys),a=c(Be,t);if(!(a>1&&a<ru&&er(r,e,n,t,a))){if(2===n){var u=i(r,e+Ks);if(t===u)return void(Pe=!0);if(1===a)return void G(r,e,t,u,t,u);if(1===c(Be,u))return void G(r,e,u,t,t,u)}for(var s=!1,f=0;f<n;++f){var v=i(r,e+Gs+2*f),l=c(Be,v);if(l>0&&o(Be,v)===Qo&&oe(v,l))return!0;gr(De(v,!0))&&(s=!0)}s&&(Pe=!0),Le+=Gs+2*n}}function D(r,e){for(var n=ri(r,e+1),t=e+Gs,a=Gs+2*n+2,u=i(r,t+2*n),s=De(u,!0),f=c(Be,u),v=yr(s),l=!0,d=!0,p=Yr(0),h=0,g=0,m=0,b=-1,k=!1,y=0;y<n;++y){var x=i(r,t+2*y),_=De(x,!0),w=ar(_),S=fr(_);p=Re(p,_),h+=w,g+=S,w===S?(k=b>=0,m=w,b=y):(yr(_)||(d=!1),kr(_)||(l=!1))}if(!k)if(v&&d&&fr(s)===g)ni(r,e,Ss);else{if(1===f){if(p===C(s,p))return Q(r,e,n,u);if(l&&s===Kr(0,n-1))return ir(r,e,n,u);if(l&&s===Kr(1,n))return or(r,e,n,u)}if(f>=2){var E=o(Be,u);if(d&&2===f){if(E===($o|Xo)&&ve(r,e,u,f,n,p,h,g,m,b,d))return;if(E===(Po|Xo)&&he(r,e,u,f,n,h,g,m,b))return}if(3===f&&2===n&&E===($o|Xo)&&be(r,e,u,f,p,n))return;if(f<ru&&me(r,e,u,f,p,n))return}Le+=a}}function O(r,e){var n=ri(r,e+1);if(2===n){var t=i(r,e+Ys),a=i(r,e+Ks),u=c(Be,t),s=c(Be,a);if(t===a)return void(Pe=!0);if(1===u)return X(r,e,t,a,t,a);if(1===s)return X(r,e,a,t,t,a);if(u>0&&s>0){var v=o(Be,t,!0),l=o(Be,a,!0),d=!f(v,qo),p=!f(l,qo);if(d||p)return ge(r,e,t,d,a,p)}}Le+=Gs+2*n}function V(r,e){var n=i(r,e+Ys),t=i(r,e+Ks),a=c(Be,n),u=c(Be,t);if(n!==t){if(1===a)return Y(r,e,n,t,n,t);if(1===u)return Y(r,e,t,n,n,t);var s=De(n,!0),v=De(t,!0);if(xr(s)&&xr(v)){if(a>0&&u>0){var l=o(Be,n,!0),d=o(Be,t,!0),p=!f(l,qo),h=!f(d,qo),g=Qo|Go|Io|Uo|Yo;if(a<ru){if((l&g)===l&&Wr(e,n,a,t))return;if(2===a){if(f(l,jo)&&Zr(n,t,e,a,u))return;if(p&&f(l,Ho)&&ne(n,t,e,a,u))return;if(l===(Yo|Qo)&&ae(n,t,e,a))return}if(Xr(n,t,a,v,K(v),h))return}if(u<ru){if(yr(v)&&(d&g)===d&&Wr(e,t,u,n))return;if(2===u){if(f(d,jo)&&Zr(t,n,e,u,a))return;if(h&&f(d,Ho)&&ne(t,n,e,u,a))return;if(d===(Yo|Qo)&&ae(t,n,e,u))return}if(Xr(t,n,u,s,K(s),p))return}}Le+=Qs}else Pe=!0}else Pe=!0}function M(r,e,n,t,i,o){Me.push(function(r,e,n,t){var a=n(i),u=n(o);if(K(a)<K(u)){var s=e(i);t(o,Lr(u,s))}else{var f=e(o);t(i,Lr(a,f))}}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a()}function T(r,e,n,t,i){Me.push(function(r,e,a,o){var u=a(n),s=a(t);if(i)if(mr(s)){var f=Lr(u,0);u!==f&&o(n,f)}else{var c=I(u,0);u!==c&&o(n,c)}else if(mr(u)){var v=Lr(s,0);u!==v&&o(t,v)}else{var l=I(s,0);s!==l&&o(t,l)}}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a()}function R(r,e,n,t,i,o){Me.push(function(r,e,a,o){var s=a(n),f=a(t),c=a(i);hr(s)?hr(f)?(c=s!==f?Lr(c,0):qr(c,0),o(i,c)):xr(c)?(f=Lr(f,u(s)),o(t,f),c=Lr(c,0),o(i,c)):gr(c)?o(t,s):(f=Lr(f,u(s)),o(t,f)):hr(f)?xr(c)?(s=Lr(s,u(f)),o(n,s),c=Lr(c,0),o(i,c)):gr(c)?o(n,f):(s=Lr(s,u(f)),o(n,s)):xr(c)?(C(s,f)!==Qi&&(f=Lr(f,e(n)),o(t,f)),c=Lr(c,0),o(i,c)):gr(c)?(f=Yr(e(n,C(s,f))),o(t,f)):(f=Lr(f,e(n)),o(t,f))}),ii(r,e,Xs),Ta(Be,n),Ta(Be,t),Ta(Be,i),a()}function q(r,e,n,t){var i=Se(r,e,n);Me.push(function(r,e,a,o){for(var u=1,s=0;s<n;++s)if(0===e(i[s])){u=0;break}var f=_r(a(t),u);o(t,f)}),ii(r,e,Gs+2*n+2),Ta(Be,t),a()}function L(r,e,n){var t=De(e,!0);if(!kr(t))return!1;for(var a=[],o=[],u=[],s=[],f=[],c=0;c<n;++c){var v=qa(Be,e,c);if(f.indexOf(v)<0){for(var l=ri(r,v+1),d=i(r,v+Gs+2*l),p=[],h=!1,g=0;g<l;++g){var m=i(r,v+Gs+2*g);p.push(m),m===e&&(h=!0)}d!==e?a.push(v):h?u.push(v):o.push(v),s.push(p),f.push(v)}}return!o.length&&(a.length?B(r,e,s,f,t,n,a,u):F(r,e,s,f,t))}function B(r,e,n,t,o,u,s,f){if(3!==u)return!1;var c=s[0],v=ri(r,c+1),l=f[0],d=ri(r,l+1),p=i(r,c+Gs+2*v);if((2!==v||2!==d)&&!U(r,e,p,n))return!1;var h=i(r,c+Ys);h===e&&(h=i(r,c+Ks));var g=i(r,l+Ys);return g===e&&(g=i(r,l+Ks)),di(r,c,c,ps,p,h),di(r,l,l,ps,p,g),Me.push(function(r,n,t,a){var i=t(e),o=i;0===n(h)?o=qr(o,0):n(p)?o=Lr(o,0):n(g)>0&&(o=qr(o,0)),i!==o&&a(e,o)}),Ta(Be,h),Ta(Be,g),Ta(Be,e),Ta(Be,p),a(),!0}function U(r,e,n,t){for(var a=[],i=0;i<t.length;++i)for(var o=t[i],u=i>=2,s=0;s<o.length;++s){var f=o[s];f!==e&&(!u&&s<2?u=!0:a.push(f))}var c=a.length;if(c){var v=mi(r,0,c,Qs);if(!v)return!1;for(var l=0;l<c;){var d=v.pop(),p=ki(r,d);do{var h=a[l];vi(r,d,ki(r,d),ps,[n,h]),++l,p-=Qs,d+=Qs}while(p>=Qs&&l<c)}}return!0}function F(r,e,n,t,i){Me.push(function(r,t,a,i){for(var o=!0,u=0,s=n.length;u<s;++u){for(var f=n[u],c=0,v=f.length;c<v;++c){var l=f[c];l!==e&&(mr(a(l))||(o=!1))}if(!o){i(e,Yr(0));break}}});for(var o=0,u=t.length;o<u;++o){var s=t[o],f=n[o];ii(r,s,Gs+2*f.length+2);for(var c=0,v=f.length;c<v;++c)Ta(Be,f[c])}return a(),!0}function j(r,e,n,t,i,o){Me.push(function(r,e,a,o){var u=a(n),s=a(t),f=a(i);xr(f)?(f=e(n)<e(t)?Lr(f,0):qr(f,0),o(i,f)):gr(f)?(u=Yr(fr(u)),s=Yr(ar(s)),o(n,u),o(t,s)):(u=Yr(ar(u)),s=Yr(fr(s)),o(n,u),o(t,s))}),ii(r,e,Ws),Ta(Be,n),Ta(Be,t),Ta(Be,i),a()}function P(r,e,n,t,i,o){Me.push(function(r,e,a,o){var u=a(n),s=a(t),f=a(i);xr(f)?(f=e(n)<=e(t)?Lr(f,0):qr(f,0),o(i,f)):gr(f)?(u=Yr(fr(u)),s=Yr(ar(s)),o(n,u),o(t,s)):(u=Yr(ar(u)),s=Yr(fr(s)),o(n,u),o(t,s))}),ii(r,e,Ws),Ta(Be,n),Ta(Be,t),Ta(Be,i),a()}function $(r,e,n,t,i){var o=Se(r,e,n);Me.push(function(r,e,a,i){for(var u=0,s=0;s<n;++s)if(0===e(o[s])){u=1;break}var f=_r(a(t),u);i(t,f)}),ii(r,e,Gs+2*n+2),Ta(Be,t),a()}function z(r,e,n,t,i,o){Me.push(function(r,e,a,o){var s=a(n),f=a(t),c=C(s,f),v=a(i);if(hr(v))gr(v)?c&&(hr(s)?o(t,Lr(f,u(s))):o(n,Lr(s,e(t)))):(e(n,c),e(t,a(n)));else{if(c)if(hr(s))v=_r(v,s===f);else if(hr(f))o(n,f),v=_r(v,!0);else{var l=Yr(ar(c));o(n,l),o(t,l),v=_r(v,!0)}else v=_r(v,!1);o(i,v)}}),ii(r,e,Xs),Ta(Be,n),Ta(Be,t),Ta(Be,i),a()}function H(r,e,n,t){var i=Se(r,e,t);Me.push(function(r,e,t,a){for(var o=!1,u=0;u<i.length;++u)if(e(i[u])>0){o=!0;break}var s=t(n);s=o?Lr(s,0):qr(s,0),a(n,s)}),ii(r,e,Gs+2*t+2),Ta(Be,n),a()}function J(r,e,n,t,i){Me.push(function(r,e,a,i){var o=a(n),u=a(t),s=fr(o),f=ar(u);if(s<f);else if(ar(o)>=f){var c=ar(o);i(n,qr(o,c)),i(t,Cr(u,c))}else i(n,Sr(o,f))}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a()}function W(r,e,n,t,i){var o=De(n,!0),u=De(t,!0),s=ar(o),f=qr(o,fr(u)),c=Rr(u,s);return!f||hr(f)||!c||hr(c)?(Pe=!0,!1):(o!==f&&Ce(n,f),u!==c&&Ce(t,c),Me.push(function(r,e,a,o){var u=a(n),s=a(t),f=fr(u),c=ar(s);if(f>c)if(i){var v=qr(u,c);o(n,v)}else{var l=Rr(s,f);o(t,l)}}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a(),!0)}function G(r,e,n,t,i,o){Me.push(function(r,e,a,i){var o=a(t),u=a(n);gr(o)?i(n,Lr(u,0)):gr(u)?i(t,Lr(o,0)):mr(o)||mr(o)||i(n,Lr(u,0))}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a()}function Q(r,e,n,t){var i=Se(r,e,n);Me.push(function(r,e,n,a){for(var o=0,u=0;u<i.length;++u)o+=e(i[u]);var s=I(n(t),o);a(t,s)}),ii(r,e,Gs+2*n+2),Ta(Be,t),a()}function X(r,e,n,t,i,o){Me.push(function(r,e,n,t){var a=n(i),u=n(o);gr(a)?t(o,qr(u,0)):gr(u)?t(i,qr(a,0)):mr(a)?t(o,Lr(u,0)):mr(u)?t(i,Lr(a,0)):(t(i,Lr(a,0)),t(o,Lr(u,0)))}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a()}function Y(r,e,n,t,i,o){Me.push(function(r,e,n,t){var a=n(i),u=n(o);gr(a)?t(o,Lr(u,0)):gr(u)?t(i,Lr(a,0)):mr(a)?t(o,qr(u,0)):mr(u)?t(i,qr(a,0)):(t(i,Lr(a,0)),t(o,qr(u,0)))}),ii(r,e,Qs),Ta(Be,n),Ta(Be,t),a()}function Z(r,e,n,t,a){for(var o=0;o<a;++o){var u=qa(Be,t,o);if(u!==e){var s=Ka(r,u);if(s===ds){var f=ri(r,u+1);if(n>f&&(tr(r,e,n),tr(r,u,f),nr(r,u,f,e,n)))return Ee(r,u,f),ii(r,u,Gs+2*f),!0}else if(s===Es){var c=ri(r,u+1);if(n>=c&&(tr(r,e,n),tr(r,u,c),nr(r,u,c,e,n))){var v=i(r,u+Gs+2*c),l=De(v),d=Lr(l,0);return l!==d&&Ce(v,d),Ee(r,u,c),ii(r,u,Gs+2*c+2),!0}}else if(s===Os){var p=ri(r,u+1);if(n<=p&&(tr(r,e,n),tr(r,u,p),nr(r,e,n,u,p))){var h=i(r,u+Gs+2*p),g=De(h),m=qr(g,0);return g!==m&&Ce(h,m),Ee(r,u,p),ii(r,u,Gs+2*p+2),!0}}}}}function rr(r,e,n,t,a){for(var o=0;o<a;++o){var u=qa(Be,t,o);if(u!==e){var s=Ka(r,u);if(s===ms){var f=ri(r,u+1);if(n<f&&(tr(r,e,n),tr(r,u,f),nr(r,e,n,u,f)))return Ee(r,u,f),ii(r,u,Gs+2*f),!0}else if(s===Ds){var c=ri(r,u+1);if(n<=c&&(tr(r,e,n),tr(r,u,c),nr(r,e,n,u,c))){var v=i(r,u+Gs+2*c),l=De(v),d=Lr(l,0);return l!==d&&Ce(v,d),Ee(r,u,c),ii(r,u,Gs+2*c+2),!0}}else if(s===Ss){var p=ri(r,u+1);if(n<=p&&(tr(r,e,n),tr(r,u,p),nr(r,e,n,u,p))){var h=i(r,u+Gs+2*p),g=De(h),m=qr(g,0);return g!==m&&Ce(h,m),Ee(r,u,p),ii(r,u,Gs+2*p+2),!0}}}}}function er(r,e,n,t,o){for(var u=0;u<o;++u){var s=qa(Be,t,u);if(s!==e){var f=Ka(r,s);if(f===xs){var c=ri(r,s+1);if(n<c&&(tr(r,e,n),tr(r,s,c),nr(r,e,n,s,c)))return Ee(r,s,c),ii(r,s,Gs+2*c),a(),!0}else if(f===Vs){var v=ri(r,s+1);if(n<=v&&(tr(r,e,n),tr(r,s,v),nr(r,e,n,s,v))){var l=i(r,s+Gs+2*v),d=De(l),p=Lr(d,0);return d!==p&&Ce(l,p),Ee(r,s,v),ii(r,s,Gs+2*v+2),a(),!0}}else if(f===Cs){var h=ri(r,s+1);if(n<=h&&(tr(r,e,n),tr(r,s,h),nr(r,e,n,s,h))){var g=i(r,s+Gs+2*h),m=De(g),b=qr(m,0);return m!==b&&Ce(g,b),Ee(r,s,h),ii(r,s,Gs+2*h+2),a(),!0}}}}}function nr(r,e,n,t,a){for(var i=0,o=0,u=ri(r,e+Gs+2*i),s=0;o<a;){for(s=ri(r,t+Gs+2*o);u===s;){if(++i>=n)return!0;u=ri(r,e+Gs+2*i)}++o}return!1}function tr(r,e,n){for(var t=0;t<n;++t){var a=e+Gs+2*t,i=ri(r,a),o=Ve(i);i!==o&&ti(r,a,o)}_i(r,e+Gs,n)}function ir(r,e,n,t){var i=Se(r,e,n);Me.push(function(r,e,n,a){for(var o=n(t),s=0,f=0;f<i.length;++f){var c=u(n(i[f]));c>=0&&(s+=c)}for(var v=ar(Rr(o,s)),l=v-s,d=0;d<i.length;++d){var p=i[d],h=n(p);hr(h)||(l>0?(h=Lr(h,0),--l):h=Lr(h,1),e(p,h))}a(t,I(o,v))}),pi(r,e,n,ms,i),Ta(Be,t),a()}function or(r,e,n,t){var i=Se(r,e,n);Me.push(function(r,e,a,o){for(var u=!0,s=-1,f=0;f<n;++f){var c=i[f],v=a(c);if(mr(v)){u=!1;break}gr(v)||(s=c)}if(u){var l=a(s);o(s,l=Lr(l,0))}for(var d=0,p=0;p<n;++p)d+=e(i[p]);var h=a(t);h=I(h,d),o(t,h)}),ni(r,e,xs),ti(r,e+1,n);for(var o=0;o<n;++o)ti(r,e+Gs+2*o,i[o]);ui(r,e+Gs+2*n,2),Ta(Be,t),a()}function ur(r,e,n,t){var o=i(r,e+Ks);if(!kr(De(n,!0))||!kr(De(o,!0)))return!1;var u=qa(Be,n,0),s=qa(Be,n,1),f=u===e?s:u;if(2!==ri(r,f+1))return!1;var c=i(r,f+Ys),v=i(r,f+Ks);return!(!kr(De(c,!0))||!kr(De(v,!0)))&&(li(r,f,2,Ds,c,v,n),fi(r,e,2,xs,n,o),Ta(Be,n),Ta(Be,o),Ta(Be,c),Ta(Be,v),a(),!0)}function sr(r,e,n,t){var o=i(r,e+Ks);if(!kr(De(n,!0))||!kr(De(o,!0)))return!1;var u=qa(Be,n,0),s=qa(Be,n,1),f=u===e?s:u;if(2!==ri(r,f+1))return!1;if(!kr(De(c,!0))||!kr(De(v,!0)))return!1;var c=i(r,f+Ys),v=i(r,f+Ks);return li(r,f,2,Ds,c,v,n),fi(r,e,2,xs,n,o),Ta(Be,n),Ta(Be,o),Ta(Be,c),Ta(Be,v),a(),!0}function cr(r,e,n,t){for(var a=i(r,e+Ks),o=Math.min(t,ru),u=0;u<o;++u){var s=qa(Be,n,u);if(s!==e&&Ka(r,s)===Ss&&vr(e,s,n,a))return!0}return!1}function vr(e,n,t,o){for(var u=ri(r,n+1),s=(i(r,n+Gs+2*u),0);s<u;++s)if(i(r,n+Gs+2*s)===o)return ii(r,e,Qs),Ta(Be,t),Ta(Be,o),a(),!0;return!1}function lr(r,e,n,t){for(var a=i(r,e+Ks),o=Math.min(t,ru),u=0;u<o;++u){var s=qa(Be,n,u);if(s!==e&&Ka(r,s)===Ss&&dr(e,s,n,a))return!0}return!1}function dr(e,n,t,o){for(var u=ri(r,n+1),s=(i(r,n+Gs+2*u),0);s<u;++s)if(i(r,n+Gs+2*s)===o)return ii(r,e,Qs),Ta(Be,t),Ta(Be,o),a(),!0;return!1}function pr(e,n,t){var o=qa(Be,e,0),u=qa(Be,e,1),s=n===o?u:o,f=i(r,n+Ys),c=De(f,!0),v=De(e,!0);if(fr(c)>1&&fr(v)>1)return!1;if(mr(v))return Pe=!0,!1;if(fr(c)>fr(v))return Pe=!0,!1;for(var l=ri(r,s+1),d=fr(c),p=0;p<l;++p){var h=i(r,s+Gs+2*p);if(fr(De(h,!0))<d)return!1}if(l<2)return!1;if(l>2&&!wr(r,s,l,f))return!1;var g=i(r,s+Ys),m=i(r,s+Ks);Ta(Be,f),Ta(Be,e);var b=Se(r,s,l);return fi(r,n,2,gs,f,g),di(r,s,2,gs,f,m),Me.push(function(r,n,t,a){var i=t(e);i=Rr(i,fr(t(f)));for(var o=!1,u=0;u<b.length;++u){var s=t(b[u]);if(gr(s)||!mr(i)&&0===n(s)){o=!0;break}}i=o?qr(i,0):Lr(i,0),a(e,i)}),a(),!0}function wr(r,e,n,t){var a=n-2,o=mi(r,0,a,Qs);if(!o)return!1;for(var u=0;u<a;){var s=o.pop(),f=ki(r,s);do{var c=i(r,e+Gs+2*(u+2));ni(r,s,gs),ti(r,s+1,2),ti(r,s+Ys,t),ti(r,s+Ks,c),++u,f-=Qs,s+=Qs}while(f>=Qs&&u<a);f&&ui(r,s,f)}return!0}function Er(e,n,t,o){var u=qa(Be,e,0),s=qa(Be,e,1),f=n===u?s:u,c=De(o,!0),v=De(e,!0);if(fr(c)>1&&fr(v)>1)return!1;if(mr(v))return Pe=!0,!1;if(fr(c)>fr(v))return Pe=!0,!1;var l=ri(r,f+1);if(l<2)return Pe=!0,!1;if(l>2&&!Ar(r,f,l,o))return!1;var d=i(r,f+Ys),p=i(r,f+Ks);Ta(Be,o),Ta(Be,e);var h=Se(r,f,l);return fi(r,n,2,ps,o,d),di(r,f,l,ps,o,p),Me.push(function(r,n,t,a){var i=t(e),u=t(o),s=!1,f=!1;mr(u)&&(s=!0);for(var c=!0,v=0;v<l;++v){var d=t(h[v]);if(gr(d)){f=!0,c=!1;break}br(d)&&(c=!1)}c&&(s=!0);var p=!1;s?(a(e,Lr(i,0)),p=!0):f?(a(e,qr(i,0)),p=!1):p=n(e)>0,p||a(o,qr(u,0));for(var g=0;g<l;++g){var m=h[g],b=t(m);if(p)a(m,Lr(b,0));else{if(gr(b)){!0;break}if(br(b)){a(m,qr(b,0)),!0;break}}}}),a(),!0}function Ar(r,e,n,t){var a=n-2,o=mi(r,0,a,Qs);if(!o)return!1;for(var u=0;u<a;){var s=o.pop(),f=ki(r,s);do{var c=i(r,e+Gs+2*(u+2));ni(r,s,ps),ti(r,s+1,2),ti(r,s+Ys,t),ti(r,s+Ks,c),++u,f-=Qs,s+=Qs}while(f>=Qs&&u<a);f&&ui(r,s,f)}return!0}function Nr(e,n,t,o){var u=qa(Be,e,0),s=qa(Be,e,1),f=u===n?s:u;if(2!==ri(r,f+1))return!1;var c=i(r,f+Ys),v=i(r,f+Ks),l=De(c,!0),d=De(v,!0),p=De(o,!0),h=De(e,!0);return!!(kr(l)&&kr(d)&&kr(p)&&kr(h))&&(fi(r,n,2,ps,o,e),Ta(Be,o),Ta(Be,e),a(),!0)}function Dr(r,e,n,t){var a=qa(Be,e,0),o=qa(Be,e,1),u=a===n?o:a,s=ri(r,u+1),f=ri(r,n+1);if(3!==s)return!1;for(var c=i(r,u+Gs),v=i(r,u+Gs+2),l=i(r,u+Gs+4),d=0;d<f;++d){var p=i(r,n+Gs+2*d);if(p===c)return Or(r,u,v,l,c);if(p===v)return Or(r,u,c,l,v);if(p===l)return Or(r,u,c,v,l)}return!1}function Or(r,e,n,t,i){return ti(r,e+1,2),ti(r,e+Ys,n),ti(r,e+Ks,t),ni(r,e+Zs,js),Ta(Be,i),Ta(Be,n),Ta(Be,t),a(),!0}function Vr(r,e,n){if(mr(De(e,!0)))return!1;for(var t=0;t<n;++t){var o=qa(Be,e,t),u=Ka(r,o);if(u===gs){var s=i(r,o+Ks);s!==e&&(Ta(Be,s),ii(r,o,Qs))}else{if(u!==ms)return!1;for(var f=i(r,o+1),c=0;c<f;++c){var v=i(r,o+Gs+2*c);v!==e&&Ta(Be,v)}ii(r,o,Gs+2*f)}}var l=De(e,!0),d=qr(l,0);return l!==d&&Ce(e,d),Ta(Be,e),a(),!0}function Mr(r,e,n){if(mr(De(e,!0)))return Pe=!0,!1;var t=De(e,!0);if(!gr(t)){var i=qr(t,0);t!==i&&Ce(e,i),Ta(Be,e)}return a(),!0}function Tr(r,e,n,t){if(!kr(De(n,!0)))return!1;var o=i(r,e+Ks);if(!kr(De(o,!0)))return!1;var u=qa(Be,n,0),s=qa(Be,n,1),f=u===e?s:u,c=ri(r,f+1),v=Se(r,f,c,n);return ii(r,e,Qs),ci(r,f,c,xs,[o].concat(v)),Me.push(function(r,e,t,a){var i=t(n),u=t(o),s=i;if(fr(s)>ar(u)&&(s=qr(s,ar(u))),!gr(s)){for(var f=!0,c=0,l=v.length;c<l;++c){var d=t(v[c]);if(mr(d))break;if(xr(d)){f=!0;break}f=!1}f&&(s=Lr(s,0))}i!==s&&a(n,s)}),Ta(Be,n),a(),!0}function Br(r,e,n,t){if(!kr(De(n,!0)))return!1;var o=i(r,e+Ks);if(!kr(De(o,!0)))return!1;var u=qa(Be,n,0),s=qa(Be,n,1),f=u===e?s:u,c=ri(r,f+1),v=Se(r,f,c,n);return ii(r,e,Qs),ci(r,f,c,xs,[o].concat(v)),Me.push(function(r,e,t,a){var i=t(n),u=i;if(u=mr(t(o))?Lr(u,0):qr(u,0),!gr(u)){for(var s=!0,f=0,c=v.length;f<c;++f){var l=t(v[f]);if(mr(l))break;if(xr(l)){s=!0;break}s=!1}s&&(u=Lr(u,0))}i!==u&&a(n,u)}),Ta(Be,n),a(),!0}function Ir(e,n,t,a,o){for(var u=0;u<o;++u){var s=qa(Be,n,u);if(s!==e&&Ka(r,s)===ps&&i(r,s+Ys)===a&&i(r,s+Ks)===n)return Ur(n,t,a,e,s)}return!1}function Ur(e,n,t,i,o){var s=De(n,!0),f=De(t,!0),c=u(s);if(c<=ar(f))return Pe=!0,!1;if(c>fr(f))return Pe=!0,!1;var v=C(f,ke([0,0,c,fr(f)]));return f===v||(Ce(t,v),v)?(fi(r,o,2,_s,e,t),ii(r,i,Ws),Ta(Be,t),Ta(Be,e),a(),!0):Ue=!0}function Fr(e,n,t,a,o){for(var u=0;u<o;++u){var s=qa(Be,n,u);if(s!==e&&Ka(r,s)===ps&&i(r,s+Ys)===t&&i(r,s+Ks)===n)return jr(n,t,a,e,s)}return!1}function jr(e,n,t,i,o){var s=De(e,!0);if(!(s=Lr(s,0)))return Ue=!0,!1;var f=De(n,!0);return u(De(t,!0))<=ar(f)?(Pe=!0,!1):(Ce(e,s),fi(r,o,2,gs,n,t),ii(r,i,Ws),Ta(Be,n),Ta(Be,t),Ta(Be,e),a(),!0)}function Pr(r,e,n){for(var t=De(e,!0),o=[],u=0;u<n;++u){var s=qa(Be,e,u),f=i(r,s+Ks);if(fr(De(f))<ar(t))return Ce(f,0),!0;o.push(f),ii(r,s,Qs)}Me.push(function(r,n,t,a){for(var i=t(e),u=i,s=0,f=o.length;s<f;++s)u=qr(u,ar(t(o[s])));i!==u&&a(e,u)}),Ta(Be,e);for(var c=0,v=o.length;c<v;++c)Ta(Be,o[c]);return a(),!0}function $r(r,e,n){var t=De(e,!0);if(gr(t)||mr(t))return Pe=!0,!1;for(var o=0;o<n;++o)if(gr(i(r,qa(Be,e,o)+Ks)))return Pe=!0,!1;for(var u=[],s=0;s<n;++s){var f=qa(Be,e,s),c=i(r,f+Ks);u.push(c),ii(r,f,Qs)}var v=I(t,0);Ce(e,v),Ta(Be,e);for(var l=0,d=u.length;l<d;++l)Ta(Be,u[l]);return a(),!0}function zr(r,e,n,t){for(var a=ri(r,n+1),o=Gs+2*a+2,u=[],s=0;s<a;++s){var f=i(r,n+Gs+2*s);u.push(f)}for(var c=0,v=0;v<t;++v){var l=qa(Be,e,v);if(l!==n){if(Ka(r,l)!==ms)return!1;if(2!==ri(r,l+1))return!1;++c}}var d=Gs+2*(a+1),p=c-1,h=void 0;if(p&&!(h=mi(r,0,p,d)))return!1;var g=u.slice(0),m=0;p&&bi(r,h,p,d,function(a,i,o){var s=void 0;do{if(m>=t)return!0;s=qa(Be,e,m++)}while(s===n);return Hr(r,e,u.slice(0),g,s,a,o),!1});var b=qa(Be,e,m++);b===n&&(b=qa(Be,e,m++)),Hr(r,e,u.slice(0),g,b,n,o),Me.push(function(r,n,t,a){var i=t(e);g.some(function(r){if(!mr(t(r))&&0===n(r))return i=qr(i,0),!0}),a(e,i)}),Ta(Be,e);for(var k=0,y=g.length;k<y;++k)Ta(Be,g[k]);return!0}function Hr(r,e,n,t,a,o,u){var s=i(r,a+Ys),f=i(r,a+Ks),c=s===e?f:s;n.push(c),t.push(c),vi(r,o,u,ms,n),a!==o&&ii(r,a,Qs)}function Jr(e,n,t,o){if(!yr(De(n)))return!1;for(var s=[],f=[],c=[],v=[],l=[],d=[],p=[],h=[],g=[],m=[],b=[],k=[],y=[],x=0;x<t;++x){var _=qa(Be,n,x),w=Ka(r,_);if(2!==ri(r,_+1))return!1;var S=i(r,_+Ys),E=i(r,_+Ks),A=De(S,!0),N=De(E,!0);if(!yr(S===n?N:A))return!1;var D=S===n?E:S;if(w===gs){if(fr(A)>fr(N)||ar(N)<ar(A))return Pe=!0,!1;S===n?(s.push(_),f.push(D)):(c.push(_),v.push(D))}else if(w===ps)S===n?(m.push(_),b.push(D)):(k.push(_),y.push(D));else if(w===ds){if(e!==_)return!1;g.push(D),!0}else w===xs?(l.push(_),d.push(D)):(p.push(_),h.push(D))}for(var C=0,O=s.length;C<O;++C){var V=s[C],M=i(r,V+Ys);M===n&&(M=i(r,V+Ks)),Ta(Be,M),fi(r,V,2,xs,M,o)}for(var T=0,R=c.length;T<R;++T){var q=c[T],L=i(r,q+Ys);L===n&&(L=i(r,q+Ks)),Ta(Be,L),fi(r,q,2,ms,L,o)}for(var B=0,U=l.length;B<U;++B){var F=l[B],j=i(r,F+Ys);j===n&&(j=i(r,F+Ks)),Ta(Be,j),fi(r,F,2,gs,o,j)}for(var P=0,$=p.length;P<$;++P){var z=p[P],H=i(r,z+Ys);H===n&&(H=i(r,z+Ks)),Ta(Be,H),fi(r,z,2,gs,H,o)}for(var J=0,W=m.length;J<W;++J){var G=m[J],Q=i(r,G+Ys);Q===n&&(Q=i(r,G+Ks)),Ta(Be,Q),fi(r,G,2,xs,Q,o)}for(var X=0,Y=k.length;X<Y;++X){var K=k[X],Z=i(r,K+Ys);Z===n&&(Z=i(r,K+Ks)),Ta(Be,Z),fi(r,K,2,ms,Z,o)}return ii(r,e,Qs),Te.push(n),Me.push(function(r,e,t,a){for(var i=t(n),s=t(o),c=i,l=ar(i),p=fr(i),g=0;g<f.length;++g){var m=f[g],k=t(m);if(p>ar(k)){var x=fr(k);x>=p?a(m,k=Rr(k,p)):(a(m,k=I(k,x)),i=qr(i,x))}}for(var _=0;_<v.length;++_){var w=v[_],S=t(w),E=fr(S);if(l<E){var A=ar(S);A<=l?a(w,S=qr(S,l)):(a(w,S=I(S,A)),i=Rr(i,E))}}for(var N=0;N<d.length;++N){var D=d[N],C=t(D);gr(C)?i=Lr(i,0):br(C)&&a(D,C=Lr(C,0))}for(var O=0;O<h.length;++O){var V=h[O],M=t(V);mr(M)?i=qr(i,0):mr(M)&&a(V,M=qr(M,0))}for(var T=0;T<b.length;++T){var R=b[T],q=t(R);mr(q)||gr(i)||(gr(q)?i=qr(i,0):mr(q)?i=Lr(i,0):a(R,Lr(q,0)))}for(var L=0;L<y.length;++L){var B=t(y[L]);mr(B)?i=qr(i,0):xr(B)&&(B=Lr(B,0))}hr(i)?(s=Lr(s,u(i)),a(o,s)):i=Lr(i,e(o)),i!==c&&a(n,i)}),Ta(Be,n),Ta(Be,o),a(),!0}function Wr(e,n,t,o){if(!xr(De(n)))return!1;for(var u=[],s=[],c=[],v=[],l=0;l<t;++l){var d=qa(Be,n,l),p=Ka(r,d);if(2!==ri(r,d+1))return!1;var h=i(r,d+Ys),g=i(r,d+Ks),m=h===n?g:h;if(0===Ma(Be,m))return!1;if(!yr(De(m,!0))&&f(Ra(Be,m),qo))return!1;if(p===ps)h===n?c.indexOf(d)<0&&c.push(d):v.indexOf(d)<0&&v.push(d);else if(p===ws){if(e!==d)return!1;!0}else p===xs?(ri(r,d+1),u.indexOf(d)<0&&u.push(d)):s.indexOf(d)<0&&s.push(d)}for(var b=0,k=u.length;b<k;++b){var y=u[b],x=i(r,y+Ys);x===n&&(x=i(r,y+Ks)),Ta(Be,x),fi(r,y,2,ps,o,x)}for(var _=0,w=s.length;_<w;++_){var S=s[_],E=i(r,S+Ys);E===n&&(E=i(r,S+Ks)),Ta(Be,E),fi(r,S,2,ps,E,o)}for(var A=0,N=c.length;A<N;++A){var D=c[A],C=i(r,D+Ys);C===n&&(C=i(r,D+Ks)),Ta(Be,C),fi(r,D,2,xs,C,o)}for(var O=0,V=v.length;O<V;++O){var M=v[O],T=i(r,M+Ys);T===n&&(T=i(r,M+Ks)),Ta(Be,T),fi(r,M,2,ms,T,o)}return ii(r,e,Qs),Te.push(n),Me.push(function(r,e,t,a){var i=t(n);i=0===e(o)?Lr(i,0):qr(i,0),a(n,i)}),Ta(Be,n),Ta(Be,o),a(),!0}function Gr(r,e,n,t,o){for(var u=0,s=0;s<t;++s){var f=qa(Be,n,s);Ka(r,f)===ws&&(u=f)}if(2!==ri(r,u+1))return!1;var c=i(r,u+Ys);c===n&&(c=i(r,u+Ks));var v=De(o,!0),l=De(c,!0),d=De(n,!0);return!(!yr(v)||!yr(l)||C(d,v)!==v||C(d,l)!==l)&&(ii(r,e,Qs),we(c,o),a(),!0)}function Qr(e,n,t){var o=De(e);if(o===De(n)&&2===K(o))for(var u=0;u<t;++u){var s=qa(Be,e,u);if(Ka(r,s)===ds){if(2!==ri(r,s+1))continue;var f=i(r,s+Ys),c=i(r,s+Ks),v=void 0;if(f===e){if(c===n)continue;v=c}else{if(f===n)continue;v=f}if(o===De(v))return Oe(v,n,"double bin diff"),ii(r,s,Qs),Ta(Be,e),Ta(Be,n),Ta(Be,v),a(),!0}}return!1}function Xr(e,n,t,u,s,c){var v=2===s;if(!c&&!v)return!1;for(var l=0;l<t;++l){var d=qa(Be,e,l);if(Ka(r,d)===ws){var p=i(r,d+Ys),h=i(r,d+Ks),g=void 0;if(p===e){if(h===n)continue;g=h}else if(h===e){if(p===n)continue;g=p}else We("X should be left or right of its xors");var m=!1,b=De(g,!0);if(v&&b===u?(Oe(g,n),m=!0):v&&2===K(b)?(we(n,g),m=!0):c&&(f(o(Be,g,!0),qo)||(we(n,g),m=!0)),m)return ii(r,d,Qs),Ta(Be,e),Ta(Be,n),Ta(Be,g),a(),!0}}return!1}function Zr(e,n,t,a,i){for(var o=0;o<a;++o){var u=qa(Be,e,o);if(u!==t&&Ka(r,u)===Ss)return ee(e,n,t,u)}We("bounty should have asserted that an isall existed")}function ee(e,n,t,i){var o=ri(r,i+1);return ni(r,i,Ds),ti(r,i+Gs+2*o,n),ii(r,t,Qs),Me.push(function(r,t,a,i){var o=a(e),u=a(n);xr(u)&&(u=Yr(t(n))),o=gr(u)?Lr(o,0):qr(o,0),i(e,o)}),Ta(Be,e),Ta(Be,n),Ee(r,i,o),a(),!0}function ne(e,n,t,a,i){for(var o=0;o<a;++o){var u=qa(Be,e,o);if(u!==t&&Ka(r,u)===Vs)return te(e,n,t,u)}We("bounty should have asserted that an issome existed")}function te(e,n,t,i){var o=ri(r,i+1),u=i+Gs+2*o,s=Se(r,i,o);return Ta(Be,n),Ta(Be,e),ni(r,i,Cs),ti(r,u,n),ii(r,t,Qs),Me.push(function(r,t,a,i){var o=a(n),u=a(e);if(gr(o))u=Lr(u,0),i(e,u);else if(gr(u))o=qr(o,0),i(n,o);else if(mr(o))u=qr(u,0),i(e,u);else if(mr(u))o=qr(o,0),i(n,o);else{for(var f=!0,c=!1,v=-1,l=0;l<s.lenght;++l){var d=a(s[l]);if(mr(d)){c=!0;break}gr(d)||(f=!1,v=l)}if(c)u=Lr(u,0);else if(f)u=qr(u,0);else{u=Lr(u,0);var p=s[v],h=a(p);i(p,h=Lr(h,0))}i(e,u)}}),a(),!0}function ae(e,n,t,o){var u=qa(Be,e,0),s=qa(Be,e,1),f=u===t?s:u;if(2!==ri(r,f+1))return!1;if(!xr(De(e,!0)))return Pe=!0,!1;var c=i(r,f+Ys);return c===e&&(c=i(r,f+Ks)),Me.push(function(r,t,a,i){var o=a(n),u=a(c),s=a(e);s=gr(o)?Lr(s,0):mr(o)?qr(s,0):gr(u)?Lr(s,0):0===t(n)?Lr(s,0):qr(s,0),i(e,s)}),ii(r,f,Qs),fi(r,t,2,ps,n,c),Ta(Be,n),Ta(Be,c),Ta(Be,e),a(),!0}function ie(e,n){if(n>=ru)return!1;var t=De(e,!0);if(gr(t))return Pe=!0,!1;if(mr(t))return Pe=!0,!1;for(var o=[],u=[],s=0;s<n;++s){for(var f=qa(Be,e,s),c=ri(r,f+1),v=0;v<c;++v){var l=i(r,f+Gs+2*v);l!==e&&u.push(l)}o.indexOf(f)<0&&o.push(f)}gr(t)||Ce(e,Yr(0));for(var d=0,p=o.length;d<p;++d){var h=o[d],g=ri(r,h+1);ii(r,h,Gs+2*g)}for(var m=0,b=u.length;m<b;++m){var k=u[m];Ta(Be,k)}return Ta(Be,e),a(),!0}function oe(e,n){if(n>=ru)return!1;var t=De(e,!0);if(mr(t))return Pe=!0,!1;if(gr(t))return Pe=!0,!1;for(var o=[],u=[],s=0;s<n;++s){for(var f=qa(Be,e,s),c=ri(r,f+1),v=0;v<c;++v){var l=i(r,f+Gs+2*v);l!==e&&u.push(l)}o.indexOf(f)<0&&o.push(f)}br(t)&&Ce(e,t=Lr(t,0));for(var d=0,p=o.length;d<p;++d){var h=o[d],g=ri(r,h+1);ii(r,h,Gs+2*g)}for(var m=0,b=u.length;m<b;++m){var k=u[m];Ta(Be,k)}return Ta(Be,e),a(),!0}function ue(e,n){if(!kr(De(e)))return!1;if(n>=ru)return!1;for(var t=void 0,o=void 0,u=[],s=[],f=void 0,c=void 0,v=0;v<n;++v){var l=qa(Be,e,v);if(!l)break;var d=Ka(r,l);if(2!==ri(r,l+1))return!1;var p=i(r,l+Ys),h=i(r,l+Ks),g=p===e?h:p;if(d===ms)u.push(l),s.push(g);else if(d===xs){if(o)return!1;o=l,c=g}else{if(t)return!1;t=l,f=g}}fi(r,t,2,xs,f,c),ii(r,o,Qs);for(var m=0,b=s.length;m<b;++m){var k=s[m];fi(r,u[m],2,gs,k,c),Ta(Be,k)}return Me.push(function(r,n,t,a){var i=t(f),o=t(c),u=t(e),v=!1,l=!1;gr(o)&&(v=!0),s.forEach(function(r){mr(t(r))&&(l=!0)}),v?u=qr(u=Lr(u,0),ar(i)):l?u=qr(u=qr(u,0),ar(i)):xr(u=qr(u,ar(i)))&&(u=Lr(u,0)),a(e,u),mr(u)&&s.forEach(function(r){var e=t(r);e=qr(e,0),a(r,e)}),i=Rr(i,fr(u)),a(f,i),gr(u)&&(o=Lr(o,0),a(c,o))}),Ta(Be,f),Ta(Be,c),Ta(Be,e),a(),!0}function se(e,n){if(n>=ru)return!1;for(var t=void 0,o=void 0,u=[],s=[],f=void 0,c=void 0,v=0;v<n;++v){var l=qa(Be,e,v);if(!l)break;var d=Ka(r,l);if(2!==ri(r,l+1))return!1;var p=i(r,l+Ys),h=i(r,l+Ks),g=p===e?h:p;if(d===ms)u.push(l),s.push(g);else if(d===xs){if(o)return!1;o=l,c=g}else{if(t)return!1;t=l,f=g}}fi(r,t,2,xs,f,c),ii(r,o,Qs);for(var m=0,b=s.length;m<b;++m){var k=s[m];fi(r,u[m],2,ps,k,c),Ta(Be,k)}return Me.push(function(r,n,t,a){var i=t(e),o=i;if(!gr(o))for(var u=0,v=s.length;u<v;++u){var l=s[u];if(mr(t(l))||0!==n(l)){o=qr(o,0);break}}var d=t(c);xr(d)&&(n(d),d=t(c)),gr(d)&&(o=Lr(o,0));var p=t(f);xr(p)&&(n(p),p=t(f)),gr(p)&&(o=qr(o,0)),i!==o&&a(e,o)}),Ta(Be,f),Ta(Be,c),Ta(Be,e),a(),!0}function fe(e,n){if(n>4||n>=ru)return!1;for(var t=void 0,o=void 0,u=void 0,s=void 0,f=void 0,c=void 0,v=void 0,l=void 0,d=0;d<n;++d){var p=qa(Be,e,d),h=Ka(r,p),g=i(r,p+Ys),m=i(r,p+Ks),b=g===e?m:g;h===ms?(v=b,s=p):h===xs?(c=b,u=p):g===e?(t=p,l=b):(o=p,f=b)}return fi(r,t,2,gs,f,l),fi(r,o,2,gs,v,l),fi(r,u,2,xs,c,l),fi(r,s,2,ms,f,v),Me.push(function(r,n,t,a){var i=t(e);1===n(f)?(i=Lr(i,0),a(e,i)):0===n(c)?(i=Lr(i,0),a(e,i)):n(v)>0?(i=qr(i,0),a(e,i)):0===n(l)&&(i=qr(i,0),a(e,i))}),Ta(Be,f),Ta(Be,c),Ta(Be,v),Ta(Be,l),Ta(Be,e),a(),!0}function ce(e,n){if(4!==n||n>=ru)return!1;for(var t=void 0,o=void 0,u=void 0,s=void 0,f=void 0,c=void 0,v=void 0,l=void 0,d=0;d<n;++d){var p=qa(Be,e,d),h=Ka(r,p),g=i(r,p+Ys),m=i(r,p+Ks);if(h===ms)v=g===e?m:g,s=p;else if(h===xs)c=g===e?m:g,u=p;else{var b=g===e?m:g;g===e?(t=p,l=b):(o=p,f=b)}}return!!(kr(De(f,!0))&&kr(De(c,!0))&&kr(De(v,!0))&&kr(De(l,!0)))&&(fi(r,t,2,ps,f,l),fi(r,o,2,ps,v,l),fi(r,u,2,xs,c,l),fi(r,s,2,ms,f,v),Te.push(e),Me.push(function(r,n,t,a){var i=t(e);1===n(f)?(i=Lr(i,0),a(e,i)):0===n(c)?(i=Lr(i,0),a(e,i)):n(v)>0?(i=qr(i,0),a(e,i)):0===n(l)&&(i=qr(i,0),a(e,i))}),Ta(Be,f),Ta(Be,c),Ta(Be,v),Ta(Be,l),Ta(Be,e),a(),!0)}function ve(r,n,t,a,o,s,f,c,v,l,d){var p=qa(Be,t,0),h=qa(Be,t,1),g=p===n?h:p;if(2!==ri(r,g+1))return!1;var m=i(r,g+Ys),b=i(r,g+Ks),k=i(r,g+rf),y=m;y===t&&(y=b);var x=De(t,!0),_=De(y,!0),w=u(_);return w>=0&&!e(x,w)?(Pe=!0,!1):C(x,s)===s&&(d&&w===c?(ni(r,n,Ss),pe(n,g,o,t,k,y,v,l)):w>=0?le(r,n,o,t,g,k,y,w,c,v,l):de(r,n,o,t,g,k,y,_,v,l))}function le(r,e,n,t,a,i,o,u,s,f,c){if(u===f)ni(r,e,Cs);else{if(u!==s)return!1;ni(r,e,Ss)}return pe(e,a,n,t,i,o,f,c)}function de(r,e,n,t,a,i,o,u,s,f){if(u===Kr(s+1,s+n-(s?1:0)))ni(r,e,Vs);else{if(u!==Kr(s,s-(s?1:0)+(n-1)))return!1;ni(r,e,Ds)}return pe(e,a,n,t,i,o,s,f)}function pe(e,n,t,i,o,s,f,c){var v=xe(f,c,t,e);ti(r,e+Gs+2*v,o);var l=Se(r,e,v);return Me.push(function(r,e,n,t){var a=n(o),f=n(i),c=n(s);xr(a)||(C(f,c)?(e(s),f===(c=n(s))?(a=Lr(a,0),t(o,a)):(a=qr(a,0),t(o,a))):(a=qr(a,0),t(o,a))),c=gr(a)?Lr(c,u(f)):C(c,f),t(s,c)}),_e(i,l,f),ii(r,n,Xs),Ta(Be,o),Ta(Be,i),Ta(Be,s),a(),!0}function he(r,n,t,o,s,f,c,v,l){var d=qa(Be,t,0),p=qa(Be,t,1),h=d===n?p:d,g=i(r,h+1),m=i(r,h+3),b=i(r,h+5),k=g;k===t&&(k=m);var y=u(De(k,!0));if(y<0)return!1;var x=De(t,!0);if(!e(x,y))return Pe=!0,!1;var _=Kr(f,c);if(C(x,_)!==_)return!1;var w=0;if(g===t)if(y===v)w=Cs;else{if(y!==v-(v?1:0)+(s-1))return!1;w=Ds}else if(y===v+1)w=Vs;else{if(y!==v-(v?1:0)+s)return!1;w=Ss}ni(r,n,w);var S=xe(v,l,s,n),E=Se(r,n,S);return ti(r,n+Gs+2*S,b),Me.push(function(r,e,n,a){var i=n(b),o=n(t);xr(i)||(k===g?y<=ar(o)?(i=Lr(i,0),a(b,i)):(i=qr(i,0),a(b,i)):fr(o)<=y?(i=Lr(i,0),a(b,i)):(i=qr(i,0),a(b,i)))}),_e(t,E,v),ii(r,h,Ws),Ta(Be,t),a(),!0}function ge(r,e,n,t,i,o){var u=i,s=n;o||(u=n,s=i),we(s,u),ii(r,e,Qs),Ta(Be,n),Ta(Be,i),a()}function me(r,e,n,t,i,o){var u=De(n,!0);if(!yr(u))for(var s=0;s<t;++s){var f=qa(Be,n,s);if(f!==e&&ye(Ka(r,f),!0,r,f,n)===au)return}if(i!==C(u,i))return!1;var c=Se(r,e,o),v=u;return Me.push(function(r,e,t,a){for(var i=0,u=0;u<o;++u)i+=e(c[u]);var s=I(v,i);v!==s&&a(n,s,!1,!0)}),ni(r,e,Vs),Ta(Be,n),a(),!0}function be(r,e,n,t,o,s){var f=qa(Be,n,0),c=qa(Be,n,1);if(f===e?f=qa(Be,n,2):c===e&&(c=qa(Be,n,2)),Ka(r,f)!==Os||Ka(r,c)!==Os)return!1;var v=ri(r,f+1),l=ri(r,c+1);if(2!==v||2!==l)return!1;var d=i(r,e+Ys),p=i(r,e+Ks),h=De(d,!0),g=De(p,!0);if(!kr(h)||!kr(g))return!1;var m=i(r,f+Ys),b=i(r,f+Ks),k=i(r,f+rf),y=i(r,c+Ys),x=i(r,c+Ks),_=i(r,c+rf),w=m;w===n&&(w=b);var S=y;S===n&&(S=x);var E=u(De(w,!0)),A=u(De(S,!0));return!(1!==E&&2!==E||1!==A&&2!==A||E===A)&&(Me.push(function(r,e,t,a){var i=t(n),o=I(i,e(d)+e(p));i!==o&&a(n,o)}),ni(r,e,Ss),ti(r,e+Zs,2===E?k:_),ni(r,f,Es),ti(r,f+Ys,d),ti(r,f+Ks,p),ti(r,f+rf,1===E?k:_),ii(r,c,Xs),Ta(Be,d),Ta(Be,p),Ta(Be,n),Ta(Be,k),Ta(Be,w),Ta(Be,_),Ta(Be,S),a(),!0)}function ye(r,e,n,t,a){switch(r){case hs:case gs:case Rs:case qs:case Ms:case Ts:case ds:case ys:return au;case ws:case _s:case ps:case bs:case ls:case ms:case xs:case ks:case Ls:return iu;case Bs:return au;case Es:case Os:if(!e)return ou;for(var o=ri(n,t+1),u=0;u<o;++u)if(i(n,t+Gs+2*u)===a)return au;return iu;case As:case Ns:return e?i(n,t+1)===a||i(n,t+3)===a?au:iu:ou;case Ss:case Ds:case Vs:case Cs:return iu;case vs:case Is:case Us:case Fs:case js:case Ps:case $s:case zs:return We("should not be used for these ops");default:We("(ml_isBooly) unknown op: "+r)}}function xe(e,n,t,a){if(n>=0){if(n!==t-1){var o=i(r,a+Gs+2*(t-1));ti(r,a+Gs+2*n,o)}ti(r,a+1,--t),ni(r,a+Gs+2*(t+1),js)}return t}function _e(r,e,n){Me.push(function(t,a,i,o){for(var u=i(r),s=0,f=0,c=e.length;f<c;++f)a(e[f])&&++s;var v=I(u,s+n);u!==v&&o(r,v)})}function we(r,e){var n=De(e,!0);Me.push(function(t,a,i,o){var u=void 0;u=0===a(r)?qr(n,0):Lr(n,0),o(e,u,!0,!0)}),Oe(e,r,"cutAddPseudoBoolyAlias")}function Se(r,e,n){for(var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,a=[],o=0;o<n;++o){var u=i(r,e+Gs+2*o);u!==t&&a.push(u),Ta(Be,u)}return a}function Ee(r,e,n){for(var t=0;t<n;++t){var a=i(r,e+Gs+2*t);Ta(Be,a)}}function Ae(r,e,n){switch(Ka(r,e+n)){case Fs:case js:case Ps:case $s:case Is:case Us:oi(r,e,n),Le=e;break;default:Le=e+n}}var Ne=Je(),De=n.getDomain,Ce=n.setDomain,Oe=n.addAlias,Ve=n.getAlias,Me=n.solveStack,Te=n.leafs,qe=n.isConstant,Le=0,Be=void 0,Ie=void 0,Ue=!1,Fe=0,je=0,Pe=!1;do{Ne.time("-> cut_loop "+je),Be=Va(r,n,Be),Ie=Me.length,Fe=0,function(){for(Le=0;Le<r.length&&!Ue&&!Pe;){var e=Le;switch(r[Le]){case ls:return xi(r,Le,"all() should be solved and eliminated");case ds:v(r,Le);break;case qs:Le+=Ws;break;case ps:l(r,Le);break;case Ss:d(r,Le);break;case Es:p(r,Le);break;case As:g(r,Le);break;case Ns:b(r,Le);break;case Ds:y(r,Le);break;case Os:x(r,Le);break;case Vs:w(r,Le);break;case Cs:var n=ri(r,Le+1);Le+=Gs+2*n+2;break;case hs:S(r,Le);break;case gs:E(r,Le);break;case Rs:Le+=Ws;break;case ms:A(r,Le);break;case bs:Le+=Qs;break;case ks:return xi(r,Le,"nors should be solved and eliminated");case Ts:var t=ri(r,Le+1);Le+=Gs+2*t+2;break;case ys:return xi(r,Le,"eqs should be aliased and eliminated");case xs:N(r,Le);break;case Ms:D(r,Le);break;case ws:V(r,Le);break;case _s:O(r,Le);break;case vs:if(0!==Le)return xi(r,Le," ! compiler problem @",e);++Le;break;case zs:return;case Bs:case Ls:Le+=Hs;break;case Is:Ae(r,Le,Hs+ri(r,Le+1));break;case Us:Ae(r,Le,Js+ei(r,Le+1));break;case Fs:Ae(r,Le,1);break;case js:Ae(r,Le,2);break;case Ps:Ae(r,Le,3);break;case $s:Ae(r,Le,4);break;default:Je().error("(cut) unknown op",Le," at",Le),xi(r,Le,"(cut) unknown op",Le)}}Ue||Pe||We("ML OOB")}(),Ne.timeEnd("-> cut_loop "+je),Ne.log("   - end cutter outer loop",je,", removed:",Me.length-Ie," vars, total changes:",Fe,", emptyDomain =",Ue,"once=",t),++je}while(!Ue&&Fe&&!t&&!Pe);return Ue?-1:je+(Pe?1:0)}function ja(r,n){function t(e){var n=k(ri(r,_+Ys)),t=k(ri(r,_+Ks)),i=e+":"+n+","+t,o=e+":"+U(m(n,!0))+","+U(m(t,!0));("<"!==e&&"<="!==e||!a(e,n,t,o))&&(void 0===w[i]?(w[i]=1,S[i]=o,_+=Qs):ii(r,_,Qs))}function a(r,e,n,t){return!("<"!==r||!i("<?","<",e,n,t))||(!("<"!==r||!i("<=?","<",e,n,t))||(!("<="!==r||!i("<=?","<=",e,n,t))||(!("<"!==r||!o("<?","<",e,n,t))||(!("<="!==r||!o("<?","<=",e,n,t))||!("<"!==r||!o("<=?","<",e,n,t))))))}function i(e,n,t,a,i){var o=w[e+":R="+t+","+a];if(o){var u=k(ri(r,o+5)),s=m(u,!0);return!!xr(s)&&(ii(r,o,Ws),b(u,Lr(s,0)),!0)}return!1}function o(e,n,t,a,i){var o=w[e+":R="+a+","+t];if(o){var u=k(ri(r,o+5)),s=m(u,!0);return!!xr(s)&&(ii(r,o,Ws),b(u,qr(s,0)),!0)}return!1}function s(e){var n=k(ri(r,_+1)),t=k(ri(r,_+3)),a=k(ri(r,_+5)),i=e+":"+n+","+t,o=e+":"+U(m(a,!0))+"="+U(m(n,!0))+","+U(m(t,!0)),u=w[i];if(void 0===u)w[i]=a,S[i]=o,_+=Ws;else if(u=k(u),ii(r,_,Ws),a!==u){var s=C(m(a,!0),m(u,!0));if(!s)return E=!0;b(u,s),x(a,u)}}function f(e){var n=_,t=k(ri(r,_+1)),a=k(ri(r,_+3)),i=k(ri(r,_+5)),o=e+":"+i+"="+t+","+a,u=e+":"+U(m(i,!0))+"="+U(m(t,!0))+","+U(m(a,!0));if(void 0===w[o]){var s=m(i,!0),f=e.slice(0,-1)+":"+t+","+a;if(w[f]&&!gr(s))return ii(r,_,Ws),void b(i,Lr(s,0));if(!c(e,t,a,i,s,u)){var v=w[("<?"===e?"<=?":"<?")+":R="+a+","+t];if(v){var l=k(ri(r,v+5));hi(r,n,ws,i,l)}else{if(yr(s)){var d=e+":["+s+"]="+t+","+a,p=w[d];if(void 0!==p)return p=k(p),ii(r,_,Ws),void(i===p||x(i,p));w[d]=i,S[d]=u}w[o]=1,S[o]=u;var h=e+":R="+t+","+a;w[h]=n,S[h]=u,_+=Ws}}}else ii(r,_,Ws)}function c(r,e,n,t,a,i){r.slice(0,-1);if(xr(a)){if("<?"===r&&v("<?","<",e,n,t,a,i))return!0;if("<=?"===r&&v("<=?","<",e,n,t,a,i))return!0;if("<=?"===r&&v("<=?","<=",e,n,t,a,i))return!0;if("<?"===r&&l("<?","<",e,n,t,a,i))return!0;if("<?"===r&&l("<?","<=",e,n,t,a,i))return!0;if("<=?"===r&&l("<=?","<",e,n,t,a,i))return!0}return!1}function v(e,n,t,a,i,o,u){return!!w[n+":"+t+","+a]&&(ii(r,_,Ws),b(i,Lr(o,0)),!0)}function l(e,n,t,a,i,o,u){return!!w[n+":"+a+","+t]&&(ii(r,_,Ws),b(i,qr(o,0)),!0)}function d(e){var n=ri(r,_+1),t=Gs+2*n+2;_i(r,_+Gs,n);for(var a="",i="",o=0;o<n;++o){var u=k(ri(r,_+Gs+2*o));a+=u+" ",i+=U(m(u,!0))}var s=k(ri(r,_+Gs+2*n)),f=e+":"+s+"="+a,c=e+":"+U(m(s,!0))+"="+i;if(void 0===w[f]){w[f]=1,S[f]=c;var v=m(s,!0);if(yr(v)){var l=e+":["+v+"]="+a,d=w[l];if(void 0!==d)return d=k(d),ii(r,_,t),void(s===d||x(s,d));w[l]=s,S[l]=c}_+=t}else ii(r,_,t)}function p(e){var n=ri(r,_+1),t=Gs+2*n+2;_i(r,_+Gs,n);for(var a="",i="",o=0;o<n;++o){var u=k(ri(r,_+Gs+2*o));a+=u+" ",i+=U(m(u,!0))}var s=k(ri(r,_+Gs+2*n)),f=e+":="+a,c=e+":"+i,v=w[f];if(void 0===v)w[f]=s,S[f]=c,_+=t;else if(v=k(v),ii(r,_,t),s!==v){var l=C(m(v,!0),m(s,!0));b(v,l),x(s,v)}}function h(e){var n=ri(r,_+1),t=Gs+2*n;_i(r,_+Gs,n);for(var a="",i="",o=0;o<n;++o){var u=k(ri(r,_+Gs+2*o));a+=u+" ",i+=U(m(u,!0))}var s=e+":="+a,f=e+":"+i;void 0===w[s]?(w[s]=1,S[s]=f,_+=t):ii(r,_,t)}function g(n){var t=ri(r,_+1);if(2!==t)return!1;var a=k(ri(r,_+Ys)),i=k(ri(r,_+Ks)),o=k(ri(r,_+rf));if(i<a){var s=i;i=a,a=s}var f=m(a,!0),c=m(i,!0);if(2!==K(f))return!1;var v=u(c);if(v<0||!e(f,v))return!1;var l=u(Lr(f,v)),d=y(void 0,l,!1,!1,!0),p=("issame"===n?"isdiff":"issame")+":"+a+","+d,h=n+":"+U(m(o,!0))+"="+U(m(a,!0))+","+U(m(i,!0)),g=w[p];if(void 0===g){var b=n+":"+a+","+i;return w[b]=o,S[b]=h,!1}var E=m(o,!0);return 2!==K(E)||mr(E)||E!==m(g,!0)?di(r,_,t,_s,o,g):(o===g||x(o,g),ii(r,_,Xs)),!0}++uu;var m=n.getDomain,b=n.setDomain,k=n.getAlias,y=n.addVar,x=n.addAlias,_=0,w={},S={},E=!1;return function(){for(;_<r.length&&!E;)switch(++su,r[_]){case ps:t("->");break;case bs:t("!->");break;case As:f("<?");break;case Ns:f("<=?");break;case Ss:d("isall");break;case Es:g("isdiff")||d("isdiff");break;case Ds:d("isnall");break;case Cs:d("isnone");break;case Os:g("issame")||d("issame");break;case Vs:d("issome");break;case ls:h("all");break;case ds:h("diff");break;case hs:t("<");break;case gs:t("<=");break;case ms:h("nall");break;case ks:h("none");break;case ys:h("same");break;case xs:h("some");break;case _s:h("xnor");break;case ws:h("^");break;case Rs:s("-");break;case qs:s("/");break;case Ms:p("sum");break;case Ts:p("product");break;case vs:if(0!==_)return xi(r,_,"deduper problem found START");++_;break;case zs:return w;case Bs:case Ls:_+=Hs;break;case Is:_+=Hs+ri(r,_+1);break;case Us:_+=Js+ei(r,_+1);break;case Fs:++_;break;case js:_+=2;break;case Ps:_+=3;break;case $s:_+=4;break;default:xi(r,_,"(dd) unknown op")}E||xi(r,_,"(dd) ML OOB")}(),Je().log(" - dedupe removed",0,"constraints and aliased",0,"result vars, emptyDomain=",E,", processed",su,"ops"),E?-1:0}function Pa(r,e,n){function t(r){++lr,a(r)}function a(r){kr>=mr&&u(),br[kr++]=r}function i(r){r>65535&&sr("Need 32bit num support but missing it"),kr>=mr-1&&u(),br[kr++]=r>>8&255,br[kr++]=255&r}function o(r){r>4294967295&&sr("This requires 64bit support"),kr>=mr-3&&u(),br[kr++]=r>>24&255,br[kr++]=r>>16&255,br[kr++]=r>>8&255,br[kr++]=255&r}function u(r){var e=mr;mr+=r||Math.max(Math.ceil(.1*mr),10),"undefined"==typeof Buffer?br=ArrayBuffer.transfer?new Uint8Array(ArrayBuffer.transfer(br.buffer,mr)):new Uint8Array($a(br.buffer,mr)):(br=new Uint8Array(Buffer.concat([br],mr))).fill(0,e)}function s(){return hr[pr]}function f(r){return hr[pr+r]}function c(r,e){return String.fromCharCode.apply(String,_toConsumableArray(hr.slice(r,e)))}function v(){++pr}function l(r,e){e||(e=""),s()!==r&&sr("Expected "+e+" `"+r+"`, found `"+s()+"`"),v()}function d(){for(;pr<gr&&h(s());)v()}function p(){for(;!_();){var r=s();if(y(r))v();else{if(!k(r))break;T()}}}function h(r){return r===Nu||r===Mu}function g(r){return r===pu||r===hu}function m(r){return g(r)||k(r)||_()}function b(r){return r===pu||r===hu||r===yu}function k(r){return r===yu}function y(r){return h(r)||g(r)}function x(){if(d(),pr<gr){var r=s();r===yu?T():g(r)?v():sr("Expected EOL but got `"+s()+"`")}}function _(){return pr>=gr}function w(){v(),d();var r=E();if(d(),s()===du){r=[r];do{v(),d(),r.push(E()),d()}while(!_()&&s()===du)}s()===bu&&(v(),d());var e=C();d();var n=O();x(),"string"==typeof r?S(r,e,n):r.forEach(function(r){return S(r,e,n)})}function S(r,e,n){return fr(r,e,n,!1,!0,sr)}function E(){return s()===Ou?A():N()}function A(){l(Ou);for(var r="";!_();){var e=s();if(e===Ou)break;e!==yu&&b(e)&&sr("Quoted identifier wasnt closed at eol"),r+=String.fromCharCode(e),v()}return _()&&sr("Quoted identifier wasnt closed at eof"),r||sr("Expected to parse identifier, found none"),v(),r}function N(){var r=s(),e="";for(r>=Ru&&r<=$u&&sr("Unquoted ident cant start with number");!_()&&(r=s(),D(r));)e+=String.fromCharCode(r),v();return e||sr("Expected to parse identifier, found none"),e}function D(r){switch(r){case _u:case Cu:case du:case xu:case Du:case Ou:case yu:return!1}return!y(r)}function C(){var r=void 0,e=s();switch(e){case xu:if(l(xu,"domain start"),d(),r=[],s()===xu)do{v(),d();var n=J();d(),s()===du&&(v(),d());var t=J();d(),l(Du,"range-end"),d(),r.push(n,t),s()===du&&(v(),d())}while(s()===xu);else for(;s()!==Du;){d();var a=J();d(),s()===du&&(v(),d());var i=J();d(),r.push(a,i),s()===du&&(v(),d())}return l(Du,"domain-end"),0===r.length&&sr("Empty domain [] in dsl, this problem will always reject"),r;case Vu:return v(),[Zi,ro];case Ru:case qu:case Lu:case Bu:case Iu:case Uu:case Fu:case ju:case Pu:case $u:var o=J();return d(),[o,o]}sr("Expecting valid domain start, found `"+e+"`")}function O(){if(s()===cu){v();for(var r={},e="";;){var n=s();if(!(n>=zu&&n<=os||n>=us&&n<=ss))break;e+=String.fromCharCode(n),v()}switch(e){case"list":V(r);break;case"markov":M(r);break;case"max":case"mid":case"min":case"naive":r.valtype=e;break;case"minMaxCycle":case"splitMax":case"splitMin":sr("TODO: implement this modifier ["+e+"]");break;default:sr("implement me (var mod) [`"+e+"`]")}return r.valtype=e,r}}function V(r){d(),f(0)===es&&f(1)===ns&&f(2)===Xu&&f(3)===rs&&f(4)===_u||sr("Expecting the priorities to follow the `@list`"),pr+=5,r.valtype="list",r.list=Q(),l(Cu,"list end")}function M(r){r.valtype="markov";for(var e=!0;e;)switch(e=!1,d(),s()){case Ku:if(f(1)===zu&&f(2)===as&&f(3)===ns&&f(4)===Xu&&f(5)===is&&f(6)===_u){for(var n=pr+=7;s()!==Cu&&!_();)v();_()&&sr("The matrix must be closed by a `)` but did not find any");var t="return "+c(n,pr),a=Function(t);r.matrix=a(),l(Cu,"end of matrix"),e=!0}break;case Yu:f(1)===Wu&&f(2)===Qu&&f(3)===Wu&&f(4)===Zu&&f(5)===Ju&&f(6)===_u&&(pr+=7,d(),r.legend=Q(),d(),l(Cu,"legend closer"),e=!0);break;case Wu:f(1)===is&&f(2)===es&&f(3)===zu&&f(4)===Zu&&f(5)===Ju&&f(6)===_u&&(pr+=7,d(),r.expandVectorsWith=J(),d(),l(Cu,"expand closer"),e=!0)}}function T(){for(l(yu,"comment start");!_()&&!g(s());)v();_()||v()}function R(){j()||(q(),x())}function q(){var r=z(void 0,!0);d(),_()&&sr("Expected to parse a cop but reached eof instead");var e=U();d(),"="===e?(yr=r,B(r)):L(r,e,z())}function L(r,e,n){switch(e){case"==":t(ys),i(2),i(r<n?r:n),i(r<n?n:r);break;case"!=":t(ds),i(2),i(r<n?r:n),i(r<n?n:r);break;case"<":t(hs),i(2),i(r),i(n);break;case"<=":t(gs),i(2),i(r),i(n);break;case">":t(hs),i(2),i(n),i(r);break;case">=":t(gs),i(2),i(n),i(r);break;case"&":t(ls),i(2),i(r<n?r:n),i(r<n?n:r);break;case"!&":t(ms),i(2),i(r<n?r:n),i(r<n?n:r);break;case"|":t(xs),i(2),i(r<n?r:n),i(r<n?n:r);break;case"!|":t(ks),i(2),i(r<n?r:n),i(r<n?n:r);break;case"^":t(ws),i(2),i(r<n?r:n),i(r<n?n:r);break;case"!^":t(_s),i(2),i(r<n?r:n),i(r<n?n:r);break;case"->":t(ps),i(2),i(r),i(n);break;case"!->":t(bs),i(2),i(r),i(n);break;default:sr("Unknown constraint op: ["+e+"]")}}function B(r){var e=z(r);d();var n=s();if(!_()&&!b(n)){var t=F();return t||sr("Expecting right paren or rop, got ["+t+"]"),d(),I(e,t,z(),r)}e!==r&&L(e,"==",r)}function I(r,e,n,a){var o=!1;switch(e){case"==?":t(Os),i(2),i(r<n?r:n),i(r<n?n:r),i(a),o=!0;break;case"!=?":t(Es),i(2),i(r<n?r:n),i(r<n?n:r),i(a),o=!0;break;case"<?":t(As),i(r),i(n),i(a),o=!0;break;case"<=?":t(Ns),i(r),i(n),i(a),o=!0;break;case"&?":t(Ss),i(2),i(r),i(n),i(a);break;case"!&?":t(Ds),i(2),i(r),i(n),i(a);break;case"|?":t(Vs),i(2),i(r),i(n),i(a);break;case"!|?":t(Cs),i(2),i(r),i(n),i(a);break;case"+":t(Ms),i(2),i(r<n?r:n),i(r<n?n:r),i(a);break;case"-":t(Rs),i(r),i(n),i(a);break;case"*":t(Ts),i(2),i(r<n?r:n),i(r<n?n:r),i(a);break;case"/":t(qs),i(r),i(n),i(a);break;case">?":return I(n,"<?",r,a);case">=?":return I(n,"<=?",r,a);default:sr("Expecting right paren or rop, got ["+e+"]")}return o&&a===yr&&a===xr&&cr(a,Kr(0,1)),a}function U(){var r=s();switch(r){case bu:return v(),s()===bu?(v(),"=="):"=";case vu:v();var e=s();return e===bu?(v(),"!="):e===fu?(v(),"!&"):e===Tu?(v(),"!^"):e===Su?(v(),"!|"):e===gu&&f(1)===ku?(v(),v(),"!->"):sr("Unknown cop that starts with [!]");case wu:return v(),s()===bu?(v(),"<="):"<";case ku:return v(),s()===bu?(v(),">="):">";case gu:if(f(1)===ku)return v(),v(),"->";break;case fu:return v(),"&";case Su:return v(),"|";case Tu:return v(),"^";case yu:return sr("Expected to parse a cop but found a comment instead")}_()&&sr("Expected to parse a cop but reached eof instead"),sr("Unknown cop char: `"+r+"`")}function F(){switch(s()){case bu:return v(),s()===bu?(v(),l(Au,"reifier suffix"),"==?"):"=";case vu:v();var r="";return s()===bu?(l(bu,"middle part of !=? op"),r="!=?"):s()===fu?(l(fu,"middle part of !&? op"),r="!&?"):s()===Su?(l(Su,"middle part of !|? op"),r="!|?"):sr("invalid rop that starts with a bang"),l(Au,"reifier suffix"),r;case wu:return v(),s()===bu?(v(),l(Au,"reifier suffix"),"<=?"):(l(Au,"reifier suffix"),"<?");case ku:return v(),s()===bu?(v(),l(Au,"reifier suffix"),">=?"):(l(Au,"reifier suffix"),">?");case Su:return v(),l(Au,"issome suffix"),"|?";case fu:return v(),l(Au,"isall suffix"),"&?";case Eu:return v(),"+";case gu:return v(),"-";case Vu:return v(),"*";case mu:return v(),"/";default:return""}}function j(){var r=s();return r===Ju&&f(1)===Xu&&f(2)===ts&&f(3)===as&&f(4)===Xu&&f(5)===Zu&&f(6)===Hu&&f(7)===as&&f(8)===_u?(P(ds,9),!0):r===Ju&&f(1)===Xu&&f(2)===Gu&&f(3)===Gu&&f(4)===_u?(P(ds,5),!0):r===zu&&f(1)===Yu&&f(2)===Yu&&f(3)===_u?(P(ls,4),!0):r===Zu&&f(1)===zu&&f(2)===Yu&&f(3)===Yu&&f(4)===_u?(P(ms,5),!0):r===ts&&f(1)===zu&&f(2)===Ku&&f(3)===Wu&&f(4)===_u?(P(ys,5),!0):r===ts&&f(1)===rs&&f(2)===Ku&&f(3)===Wu&&f(4)===_u?(P(xs,5),!0):r===Zu&&f(1)===rs&&f(2)===Zu&&f(3)===Wu&&f(4)===_u?(P(ks,5),!0):r===is&&f(1)===Zu&&f(2)===rs&&f(3)===ns&&f(4)===_u&&(P(_s,5),!0)}function P(r,e){pr+=e,d();var n=$();t(r),i(n.length),n.forEach(i),d(),l(Cu,"parseCalledListConstraint call closer"),x()}function $(){var r=[];for(d();!_()&&s()!==Cu;){var e=z();r.push(e),d(),s()===du&&(v(),d())}return r.length||sr("Expecting at least one expression in the list"),r}function z(r,e){var n=s(),t=void 0;if(n===_u)t=H();else if(n===xu){var a=C();t=fr(void 0,a,!1,!1,!0)}else if(n>=Ru&&n<=$u){var i=J();t=fr(void 0,i,!1,!1,!0)}else{var o=E();s()===_u?"sum"===o?t=W(Ms,r,!1):"product"===o?t=W(Ts,r,!1):"all?"===o?t=W(Ss,r,!0):"diff?"===o?t=W(Es,r,!0):"nall?"===o?t=W(Ds,r,!0):"none?"===o?t=W(Cs,r,!0):"same?"===o?t=W(Os,r,!0):"some?"===o?t=W(Vs,r,!0):sr("Unknown reifier constraint func: "+o):(t=vr(o,!1,!0))<0&&(e?xr=t=fr(o,void 0,!1,!1,!0):sr("CONSTRAINT_VARS_SHOULD_BE_DECLARED; Unknown var ["+o+"]"))}return t}function H(){l(_u,"group open"),d();var r=z();if(d(),s()!==Cu){var e=F();e||sr("Expecting right paren or rop"),d(),r=I(r,e,z(),fr(void 0,"?"===e[e.length-1]?[0,1]:void 0,!1,!1,!0)),d()}return l(Cu,"group closer"),r}function J(){var r=G();return r||sr("Expecting to parse a number but did not find any digits c=[ord("+s()+")="+String.fromCharCode(s())+"]"),parseInt(r,10)}function W(r,e,n){l(_u,"args call opener"),d();var a=$();return void 0===e?e=fr(void 0,n?[0,1]:void 0,!1,!1,!0):e===yr&&e===xr&&n&&cr(e,Kr(0,1)),t(r),i(a.length),a.sort(function(r,e){return r-e}),a.forEach(i),i(e),d(),l(Cu,"args closer"),e}function G(){for(var r="";!_();){var e=s();if(e<Ru||e>$u)break;r+=String.fromCharCode(e),v()}return r}function Q(){var r=[];d();for(var e=G();e;)r.push(parseInt(e,10)),d(),s()===du&&(++pr,d()),e=G();return r.length||sr("Expected to parse a list of at least some numbers but found none"),r}function X(r){var e=Y(r);return e.length||sr("Expected to parse a list of at least some identifiers but found none"),e}function Y(r){var e=[];for(d();!_();){var n=s();if(n===r)return e;if(b(n))break;n===du&&(e.length||sr("Leading comma not supported"),v(),d(),m(s())&&sr("Trailing comma not supported"),(n=s())===du&&sr("Double comma not supported"));var t=E();e.push(t),d()}if(void 0===r)return e;sr("Missing target char at eol/eof")}function K(){for(var r="";!_();){var e=s();if(g(e))break;r+=String.fromCharCode(e),v()}return r}function Z(){l(cu);var r=E();if("custom"===r){d();var e=E();switch(d(),s()===bu&&(v(),d()),e){case"var-strat":nr();break;case"val-strat":ir();break;case"set-valdist":d();var n=E(),t=or();rr(vr(n,!0),JSON.parse(t));break;case"noleaf":d();for(var o=X(void 0),u=0,f=o.length;u<f;++u)for(var c=vr(o[u]),p=0;p<3;++p)a(Ls),i(c);break;case"nobool":d();for(var h=X(void 0),g=0,m=h.length;g<m;++g){var b=vr(h[g]);a(Bs),i(b)}break;case"free":d();var k=J();dr=k;break;case"targets":ur();break;default:sr("Unsupported custom rule: "+e)}}else sr("Unknown atrule ["+r+"]");x()}function rr(r,n){e.valdist[r]=n}function er(r){switch(r){case 0:break;case 1:a(Fs);break;case 2:a(js),a(0);break;case 3:a(Ps),a(0),a(0);break;case 4:a($s),a(0),a(0),a(0);break;default:u(kr+r+1),r<65535?(a(Is),i(r-Hs),kr+=r-Hs):(a(Us),o(r-Js),kr+=r-Js)}}function nr(){var r=!1,n=!1,t=!1;if(s()===Gu){var a=E();"fallback"!==a&&sr("Expecting var strat name, found ["+a+"]"),r=!0,d()}if(s()===Xu){var i=E();"inverted"!==i&&sr("Expecting var strat name, found ["+i+"]"),n=!0,d()}if(s()===bu&&(v(),t=!0,d()),s()===_u)tr(r,n);else{var o=E();"naive"===o||"size"===o||"min"===o||"max"===o||"throw"===o?(n&&sr("The `inverted` keyword is only used with a list"),r?ar(o):e.input.varstrat=o):"list"===o?(d(),t&&sr("The `=` should not be used for a list"),s()!==_u&&sr("Expecting list of idents now"),tr(r,n)):sr("Unknown var strat ["+o+"]")}d()}function tr(r,n){l(_u,"List open"),d();var t=Y(Cu);d(),l(Cu,"List must be closed");var a={type:"list",inverted:n,priorityByName:t};r?ar(a):e.input.varstrat=a}function ar(r){var n=e.input.varstrat;for("string"==typeof n&&(n=e.input.varstrat={type:n});n.fallback;)n="string"==typeof n.fallback?n.fallback={type:n.fallback}:n.fallback;n.fallback=r}function ir(){e.input.valstrat=E()}function or(){return d(),s()===bu&&(v(),d()),K()}function ur(){if(d(),s()===bu&&sr("Unexpected double eq sign"),s()===zu&&f(1)===Yu&&f(2)===Yu)pr+=3;else{l(_u,"ONLY_USE_WITH_SOME_TARGET_VARS; The @targets left-paren");var r=X(Cu);e.freezeTargets(r),l(Cu,"The @targets right-paren")}x()}function sr(r){throw r+=", source at "+pr+" #|#: `"+String.fromCharCode.apply(String,_toConsumableArray(hr.slice(Math.max(0,pr-20),pr)))+"#|#"+String.fromCharCode.apply(String,_toConsumableArray(hr.slice(pr,Math.min(hr.length,pr+20))))+"`",new Error(r)}e.input.varstrat="default",e.input.valstrat="default",e.input.dsl=r;var fr=e.addVar,cr=e.setDomain,vr=e.name2index,lr=0,dr=-1,pr=0,hr=void 0,gr=(hr="undefined"==typeof Buffer?new window.TextEncoder("utf-8").encode(r):new Uint8Array(Buffer.from(r,"binary"))).length,mr=Math.ceil(hr.length/5),br=new Uint8Array(mr).fill(0),kr=0,yr=-1,xr=-1;for(a(vs);!_();)!function(){switch(p(),s()){case lu:return void w();case cu:return void Z();default:if(!_())R()}}();if(dr>0&&er(dr),a(zs),--kr,dr<0){var _r=mr-kr-1;_r>0&&er(_r)}a(zs),mr-kr&&(br=br.slice(0,kr)),e.ml=br,e.input.targets||(e.input.targets="all"),Je().log("# dsl2ml: parsed",lr,"constraints and",e.domains.length,"vars")}function $a(r,e){function n(r,e,n,t,a){var i=Uint8Array;switch(r){case 8:i=Float64Array;break;case 4:i=Float32Array;break;case 2:i=Uint16Array;break;case 1:default:i=Uint8Array}for(var o=new i(e,t,Math.trunc(a/r)),u=new i(n,t,Math.trunc(a/r)),s=0;s<u.length;s++)u[s]=o[s];return{nextOffset:o.byteOffset+o.byteLength,leftBytes:e.byteLength-(o.byteOffset+o.byteLength)}}r=Object(r);var t=new ArrayBuffer(e);if(!(r instanceof ArrayBuffer&&t instanceof ArrayBuffer))throw new TypeError("Source and destination must be ArrayBuffer instances");if(t.byteLength>=r.byteLength){var a=0,i=r.byteLength;[8,4,2,1].forEach(function(e){if(i>=e){var o=n(e,r,t,a,i);a=o.nextOffset,i=o.leftBytes}})}return t}function za(r,e,n,t){var a=Je();a.log("<pre-solving>"),a.time("</pre-solving total>");var i=n.hashNames,o=void 0===i||i,u=n.debugDsl,s=void 0!==u&&u,f=n.indexNames,c=void 0!==f&&f,v=n.groupedConstraints,l=void 0===v||v;void 0===n.hashNames&&(n.hashNames=o),void 0===n.debugDsl&&(n.debugDsl=s),void 0===n.indexNames&&(n.indexNames=c),void 0===n.groupedConstraints&&(n.groupedConstraints=l);var d=Fi(),p=(d.varNames,d.domains,Ha(r,d,n)),h=void 0,g=void 0;p===lo||(a.time("ml->dsl"),h=Va(d.ml,d),g=Oi(d.ml,d,h,{debugDsl:!1,hashNames:!0}),a.timeEnd("ml->dsl")),a.timeEnd("</pre-solving total>"),p===lo&&a.log("REJECTED");var m=void 0;if((p===vo||p!==lo&&!si(d.ml))&&(a.time("- generating early solution"),m=Wa(d,null,n,t.max||1/0),a.timeEnd("- generating early solution")),p!==lo&&(g&&g.length<1e3||n.printDslAfter)){var b="\nResult dsl (debugDsl="+s+", hashNames="+o+", indexNames="+c+"):\n"+Oi(d.ml,d,h,n);"function"==typeof n.printDslAfter?n.printDslAfter(b):(a.log("#### <DSL> after crunching before FD"),a.log(b),a.log("#### </DSL>"))}if(m)return a.error("<solved without fdq>"),m;if(p===lo)return a.error("<rejected without fdq>"),"rejected";"throw"===d.input.varstrat&&We("Forcing a choice with strat=throw"),a.error("\n\nSolving remaining problem through fdq now..."),a.log("<FD>"),a.time("</FD>");var k=e(g,t);return a.timeEnd("</FD>"),a.log("\n"),a.log("fd result:","string"==typeof k?k:"SOLVED"),k&&"string"!=typeof k?(a.error("<solved after fdq>"),Wa(d,k,n,t.max||1/0)):(a.error("<"+k+" during fdq>"),"rejected")}function Ha(r,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=n.singleCycle,a=void 0!==t&&t,i=n.repeatUntilStable,o=void 0===i||i,u=e.varNames,s=e.domains,f=e.solveStack,c=e.$addVar,v=e.$getVar,l=e.$addAlias,d=e.$getAlias,p=Je();p.time("- dsl->ml"),Pa(r,e);var h=e.ml;if(p.timeEnd("- dsl->ml"),p.log("Parsed dsl ("+r.length+" bytes) into ml ("+h.length+" bytes)"),n.printDslBefore){var g=Oi(h,e,Va(e.ml,e),n);"function"==typeof n.printDslBefore?n.printDslBefore(g):(p.log("#### <DSL> after parsing before crunching"),p.log(g),p.log("#### </DSL>"))}var m=void 0;if(a){if(p.time("- first minimizer cycle (single loop)"),m=Ga(h,e,s,u,!0,!o),p.timeEnd("- first minimizer cycle (single loop)"),m!==lo){p.time("- deduper cycle #");var b=ja(h,e);p.timeEnd("- deduper cycle #"),b>=0&&(p.time("- cutter cycle #"),Fa(h,e,!o),p.timeEnd("- cutter cycle #"))}}else{var k=0;p.time("- all run cycles");do{m=Ja(h,v,c,s,u,l,d,f,k++,e)}while(m===co);p.timeEnd("- all run cycles")}return m}function Ja(r,e,n,t,a,i,o,u,s,f){var c=Je();c.time("- run_cycle #"+s),c.time("- minimizer cycle #"+s);var v=Ga(r,f,t,a,0===s);if(c.timeEnd("- minimizer cycle #"+s),v===vo)return v;if(v===lo)return v;c.time("- deduper cycle #"+s);var l=ja(r,f);if(c.timeEnd("- deduper cycle #"+s),l<0)v=lo;else{c.time("- cutter cycle #"+s);var d=Fa(r,f,!1);c.timeEnd("- cutter cycle #"+s),d>1||l?v=co:d<0&&(v=lo)}return c.timeEnd("- run_cycle #"+s),v}function Wa(r,n,t,a){function i(r,e){if(e||(r=p(r)),n){var t="$"+r.toString(36)+"$",a=n[t];if("number"==typeof a)return Yr(a);if(void 0!==a)return ke(a)}return g(r,!0)}function o(r,e,t,a){if(t||(r=p(r)),m(r,e,!0,!1,a),n){var i="$"+r.toString(36)+"$";if(void 0!==n[i]){var o=u(e);n[i]=o>=0?o:te(e)}}}function s(n,t){var a=i(p(n),!0),s=u(a);if(s<0){t&&(a=t);var f=r.valdist[n];if(f)switch(f.valtype){case"list":f.list.some(function(r){return e(a,r)&&(s=r)>=0}),s<0&&(s=ar(a));break;case"max":s=fr(a);break;case"min":case"naive":s=ar(a);break;case"mid":s=nr(a);break;case"markov":case"minMaxCycle":case"splitMax":case"splitMin":We("implement me (var mod) ["+f.valtype+"]"),s=ar(a);break;default:We("Unknown dist name: ["+f.valtype+"]",f)}else s=ar(a);o(n,Yr(s),!0)}return s}Je().time("createSolution()");var f=t.flattened,c=void 0!==f&&f,v=r.varNames,l=r.domains,d=r.solveStack,p=r.getAlias,h=r.targeted,g=r.getDomain,m=r.setDomain;!function(){for(var r=d.reverse(),e=0;e<r.length;++e)(0,r[e])(l,s,i,o)}(),function(){for(var e=0;e<l.length;++e)if(c||r.valdist[e])m(e,Yr(s(e)),!0);else{var n=i(e);u(n)>=0&&m(e,n,!0)}}(),function(){for(var r=0;r<l.length;++r)if(!1===l[r]){var e=s(p(r));m(r,Yr(e),!0)}}();var b=function(){for(var r={},e=0;e<v.length;++e)if(h[e]){var n=v[e],t=i(e),a=u(t);t=a>=0?a:c?ar(t):te(t),r[n]=t}return r}();return Je().timeEnd("createSolution()"),b}function Ga(r,e,n,t,a,i){var o=Qa(r,e,n,t,a,i);return o}function Qa(r,e,n,t,a,i){function o(r,e,n,t){vr(r,e),_r.push(function(t,a,i,o){a(e)>0&&o(r,Lr(n,0),!0,!0)})}function s(r,e){var n=ri(r,e),t=lr(n);return t!==n&&ti(r,e,t),t}function f(r){var e=dr(r,!0);return e||v(r,"bad state (empty domain should have been detected sooner)"),e}function c(r,e,n){return pr(r,e,!1,!0),e?Y=!0:rr=!0,rr}function v(r,e){rr=!0,r>=0&&c(r,re(),"explicitly empty"+(e?"; "+e:""))}function l(r,e,n){switch(Ka(r,e+n)){case Fs:case js:case Ps:case $s:case Is:case Us:oi(r,e,n),tr=e;break;default:tr=e+n}}function d(r,e){var n=ri(r,e+1);if(2!==n||s(r,e+Ys)!==s(r,e+Ks)){if(n>1)for(var t=s(r,e+Gs),a=dr(t,!0),i=1;i<n;++i){var o=s(r,e+Gs+2*i);if(o!==t&&!(a=N(o,t,dr(o,!0),a)))break}ii(r,e,Gs+2*n)}else ii(r,e,Qs)}function p(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(!i||!o)return!0;if(t===a)return v(t,"X!=X falsum"),!0;var l=!1,d=u(i);if(d>=0){var p=o;if(o=Lr(o,d),p!==o&&c(a,o,"A != B with A solved"))return!0;l=!0}else{var h=u(o);if(u(o)>=0){var g=i;if((i=Lr(i,h))!==g&&c(t,i,"A != B with B solved"))return!0;l=!0}}return l||C(i,o)||(l=!0),!!l&&(ii(r,e,Qs),!0)}function h(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(t===a)return v(t,"X<X falsum");if(i&&o){var u=i;if((i=Sr(i,fr(o)))===u||!c(t,i,"A lt B")){var l=o;(o=Cr(o,ar(i)))!==l&&c(a,o,"A lt B")||(fr(i)<ar(o)?ii(r,e,Qs):(Z=!1,tr=e+Qs))}}}function g(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(i&&o)if(t!==a){var u=i;if((i=qr(i,fr(o)))===u||!c(t,i,"A lte B")){var v=o;(o=Rr(o,ar(i)))!==v&&c(a,o,"A lte B")||(fr(i)<=ar(o)?ii(r,e,Qs):yr(i)&&yr(o)&&fr(i)<=fr(o)?(fi(r,e,2,ps,t,a),_r.push(function(r,e,n,i){var o=n(t),u=n(a);mr(o)?(u=Lr(u,0),i(a,u)):(gr(u)||xr(o))&&(o=qr(o,0),i(t,o))})):(Z=!1,tr=e+Qs))}}else ii(r,e,Qs)}function m(r,e){var n=e+1,t=ri(r,n),a=e+Gs,i=Gs+2*t;if(!t)return v(-1,"nall without args is probably a bug");if(2!==t||!b(r,e)){for(var o=t,u=-1,l=void 0,d=t-1;d>=0;--d){var p=s(r,a+2*d),h=f(p);if(!h)return;if(ar(h)>0||u===p)U(r,a,t,d,!1),--t;else{if(gr(h))return void ii(r,e,Gs+2*o);u=p,l=h}}if(0===t)return v(u,"nall; none of the args were zero");if(1===t){var g=qr(l,0);if(l!==g&&c(u,g))return;ii(r,e,Gs+2*o)}else if(o!==t){ti(r,n,t);var m=2*(o-t);ui(r,e+i-m,m)}else Z=!1,tr=e+i}}function b(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(!i||!o)return!0;if(t===a){var u=i;return(i=qr(i,0))!==u&&c(t,i,"`A !& A` means A must be zero"),ii(r,e,Qs),!0}if(gr(i)||gr(o))return ii(r,e,Qs),!0;if(mr(i)){var v=o;return(o=qr(o,0))!==v&&c(a,o,"nall[2] B"),ii(r,e,Qs),!0}if(mr(o)){var l=i;return(i=qr(i,0))!==l&&c(t,i,"nall[2] A"),ii(r,e,Qs),!0}return!1}function k(r,e){var n=e+1,t=ri(r,n),a=e+Gs,i=Gs+2*t;if(!t)return v(-1,"some without args is probably a bug");if(2!==t||!P(r,e)){for(var o=t,u=-1,l=void 0,d=t-1;d>=0;--d){var p=s(r,a+2*d),h=f(p);if(!h)return;if(gr(h)||u===p)U(r,a,t,d,!1),--t;else{if(mr(h))return void ii(r,e,Gs+2*o);u=p,l=h}}if(0===t)return v(u,"some; all of the args were zero");if(1===t){var g=Lr(l,0);if(l!==g&&c(u,g))return;ii(r,e,Gs+2*o)}else if(o!==t){ti(r,n,t);var m=2*(o-t);ui(r,e+i-m,m)}else Z=!1,tr=e+i}}function y(r,e){var n=ri(r,e+1),t=Gs+2+2*n,a=e+Gs,i=s(r,e+t-2),o=f(i);if(o){if(gr(o))return ni(r,e,ms),void ui(r,e+t-2,2);if(mr(o)){for(var u=0;u<n;++u){var v=s(r,a+2*u),l=f(v);if(!l)return;var d=Lr(l,0);if(d!==l&&c(v,d))return}ii(r,e,t)}else{for(var p=!0,h=!1,g=!1,m=0;m<n;++m){var b=f(s(r,a+2*m));if(gr(b)){h=!0;break}0===ar(b)?p=!1:g=!0}if(h){var k=o;return(o=qr(o,0))!==k&&c(i,o),void ii(r,e,t)}if(p){var y=o;return(o=Lr(o,0))!==y&&c(i,o),void ii(r,e,t)}if(g){for(var _=0,w=n-1;w>=0;--w)mr(f(s(r,a+2*w)))&&(U(r,a,n,w,!0),--n,++_);ti(r,e+1,n);var S=t-2*_;return ui(r,e+S,t-S),void(1===n&&x(r,e,n,a,i))}if(1===n)return x(r,e,n,a,i);Z=!1,tr=e+t}}}function x(r,e,n,t,a){var i=s(r,t);di(r,e,n,_s,a,i),Y=!0}function _(r,e){var n=ri(r,e+1),t=Gs+2*n+2,a=e+Gs,i=s(r,e+t-2),o=f(i);if(o)if(gr(o)){for(var u=0;u<n;++u){var v=s(r,a+2*u),l=f(v);if(!l)return;var d=Lr(l,0);if(d!==l&&c(v,d))return}ii(r,e,t)}else{if(mr(o))return ni(r,e,ms),void ui(r,e+t-2,2);for(var p=!0,h=!1,g=0;g<n;++g){var m=f(s(r,a+2*g));if(gr(m)){h=!0;break}0===ar(m)&&(p=!1)}if(h){var b=o;(o=Lr(o,0))!==b&&c(i,o,"isnall, R>=1 because at least one var was zero"),ii(r,e,t)}else if(p){var k=o;(o=qr(o,0))!==k&&c(i,o),ii(r,e,t)}else Z=!1,tr=e+t}}function w(r,e){var n=ri(r,e+1),t=Gs+2*n+2,a=e+Gs,i=s(r,e+t-2),o=f(i);if(o)if(gr(o)){for(var u=0;u<n;++u){var v=s(r,a+2*u),l=f(v);if(!l)return;var d=qr(l,0);if(d!==l&&c(v,d))return}ii(r,e,t)}else{if(mr(o))return ni(r,e,xs),void ui(r,e+t-2,2);for(var p=!1,h=!0,g=!1,m=0;m<n;++m){var b=f(s(r,a+2*m));if(mr(b)){p=!0;break}gr(b)?g=!0:h=!1}if(p){var k=o;(o=Lr(o,0))!==k&&c(i,o,"issome, R>=1 because at least one var was nonzero"),ii(r,e,t)}else if(h){var y=o;(o=qr(o,0))!==y&&c(i,o,"issome, R>=1 because all vars were zero"),ii(r,e,t)}else if(g){_i(r,tr+Gs,n);for(var x=a+2*n-2,_=n;gr(dr(s(r,x)));)x-=2,--_;if(1===_){var w=s(r,a);di(r,e,n,_s,i,w)}else ti(r,e+1,_),ti(r,x+2,i),ui(r,x+4,2*(n-_))}else Z=!1,tr=e+t}}function S(r,e){var n=ri(r,e+1),t=Gs+2*n+2,a=e+Gs,i=s(r,e+t-2),o=f(i);if(o)if(mr(o)){for(var u=0;u<n;++u){var v=s(r,a+2*u),l=f(v);if(!l)return;var d=qr(l,0);if(d!==l&&c(v,d))return}ii(r,e,t)}else{if(gr(o))return ni(r,e,xs),void ui(r,e+t-2,2);for(var p=!1,h=!0,g=0;g<n;++g){var m=f(s(r,a+2*g));if(mr(m)){p=!0;break}gr(m)||(h=!1)}if(p){var b=o;(o=qr(o,0))!==b&&c(i,o,"isnone R=0 because an arg had no zero"),ii(r,e,t)}else if(h){var k=o;(o=Lr(o,0))!==k&&c(i,o,"isnone R>=1 because all args were zero"),ii(r,e,t)}else Z=!1,tr=e+Gs+2*n+2}}function E(r,e){var n=ri(r,e+1),t=e+Gs,a=Gs+2*n;if(!n)return v(-1,"diff without args is probably a bug");for(var i=n,o=n-1;o>=0;--o){var l=s(r,t+2*o),d=f(l);if(!d)return;var h=u(d);if(h>=0){for(var g=0;g<n;++g)if(g!==o){var m=s(r,t+2*g),b=f(m);if(l===m)return c(l,re(),"diff had this var twice, x!=x is a falsum");var k=Lr(b,h);if(k!==b&&c(m,k,"diff arg"))return}U(r,t,n,o,!0),--n}}n<=1?ii(r,e,a):n!==i?(ti(r,e+1,n),ui(r,t+2*n,2*(i-n))):2===n&&p(r,e)||(Z=!1,tr=e+a)}function A(r,e){var n=e+Ks,t=e+rf,a=s(r,e+Ys),i=s(r,n),o=s(r,t),v=f(a),l=f(i),d=f(o);if(!v||!l||!d)return!1;var p=v,h=l,g=d,m=void 0,b=void 0,k=void 0,y=0;do{++y,m=v,b=l,k=d,l=C(l,xe(d=C(d,Re(v,l)),v=C(v,xe(d,l))))}while(v!==m||l!==b||d!==k);if(y>1&&(v!==p&&c(a,v,"plus A"),l!==h&&c(i,l,"plus B"),d!==g&&c(o,d,"plus R"),!v||!l||!d))return!1;var x=u(v),_=u(l);u(d);return x>=0&&_>=0?(ii(r,e,Xs),!0):!!(x>=0&&D(e,i,a,o,v,l,d,x,"A","B"))||!!(_>=0&&D(e,a,i,o,l,v,d,_,"B","A"))}function N(r,e,n,t){var a=C(n,t);return n!==t&&c(e,a,"intersectAndAlias"),a&&!hr(n)&&vr(r,e),a}function D(e,n,t,a,i,o,u,s,f,c){return 0===s?(N(a,n,u,o),ii(r,e,Xs),Y=!0,!0):!(!kr(o)||2!==K(u)||ar(u)!==s)&&(li(r,e,2,Es,a,t,n),Y=!0,!0)}function O(r,e){var n=e+3,t=e+5,a=s(r,e+1),i=s(r,n),o=s(r,t),v=f(a),l=f(i),d=f(o);if(v&&l&&d){var p=v,h=l,g=d,m=void 0,b=void 0,k=void 0,y=0;do{++y,m=v,b=l,k=d,l=C(l,xe(v=C(v,Re(d=C(d,xe(v,l)),l)),d))}while(v!==m||l!==b||d!==k);y>1&&(v!==p&&c(a,v,"minus A"),l!==h&&c(i,l,"minus B"),d!==g&&c(o,d,"minus R"),!(v&&l&&d))||(hr(d)&&hr(v)?ii(r,e,Ws):0===u(v)?(N(o,i,d,l),ii(r,e,Ws),Y=!0):0===u(l)?(N(o,a,d,v),ii(r,e,Ws),Y=!0):(Z=!1,tr=e+Ws))}}function V(r,e){var n=e+Ks,t=e+rf,a=s(r,e+Ys),i=s(r,n),o=s(r,t),u=f(a),v=f(i),l=f(o);if(!u||!v||!l)return!0;var d=u,p=v,h=l,g=void 0,m=void 0,b=void 0,k=0;do{++k,g=u,m=v,b=l,v=C(v,Q(l=C(l,$(u,v)),u=C(u,Q(l,v))))}while(u!==g||v!==m||l!==b);return k>1&&(u!==d&&c(a,u,"mul A"),v!==p&&c(i,v,"mul B"),l!==h&&c(o,l,"mul R"),!u||!v||!l)||!(!hr(l)||!hr(u))&&(ii(r,e,Xs),!0)}function M(r,e){var n=e+3,t=e+5,a=s(r,e+1),i=s(r,n),o=s(r,t),u=f(a),v=f(i),l=f(o);if(u&&v&&l){var d=l;(l=C(l,J(u,v)))!==d&&c(o,l,"div R"),u&&v&&l&&(hr(v)&&hr(u)?ii(r,e,Ws):(Z=!1,tr=e+Ws))}}function T(r,e){var n=ri(r,e+1);if(2!==n)return Z=!1,void(tr=e+Gs+2*n+2);var t=e+Ks,a=e+rf,i=s(r,e+Ys),o=s(r,t),v=s(r,a),l=f(i),d=f(o),p=f(v);if(l&&d&&p){if(i===o){var h=p;return(p=Lr(p,0))!==h&&c(v,p,"issame R: A!=B"),void ii(r,e,Xs)}var g=u(l),m=u(d);if(g>=0&&m>=0){var b=p;return l===d?(p=Lr(p,0))!==b&&c(v,p,"issame R: A==B"):(p=I(p,0))!==b&&c(v,p,"issame R: A!=B"),void ii(r,e,Xs)}if(gr(p))return di(r,e,2,ds,i,o),void(Y=!0);if(mr(p))return N(i,o,l,d),ii(r,e,Xs),void(Y=!0);if(i===o){var k=p;return(p=Lr(p,0))!==k&&c(v,p,"issame R: A==B"),void ii(r,e,Xs)}if(!C(l,d)){var y=p;return(p=qr(p,0))!==y&&c(v,p,"issame; no overlap A B so R=0"),void ii(r,e,Xs)}if(kr(p)){if(g>=0&&g<=1&&kr(d))return 0===g?di(r,e,2,ds,o,v):(N(v,o,p,d),ii(r,e,Xs)),void(Y=!0);if(m>=0&&m<=1&&kr(l))return 0===m?di(r,e,2,ds,i,v):(N(v,i,p,l),ii(r,e,Xs)),void(Y=!0)}if(0===g)return di(r,e,2,ws,v,o),void(Y=!0);if(0===m)return di(r,e,2,ws,v,i),void(Y=!0);Z=!1,tr=e+Xs}}function R(r,e){var n=ri(r,e+1);if(2!==n)return Z=!1,void(tr=e+Gs+2*n+2);var t=e+Ks,a=e+rf,i=s(r,e+Ys),o=s(r,t),u=s(r,a),v=f(i),l=f(o),d=f(u);if(v&&l&&d){if(hr(v)&&hr(l)){var p=d;return v===l?(d=qr(d,0))!==p&&c(u,d,"isdiff R; A==B"):(d=Lr(d,0))!==p&&c(u,d,"isdiff R; A!=B"),void ii(r,e,Xs)}if(gr(d))return N(i,o,v,l),ii(r,e,Xs),void(Y=!0);if(mr(d))return di(r,e,2,ds,i,o),void(Y=!0);Z=!1,tr=e+Xs}}function q(r,e){var n=e+3,t=e+5,a=s(r,e+1),i=s(r,n),o=s(r,t),u=f(a),v=f(i),l=f(o);if(u&&v&&l){var d=l;if(hr(l)||(fr(u)<ar(v)?l=Lr(l,0):ar(u)>=fr(v)&&(l=qr(l,0))),l===d||c(o,l,"islt; solving R because A < B or A >= B"))return gr(l)?(hi(r,e,gs,i,a),void(Y=!0)):mr(l)?(hi(r,e,hs,a,i),void(Y=!0)):gr(u)?(hi(r,e,_s,o,i),void(Y=!0)):void(gr(v)?ii(r,e,Ws):(Z=!1,tr=e+Ws))}}function L(r,e){var n=e+3,t=e+5,a=s(r,e+1),i=s(r,n),o=s(r,t),u=f(a),v=f(i),l=f(o);if(u&&v&&l){var d=l;if(fr(u)<=ar(v)?l=Lr(l,0):ar(u)>fr(v)&&(l=qr(l,0)),l===d||!c(o,l,"islte; solving R because A and B are solved")){var p=gr(l),h=!p&&mr(l);if(p)return hi(r,e,hs,i,a),void(Y=!0);if(h)return hi(r,e,gs,a,i),void(Y=!0);if(kr(l)&&fr(u)<=1&&fr(v)<=1){if(kr(u)&&gr(v))return hi(r,e,ds,a,o),void(Y=!0);if(kr(u)&&v===Yr(1))return N(a,o,u,l),ii(r,e,Ws),void(Y=!0);if(kr(v)&&u===Yr(1))return N(i,o,v,l),ii(r,e,Ws),void(Y=!0)}Z=!1,tr=e+Ws}}}function B(r,e){var n=ri(r,e+1);if(2!==n||!A(r,e)){var t=Gs+2*n+2,a=e+Gs,i=s(r,e+t-2),o=f(i);if(o){for(var v=Yr(0),l=0,d=0,p=0;p<n;++p){var h=f(s(r,a+2*p)),g=u(h);g>=0&&(++l,d+=g),v=Re(v,h)}var m=o;if(l===n)return(o=I(o,d))!==m&&c(i,o,"setting R to sum of constants"),void ii(r,e,t);if((o=C(v,o))===m||!c(i,o,"sum; updating R with outer bounds of its args;")){var b=d?xe(o,Yr(d)):o;l=0,d=0;for(var k=ar(b),y=fr(b),x=-1,_=-1,w=0;w<n;++w){var S=s(r,a+2*w),E=f(S),D=u(E);if(D>=0)++l,d+=D;else{var O=Rr(E,k);if((O=qr(E,y))!==E&&c(S,O,"plus arg; trim invalid values"))return;(D=u(O))>=0?(++l,d+=D):-1===x?x=S:-1===_&&(_=S)}}if(1===n-l+(0===d?0:1)){if(d>0){var V=I(o,d);V!==o&&c(i,V,"min_sum")}else N(i,x,o,dr(x,!0));ii(r,e,t)}else if(l>1||1===l&&0===d){for(var M=t-2*(l-(d>0?1:0)),T=n-1;T>=0&&l;--T)if(hr(f(s(r,a+2*T)))){if(1===l&&0!==d){ti(r,a+2*T,cr(void 0,d,!1,!1,!0));break}U(r,a,n,T,!0),--n,--l}ti(r,e+1,n),ui(r,e+M,t-M)}else Z=!1,tr=e+t}}}}function U(r,e,n,t,a){var i=n;a&&++i;for(var o=t+1;o<i;++o){var u=e+2*o,s=e+2*(o-1);r[s]=r[u],r[s+1]=r[u+1]}}function F(r,e){var n=ri(r,e+1);if(2!==n||!V(r,e)){var t=Gs+2*n+2,a=e+Gs,i=s(r,e+t-2),o=f(i);if(o){for(var v=Yr(1),l=0,d=1,p=0;p<n;++p){var h=f(s(r,a+2*p)),g=u(h);g>=0&&(++l,d*=g),v=$(v,h)}var m=o;if(l===n)return(o=I(o,d))!==m&&c(i,o,"setting R to product of constants"),void ii(r,e,t);if(0===d)return(o=I(o,0))!==m&&c(i,o,"setting R to zero"),void ii(r,e,t);if((o=C(v,o))===m||!c(i,o,"product; updating R with outer bounds of its args;")){if(gr(o))return ni(r,e,ms),void ui(r,e+t-2,2);for(var b=1===d?o:Q(o,Yr(d)),k=ar(b),y=fr(b),x=!1,_=-1,w=-1,S=0;S<n;++S){var E=s(r,a+2*S),A=f(E),D=u(A);if(0===D&&(x=!0),D<0){!x&&br(A)&&(x=!0);var O=Rr(A,k);if((O=qr(A,y))!==A&&c(E,O,"product arg; trim invalid values"))return;(D=u(O))>=0?(++l,d+=D):-1===_?_=E:-1===w&&(w=E)}}if(1===n-l+(1===d?0:1)){if(1!==d)if(x){var M=C(o,ee(d));M!==o&&c(i,M,"min_product")}else{var T=I(o,d);T!==o&&c(i,T,"min_product")}else N(i,_,o,dr(_,!0));ii(r,e,t)}else if(l>1){for(var R=t-2*(l-1),q=n-1;q>=0&&l;--q)hr(f(s(r,a+2*q)))&&(1===l?ti(r,a+2*q,cr(void 0,d,!1,!1,!0)):(U(r,a,n,q,!0),--n),--l);var L=t-R;ti(r,e+1,n),ui(r,e+R,L)}else Z=!1,tr=e+t}}}}function j(r,e){for(var n=ri(r,e+1),t=0;t<n;++t){var a=s(r,e+Gs+2*t),i=dr(a,!0),o=Lr(i,0);i!==o&&c(a,o,"ALL D")}ii(r,e,Gs+2*n)}function P(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(!i||!o)return!0;if(t===a){var u=Lr(i,0);return i!==u&&c(t,u,"A|A"),void ii(r,e,Qs)}if(gr(i)){var v=o;return(o=Lr(v,0))!==v&&c(a,o,"OR B"),ii(r,e,Qs),!0}if(gr(o)){var l=i;return(i=Lr(l,0))!==l&&c(t,i,"OR A"),ii(r,e,Qs),!0}return!(!mr(i)&&!mr(o))&&(ii(r,e,Qs),!0)}function z(r,e){for(var n=ri(r,e+1),t=0;t<n;++t){var a=s(r,e+Gs+2*t),i=dr(a,!0),o=qr(i,0);i!==o&&c(a,o)}ii(r,e,Gs+2*n)}function H(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(i&&o){if(t===a)return v(t,"x^x"),void(rr=!0);if(gr(i)){var u=o;return(o=Lr(o,0))!==u&&c(a,o,"xor B>=1"),void ii(r,e,Qs)}if(gr(o)){var l=i;return(i=Lr(i,0))!==l&&c(t,i,"xor A>=1"),void ii(r,e,Qs)}if(mr(i)){var d=o;return(o=qr(o,0))!==d&&c(a,o,"xor B=0"),void ii(r,e,Qs)}if(mr(o)){var p=i;return(i=qr(i,0))!==p&&c(t,i,"xor A=0"),void ii(r,e,Qs)}Z=!1,tr=e+Qs}}function W(r,e){var n=ri(r,e+1);if(2!==n)return Z=!1,void(tr=e+Gs+2*n);var t=e+Ks,a=s(r,e+Ys),i=s(r,t),u=f(a),v=f(i);if(u&&v)if(a!==i){if(gr(u)){var l=v;return(v=qr(v,0))!==l&&c(i,v,"xnor B"),void ii(r,e,Qs)}if(gr(v)){var d=u;return(u=qr(u,0))!==d&&c(a,u,"xnor A"),void ii(r,e,Qs)}if(mr(u)){var p=v;return(v=Lr(v,0))!==p&&c(i,v,"xnor B"),void ii(r,e,Qs)}if(mr(v)){var h=u;return(u=Lr(u,0))!==h&&c(a,u,"xnor A"),void ii(r,e,Qs)}if(2===K(u)){if(u===v)return vr(a,i),void(Y=!0);if(2===K(v))return o(a,i,u,v),void(Y=!0)}Z=!1,tr=e+Qs}else ii(r,e,Qs)}function G(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(i&&o)if(t!==a)if(gr(i))ii(r,e,Qs);else{if(mr(i)){var u=o;return o=Lr(u,0),u!==o&&c(a,o,"IMP B"),void ii(r,e,Qs)}if(gr(o)){var v=i;return i=qr(v,0),v!==i&&c(t,i,"IMP A"),void ii(r,e,Qs)}mr(o)?ii(r,e,Qs):(Z=!1,tr=e+Qs)}else ii(r,e,Qs)}function X(r,e){var n=e+Ks,t=s(r,e+Ys),a=s(r,n),i=f(t),o=f(a);if(i&&o){var u=i;u!==(i=Lr(u,0))&&c(t,i,"NIMP A");var v=o;v!==(o=qr(v,0))&&c(a,o,"NIMP B"),ii(r,e,Qs)}}for(var Y=!0,Z=!1,rr=!1,er=0,nr=0,tr=0,ir=0,or=0,ur=!1,sr=Je(),cr=e.addVar,vr=e.addAlias,lr=e.getAlias,dr=e.getDomain,pr=e.setDomain,_r=e.solveStack;!Z&&(Y||ur);){++ir,sr.time("-> min_loop "+ir),Y=!1,Z=!0,ur=!1,tr=0,or=0;var wr=function(){var e=0;Z=!0;for(var n=!1;tr<r.length&&!rr;){++e,++or,n=!1;var t=tr;er=tr;var a=r[tr];switch(nr=a,a){case vs:if(0!==tr)return We(" ! optimizer problem @",tr);n=!0,++tr,--or;break;case zs:return n=!0,--or,e;case hs:h(r,tr);break;case gs:g(r,tr);break;case ks:z(r,tr);break;case ws:H(r,tr);break;case _s:W(r,tr);break;case ps:G(r,tr);break;case bs:X(r,tr);break;case ds:E(r,tr);break;case ls:j(r,tr);break;case Es:R(r,tr);break;case ms:m(r,tr);break;case ys:d(r,tr);break;case xs:k(r,tr);break;case As:q(r,tr);break;case Ns:L(r,tr);break;case Ss:y(r,tr);break;case Ds:_(r,tr);break;case Os:T(r,tr);break;case Vs:w(r,tr);break;case Cs:S(r,tr);break;case Rs:O(r,tr);break;case qs:M(r,tr);break;case Ms:B(r,tr);break;case Ts:F(r,tr);break;case Bs:case Ls:tr+=Hs,n=!0;break;case Fs:l(r,tr,1),--or,n=!0;break;case js:l(r,tr,2),--or,n=!0;break;case Ps:l(r,tr,3),--or,n=!0;break;case $s:l(r,tr,4),--or,n=!0;break;case Is:l(r,tr,Hs+ri(r,tr+1)),--or,n=!0;break;case Us:l(r,tr,Js+ei(r,tr+1)),--or,n=!0;break;default:We("(mn) unknown op: 0x"+a.toString(16)," at",tr)}tr!==t||rr||(n||(ur=!0),--or)}return rr?e:We("Derailed; expected to find STOP before EOF")}();if(rr&&(sr.log("Empty domain at",er,"for opcode",nr,[yi(r,er,1,e)],r.slice(er,er+10)),sr.error("Empty domain, problem rejected")),sr.timeEnd("-> min_loop "+ir),sr.log("   - ops this loop:",wr,"constraints:",or),rr)return lo;if(Z)return vo;if(i)break;!1}return 1===ir?fo:co}function Xa(r,e,n){switch(n){case ps:case hs:case gs:case bs:case ws:return Qs;case vs:return 1;case As:case Ns:case Rs:case qs:return Ws;case ls:case ds:case ms:case ks:case ys:case xs:case _s:return r&&e>=0?Gs+2*Za(r,e+1):-1;case Ss:case Es:case Ds:case Cs:case Os:case Vs:return r&&e>=0?Gs+2*Za(r,e+1)+2:-1;case Ms:case Ts:return r&&e>=0?Gs+2*Za(r,e+1)+2:-1;case Bs:case Ls:return Hs;case Is:return Hs+Za(r,e+1);case Us:return Js+Ia(r,e+1);case Fs:return 1;case js:return 2;case Ps:return 3;case $s:return 4;case zs:return 1;default:Je().log("(ml) unknown op",n," at",e),We("(ml_sizeof) unknown op: "+r[e]," at",e)}}function Ya(r,e){return r[e]}function Ka(r,e){return Ya(r,e)}function Za(r,e){return r[e++]<<8|r[e]}function ri(r,e){return Za(r,e)}function Ia(r,e){return r[e++]<<24|r[e++]<<16|r[e++]<<8|r[e]}function ei(r,e){return Ia(r,e)}function ni(r,e,n){r[e]=n}function ti(r,e,n){r[e++]=n>>8&255,r[e]=255&n}function ai(r,e,n){r[e++]=n>>24&255,r[e++]=n>>16&255,r[e++]=n>>8&255,r[e]=255&n}function ii(r,e,n){ui(r,e,n)}function oi(r,e,n){switch(r[e+n]){case Fs:return oi(r,e,n+1);case js:return oi(r,e,n+2);case Ps:return oi(r,e,n+3);case $s:return oi(r,e,n+4);case Is:var t=ri(r,e+n+1);return oi(r,e,n+Hs+t);case Us:var a=ei(r,e+n+1);return oi(r,e,n+Js+a)}ui(r,e,n)}function ui(r,e,n){switch(n){case 0:return We("this is a bug");case 1:return ni(r,e,Fs);case 2:return ni(r,e,js);case 3:return ni(r,e,Ps);case 4:return ni(r,e,$s);default:n<65535?(ni(r,e,Is),ti(r,e+1,n-Hs)):(ni(r,e,Us),ai(r,e+1,n-Js))}}function si(r){for(var e=0;e<r.length;)switch(r[e]){case vs:if(0!==e)return xi("oops");++e;break;case zs:return!1;case Fs:++e;break;case js:e+=2;break;case Ps:e+=3;break;case $s:e+=4;break;case Is:e+=Hs+Za(r,e+1);break;case Us:e+=Js+Ia(r,e+1);break;default:return!0}We("ML OOB")}function fi(r,e,n,t,a,i){ni(r,e,t),ti(r,e+1,2),ti(r,e+Ys,a),ti(r,e+Ks,i);var o=Gs+2*n;Qs<o&&ui(r,e+Qs,o-Qs)}function ci(r,e,n,t,a){a.sort(function(r,e){return r-e});ni(r,e,t),ti(r,e+1,n);for(var i=0;i<n;++i)ti(r,e+Gs+2*i,a[i])}function vi(r,e,n,t,a){var i=a.length,o=Gs+2*i;ni(r,e,t),ti(r,e+1,i);for(var u=0;u<i;++u)ti(r,e+Gs+2*u,a[u]);o<n&&ui(r,e+o,n-o)}function li(r,e,n,t,a,i,o){ni(r,e,t),ti(r,e+1,2),ti(r,e+Ys,a),ti(r,e+Ks,i),ti(r,e+Zs,o);var u=Gs+2*n+2;Xs<u&&ui(r,e+Xs,u-Xs)}function di(r,e,n,t,a,i){var o=ri(r,e+1);ni(r,e,t),ti(r,e+1,2),ti(r,e+Ys,a),ti(r,e+Ks,i);var u=Gs+2*o+2;Qs<u&&ui(r,e+Qs,u-Qs)}function pi(r,e,n,t,a){var i=a.length;ni(r,e,t),ti(r,e+1,i);for(var o=0;o<i;++o)ti(r,e+Gs+2*o,a[o]);var u=Gs+2*n+2,s=Gs+2*i;s<u&&ui(r,e+s,u-s)}function hi(r,e,n,t,a){ni(r,e,n),ti(r,e+1,2),ti(r,e+Ys,t),ti(r,e+Ks,a)}function gi(r,e,n){for(var t=r.length,a=r[e];e<t;){var i=Xa(r,e,a=r[e]),o=n(r,e,a,i);if(void 0!==o)return o;e+=i}}function mi(r,e,n,t){var a=[];return gi(r,e,function(r,e,i){if(i===Is||i===Us){var o=ki(r,e);if(o>=t){a.push(e);do{--n,o-=t}while(n&&o>=t);if(!n)return!0}}}),!n&&a}function bi(r,e,n,t,a){for(var i=0;i<n;){var o=e.pop(),u=ki(r,o);do{if(a(o,i,u))return;++i,u-=t,o+=t}while(u>=t&&i<n);u&&ui(r,o,u)}}function ki(r,e){return Xa(r,e,r[e])}function yi(r,e,n,t,a,i){function o(e){var n=Za(r,e);return"{index="+n+(t&&n<f.length?",name="+f[n]:"")+(t?","+U(s(n)):"")+"}"}function u(e){return Za(r,e)}var s=t&&t.getDomain,f=t&&t.varNames,c=void 0,v=[];n<0&&(n=r.length);for(var l=e,d=0;d++<n&&l<r.length;){var p="",h=r[l];switch(h){case vs:if(0!==l)return i||xi(r,l,"ML_START at non-zero"),v.push("unused_error(0)"),v.join("\n");break;case ps:p||(p="->");case bs:p||(p="!->");case hs:p||(p="<");case gs:p||(p="<=");case ws:p||(p="^"),v.push(o(l+Ys)+" "+p+" "+o(l+Ks));break;case As:p||(p="<?");case Ns:p||(p="<=?"),c=o(l+1)+" "+p+" "+o(l+3),v.push(o(l+5)+" = "+c);break;case Ms:p||(p="sum");case Ts:p||(p="product");case Ss:p||(p="isall");case Es:p||(p="isdiff");case Ds:p||(p="isnall");case Os:p||(p="issame");case Vs:p||(p="issome");case Cs:p||(p="isnone");for(var g="",m=u(l+1),b=0;b<m;++b)g+=o(l+Gs+2*b)+" ";g=p+"("+g+")",g=o(l+Gs+2*m)+" = "+g,v.push(g);break;case ls:p||(p="all");case ms:p||(p="nall");case ys:p||(p="same");case xs:p||(p="some");case ks:p||(p="none");case _s:p||(p="xnor");case ds:p||(p="diff");for(var k="",y=u(l+1),x=0;x<y;++x)k+=o(l+Gs+2*x)+" ";k=p+"("+k+")",v.push(k);break;case Rs:p||(p="-");case qs:p||(p="/"),c=o(l+1)+" "+p+" "+o(l+3),v.push(o(l+5)+" = "+c);break;case Is:v.push("jmp("+Za(r,l+1)+")");break;case Us:v.push("jmp32("+Ia(r,l+1)+")");break;case Bs:v.push("nobool("+Za(r,l+1)+")");break;case Ls:v.push("noleaf("+Za(r,l+1)+")");break;case Fs:v.push("noop(1)");break;case js:v.push("noop(2)");break;case Ps:v.push("noop(3)");break;case $s:v.push("noop(4)");break;case zs:v.push("stop()");break;default:We("add me [pc="+l+", op="+r[l]+"]")}var _=Xa(r,l,h);(1!==n||a)&&v.push("[90m"+_+"b ("+l+" ~ "+(l+_)+") -> 0x   "+[].concat(_toConsumableArray(r.slice(l,l+Math.min(_,100)))).map(function(r){return(r<16?"0":"")+r.toString(16)}).join(" ")+(_>100?"... (trunced)":"")+"[0m"),l+=_}return 1===n?v.join("\n"):" ## ML Debug:\n"+v.join("\n")+"\n ## End of ML Debug"+(e||l<r.length?e?" (did not start at begin of ml!)":" (did not list all ops, ml at "+l+" / "+r.length+"))...":"")+"\n"}function xi(r,e,n){var t=Je();t.error("\nThere was an ML related error;",n);var a=r.slice(Math.max(0,e-30),e),i=r.slice(e,e+20);t.error("ML at error (offset="+e+"/"+r.length+"):",a,i),t.error("->",yi(r,e,1,void 0,!0,!0)),We(n)}function _i(r,e,n){wi(r,e,n)}function wi(r,e,n){if(!(n<=1)){Ni(r,e,n);for(var t=n-1;t>0;)Ci(r,e,e+2*t),Di(r,e,0,--t)}}function Si(r){return Math.floor((r-1)/2)}function Ei(r){return 2*r+1}function Ai(r){return 2*r+2}function Ni(r,e,n){for(var t=Si(n-1);t>=0;)Di(r,e,t,n-1),--t}function Di(r,e,n,t){for(var a=n,i=ri(r,e+2*a),o=Ei(a);o<=t;){var u=ri(r,e+2*o),s=a,f=i;f<u&&(s=o,f=u);var c=Ai(a);if(c<=t){var v=ri(r,e+2*c);f<v&&(s=c,f=v)}if(s===a)return;ti(r,e+2*a,f),ti(r,e+2*s,i),o=Ei(a=s)}}function Ci(r,e,n){var t=ri(r,e);ti(r,e,ri(r,n)),ti(r,n,t)}function Oi(r,e,n,t){function a(r){return x?"$"+r.toString(36)+"$":_?"_"+r+"_":S[r]}function i(r,e){return e>=0?e:a(r)}function o(r,e){return e>=0?"lit("+e+")":U(r)}function s(r){var e=Ma(n,r);return void 0===e?"-":e}function f(){return r[V++]<<8|r[V++]}function c(){return r[V++]<<24|r[V++]<<16|r[V++]<<8|r[V++]}function v(r,e){var t=D(f()),a=N(t),c=u(a);if(c>=0&&e)return!1;if(y){c<0&&(q[t]||(q[t]=[]),q[t].push(R.length),L[t]=(void 0===L[t]?"":L[t]+" ")+r);var v=i(t,c);return v+=" ".repeat(Math.max(45-v.length,3)),v+="# "+o(a,c),v+=" ".repeat(Math.max(110-v.length,3)),v+="# args: "+t,v+=" ".repeat(Math.max(150-v.length,3)),n&&(v+="# counts: "+s(t)+" "),v+=" \n"}return i(t,c)}function l(r,e,n){var t=N(e),a=u(t),i=N(n);return d(r,e,t,a,n,i,u(i))}function d(r,e,t,a,u,f,c){if(y){a<0&&(q[e]||(q[e]=[]),q[e].push(R.length),L[e]=(void 0===L[e]?"":L[e]+" ")+r),c<0&&(q[u]||(q[u]=[]),q[u].push(R.length),L[u]=(void 0===L[u]?"":L[u]+" ")+r);var v=i(e,a)+" "+r+" "+i(u,c);return v+=" ".repeat(Math.max(45-v.length,3)),v+="# "+o(t,a)+" "+r+" "+o(f,c),v+=" ".repeat(Math.max(110-v.length,3)),v+="# args: "+e+", "+u,v+=" ".repeat(Math.max(150-v.length,3)),n&&(v+="# counts: "+s(e)+" "+r+" "+s(u)+" "),v+=" \n"}return i(e,a)+" "+r+" "+i(u,c)+"\n"}function p(r){return h(r,D(f()),D(f()),D(f()))}function h(r,e,n,t){var a=N(e),i=u(a),o=N(n),s=u(o),f=N(t);return g(r,e,a,i,n,o,s,t,f,u(f))}function g(r,e,t,a,u,f,c,v,l,d){if(y){a<0&&(q[e]||(q[e]=[]),q[e].push(R.length),L[e]=(void 0===L[e]?"":L[e]+" ")+r),c<0&&(q[u]||(q[u]=[]),q[u].push(R.length),L[u]=(void 0===L[u]?"":L[u]+" ")+r),d<0&&(q[v]||(q[v]=[]),q[v].push(R.length),L[v]=(void 0===L[v]?"":L[v]+" ")+r);var p=i(v,d)+" = "+i(e,a)+" "+r+" "+i(u,c);return p+=" ".repeat(Math.max(45-p.length,3)),p+="# "+o(l,d)+" = "+o(t,a)+" "+r+" "+o(f,c),p+=" ".repeat(Math.max(110-p.length,3)),p+="# indexes: "+v+" = "+e+" "+r+" "+u,p+=" ".repeat(Math.max(150-p.length,3)),n&&(p+="# counts: "+s(v)+" = "+s(e)+" "+r+" "+s(u)+" "),p+="\n"}return i(v,d)+" = "+i(e,a)+" "+r+" "+i(u,c)+"\n"}function m(r){var e=f();if(2===e){if("all"===r)return l("&",D(f()),D(f()));if("diff"===r)return l("!=",D(f()),D(f()));if("imp"===r)return l("->",D(f()),D(f()));if("lt"===r)return l("<",D(f()),D(f()));if("lte"===r)return l("<=",D(f()),D(f()));if("nall"===r)return l("!&",D(f()),D(f()));if("nimp"===r)return l("!->",D(f()),D(f()));if("same"===r)return l("==",D(f()),D(f()));if("some"===r)return l("|",D(f()),D(f()));if("xnor"===r)return l("!^",D(f()),D(f()));if("xor"===r)return l("^",D(f()),D(f()))}for(var t="",a="",c="",v="",d=0;d<e;++d){var p=D(f()),h=N(p),g=u(h);c+=i(p,g)+" ",y&&(g<0&&(q[p]||(q[p]=[]),q[p].push(R.length),L[p]=(void 0===L[p]?"":L[p]+" ")+r),t+=p+" ",n&&(a+=s(p)+" "),v+=o(h,g)+" ")}if(y){var m=r+"( "+c+")";return m+=" ".repeat(Math.max(45-m.length,3)),m+="# "+r+"( "+v+") ",m+=" ".repeat(Math.max(110-m.length,3)),m+="# indexes: "+t,m+=" ".repeat(Math.max(150-m.length,3)),n&&(m+="# counts: "+r+"( "+a+")"),m+="\n"}return r+"( "+c+")\n"}function b(r){return k(r,f())}function k(r,e){if(2===e){if("diff?"===r)return h("!=?",D(f()),D(f()),D(f()));if("same?"===r)return h("==?",D(f()),D(f()),D(f()));if("sum"===r)return h("+",D(f()),D(f()),D(f()));if("product"===r)return h("*",D(f()),D(f()),D(f()))}for(var t="",a="",c="",v="",l=0;l<e;++l){var d=D(f()),p=N(d),g=u(p);c+=i(d,g)+" ",y&&(g<0&&(q[d]||(q[d]=[]),q[d].push(R.length),L[d]=(void 0===L[d]?"":L[d]+" ")+r),t+=d+" ",n&&(a+=s(d)+" "),v+=o(p,g)+" ")}var m=D(f()),b=N(m),k=u(b);if(y){k<0&&(q[m]||(q[m]=[]),q[m].push(R.length),L[m]=(void 0===L[m]?"":L[m]+" ")+r);var x=i(m,k)+" = "+r+"( "+c+")";return x+=" ".repeat(Math.max(45-x.length,3)),x+="# "+o(b,k)+" = "+r+"( "+v+") ",x+=" ".repeat(Math.max(110-x.length,3)),x+="# indexes: "+m+" = "+t,x+=" ".repeat(Math.max(150-x.length,3)),n&&(x+="# counts: "+s(m)+" = "+r+"( "+a+")"),x+="\n"}return i(m,k)+" = "+r+"( "+c+")\n"}var y=!!t.debugDsl,x=!!t.hashNames,_=!!t.indexNames,w=!!t.groupedConstraints,S=e.varNames,E=e.domains,A=e.valdist,N=e.getDomain,D=e.getAlias,C=e.solveStack,O=e.targeted,V=0,M="",T=r.length,R=[],q=[],L=[],B=0;if(function(){for(;V<T;){var e=V,n=r[V++],t="";switch(n){case vs:case zs:case Bs:case Ls:case Fs:case js:case Ps:case $s:case Is:case Us:break;default:++B}switch(n){case vs:if(1!==V)return We(" ! ml2dsl compiler problem @",e);break;case zs:return;case Is:var a=f();a<=0&&We("Must jump some bytes"),V+=a;break;case Us:var i=c();i<=0&&We("Must jump some bytes"),V+=i;break;case hs:t=m("lt");break;case gs:t=m("lte");break;case ws:t=m("xor");break;case ps:t=m("imp");break;case bs:t=m("nimp");break;case ls:t=m("all");break;case ds:t=m("diff");break;case ms:t=m("nall");break;case ks:t=m("none");break;case ys:t=m("same");break;case xs:t=m("some");break;case _s:t=m("xnor");break;case As:t=p("<?");break;case Ns:t=p("<=?");break;case Ss:t=b("all?");break;case Es:t=b("diff?");break;case Ds:t=b("nall?");break;case Cs:t=b("none?");break;case Os:t=b("same?");break;case Vs:t=b("some?");break;case Rs:t=p("-");break;case qs:t=p("/");break;case Ms:t=b("sum");break;case Ts:t=b("product");break;case Bs:var o=v("<debug>",!0);!1!==o&&(t="@custom nobool "+o+"\n");break;case Ls:var u=v("<debug>",!0);!1!==u&&(t="@custom noleaf "+u+"\n");break;case Fs:V=e+1;break;case js:V=e+2;break;case Ps:V=e+3;break;case $s:V=e+4;break;default:xi("(m2d) unknown op",V," at",V)}R.push(t)}}(),y){var I=[],F=0,j=0,P=0,$=0;E.forEach(function(r,e){var t="";if(!1===r||n&&!s(e))u(r=N(e))>=0?++P:++j;else{++F,++$,t=": "+a(e)+" ["+te(r)+"]";var i=A[e];if(i)switch(i.valtype){case"max":case"mid":case"min":case"naive":t+=" @"+i.valtype;break;case"list":t+=" @"+i.valtype,t+=" prio("+i.list+")";break;case"markov":t+=" # skipping markov dist (no longer supported)";break;case"minMaxCycle":case"splitMax":case"splitMin":default:We("unknown var dist ["+i.valtype+"] "+JSON.stringify(i))}}I[e]=t});var z=E.map(function(r,e){if(!1===E[e])return"";var t=s(e);if(!t)return"";var a=I[e],i=L[e].split(/ /g).sort().join(" ");return a+" # T:"+O[e]+"  # ocounts: "+t+(x||!_?"  # index = "+e:"")+"  # ops ("+(i.replace(/[^ ]/g,"").length+1)+"): "+i+" $ meta: "+La(n,e)+(w&&q[e]?"\n ## "+q[e].map(function(r){return R[r]}).join(" ## "):"")}).filter(function(r){return!!r}).join("\n");M="\n# Constraints: "+B+" x\n# Vars: "+E.length+" x\n#   Aliases: "+j+" x\n#   Domained: "+F+" x\n#    - Solved: "+P+" x\n#    - Unsolved: "+$+" x\n#    - Solve stack: "+C.length+" x (or "+(C.length-j)+" x without aliases)\n",Je().error(M),M+="\n# Var decls:\n"+z+"\n\n"}else M+="# vars ("+E.length+"x total):\n",M+=E.map(function(r,e){return[r,e]}).filter(function(r){return!1!==r[0]}).filter(function(r){return!n||s(r[1])>0}).map(function(r){return": "+a(r[1])+" ["+te(r[0])+"]"}).join("\n"),M+="\n\n";return M+="\n# Constraints ("+R.length+"x):\n"+R.join(""),M+="\n# Meta:\n"+function(){for(var r=[],n=e.targeted,t=E.length,i=0,o=0,u=0;u<t;++u)!1!==E[u]&&s(u)&&(++i,n[u]?r.push(a(u)):++o);return"@custom targets"+(o&&o.length?"( "+r.join(" ")+" )":" all")+" # "+(i-o)+" / "+i+"\n"}()}function Vi(r,e,n,t,a,i,o,s,f,c,v,l,d,p,h){"number"==typeof c&&(v=c,c=void 0);var g=void 0,m=u(v="number"==typeof v?Yr(v):void 0===v?Kr(Zi,ro):ke(v));if("string"==typeof c||m<0||d){var b=void 0===c;b?c="__"+o():"_"===c[0]&&"_"===c[1]&&c==="__"+parseInt(c.slice(2),10)&&We("Dont use `__xxx` as var names, that structure is preserved for internal/anonymous var names");var k=rn(r,c,g=e.length);k>=0&&(h&&h("CONSTRAINT_VARS_SHOULD_BE_DECLARED; Dont declare a var ["+c+"] after using it",c,k),We("CONSTRAINT_VARS_SHOULD_BE_DECLARED; Dont declare a var ["+c+"] after using it",c,k)),e.push(c),n.push(v),s[g]=!b&&!f()}if(m>=0&&!d){var y=Ui(a,m);g>=0&&i(g,y,"$addvar"),g=y}if(l)switch(t[g]=l,l.valtype){case"list":case"max":case"mid":case"min":case"minMaxCycle":case"naive":case"splitMax":case"splitMin":break;default:h&&h("implement me (var mod ["+l.valtype+"])"),We("implement me (var mod ["+l.valtype+"])")}return p?g:d?c:void 0}function Mi(r,e,n,t,a){var i=un(r,n);return!a&&i<0&&We("cant use this on constants or vars that have not (yet) been declared",n,i),!t&&i>=0&&(i=e(i)),i}function Ti(r,e,n,t,a,i,o,u){n[i]!==o&&(n[i]=o,r[i]=!1,!e[o]&&e[i]&&(e[o]=e[i]))}function Ri(r,e){for(var n=r[e];void 0!==n;)n===e&&We("alias is itself?",n,e),n=r[e=n];return e}function qi(r,e,n,t,a){a||(t=n(t));var i=e[t];return void 0!==i?Yr(i):r[t]}function Li(r,e,n,t,a,i,o,s,f,c){if(!o){if(f)return;We("Cannot set to empty domain")}var v=u(o);return v>=0?Bi(e,t,i,v):Ii(r,e,n,a,i,o,s)}function Bi(r,e,n,t){if(void 0!==r[n]){if(r[n]===t)return;We("Cant update a constant (only to an empty domain, which should be handled differently)")}e(n,Ui(r,t),"$setDomain; because var is now constant "+t)}function Ii(r,e,n,t,a,i,o){o?n[a]=void 0:a=t(a),a<r.length&&(r[a]=i)}function Ui(r,e){var n=r["v"+e];return n>=0?n:(n=nf-r._count++,r["v"+e]=n,r[n]=e,n)}function Fi(){var r=0,e=[],n=Ge(),t=[],a={_count:0},i={},o=[],u=[],s=[],f=Ti.bind(void 0,t,s,i,o,a),c=Ri.bind(void 0,i),v=Mi.bind(void 0,n,c),l=[],d=!1;return{varTrie:n,varNames:e,domains:t,valdist:s,aliases:i,solveStack:o,leafs:u,input:{varstrat:"default",valstrat:"default",dsl:""},ml:void 0,mapping:void 0,addVar:Vi.bind(void 0,n,e,t,s,a,f,function(e){return++r},l,function(r){return d}),getVar:v,name2index:v,addAlias:f,getAlias:c,getDomain:qi.bind(void 0,t,a,c),setDomain:Li.bind(void 0,t,a,i,f,c),isConstant:function(r){return void 0!==a[r]},freezeTargets:function(r){d&&We("Only one `targets` directive supported"),d=!0,l.fill(!1),r.forEach(function(r){return l[v(r,!0)]=!0})},targeted:l}}var ji=0,Pi=2,$i=Math.min,zi=Math.max,Hi=Math.floor,Ji=Math.ceil,Wi=2,Gi=4,Qi=0,Xi="",Yi=void 0,Ki=void 0,Zi=0,ro=1e8,eo=-1,no=0,to=1,ao=2,io=Math.min(0,Zi)-1,oo=2,uo=30,so=1<<31>>>0,fo=0,co=1,vo=2,lo=3,po=console,ho="function"==typeof require?function(r){return require("util").inspect(r,!1,null).replace(/\n ?/g," ")}:function(r){return r},go=0,mo=10,bo=mo+1,ko=16384,yo=4096,xo=-1,_o=void 0,wo=8,So=16,Eo=32,Ao=64,No=0,Do=1,Co=void 0,Oo=1,Vo=2,Mo=3,To=function(){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,r),this._class="fdo",e.logger&&He(e.logger),this.logging=e.log||no,this.distribute=e.distribute||"naive",e.config){var n=this.config=e.config;if(n.initialDomains)for(var t=n.initialDomains,a=0,i=t.length;a<i;++a){var o=t[a];0===o.length&&(o=re()),t[a]=pe(o)}n._propagators&&(n._propagators=void 0),n._varToPropagators&&(n._varToPropagators=void 0)}else this.config=ln();this.solutions=[],this.state={space:null,more:!1},this._prepared=!1}return _createClass(r,[{key:"num",value:function(r){"number"!=typeof r&&We("FDO#num: expecting a number, got "+r+" (a "+(void 0===r?"undefined":_typeof(r))+")"),isNaN(r)&&We("FDO#num: expecting a number, got NaN");var e=kn(this.config,r);return this.config.allVarNames[e]}},{key:"decl",value:function(r,e,n,t,a){""===r&&We("Var name can not be the empty string");var i=void 0;(i="number"==typeof e?[e,e]:e||[Zi,ro]).length||t||We("EMPTY_DOMAIN_NOT_ALLOWED");var o=bn(this.config,r||!0,i,t,a);return r=this.config.allVarNames[o],n&&(n.distribute&&We("Use `valtype` to set the value distribution strategy"),wn(this.config,"varValueStrat",n,r)),r}},{key:"decls",value:function(r,e,n){for(var t=0,a=r.length;t<a;++t)this.decl(r[t],e,n)}},{key:"declRange",value:function(r,e,n,t){return this.decl(r,[e,n],t)}},{key:"plus",value:function(r,e,n){return Nn(this.config,"plus",[r,e,n])}},{key:"minus",value:function(r,e,n){return Nn(this.config,"min",[r,e,n])}},{key:"mul",value:function(r,e,n){return Nn(this.config,"ring-mul",[r,e,n])}},{key:"div",value:function(r,e,n){return Nn(this.config,"ring-div",[r,e,n])}},{key:"sum",value:function(r,e){return Nn(this.config,"sum",r,e)}},{key:"product",value:function(r,e){return Nn(this.config,"product",r,e)}},{key:"distinct",value:function(r){Nn(this.config,"distinct",r)}},{key:"eq",value:function(r,e){if(r instanceof Array)for(var n=0,t=r.length;n<t;++n)this.eq(r[n],e);else if(e instanceof Array)for(var a=0,i=e.length;a<i;++a)this.eq(r,e[a]);else Nn(this.config,"eq",[r,e])}},{key:"neq",value:function(r,e){if(r instanceof Array)for(var n=0,t=r.length;n<t;++n)this.neq(r[n],e);else if(e instanceof Array)for(var a=0,i=e.length;a<i;++a)this.neq(r,e[a]);else Nn(this.config,"neq",[r,e])}},{key:"gte",value:function(r,e){Nn(this.config,"gte",[r,e])}},{key:"lte",value:function(r,e){Nn(this.config,"lte",[r,e])}},{key:"gt",value:function(r,e){Nn(this.config,"gt",[r,e])}},{key:"lt",value:function(r,e){Nn(this.config,"lt",[r,e])}},{key:"isNeq",value:function(r,e,n){return Nn(this.config,"reifier",[r,e,n],"neq")}},{key:"isEq",value:function(r,e,n){return Nn(this.config,"reifier",[r,e,n],"eq")}},{key:"isGte",value:function(r,e,n){return Nn(this.config,"reifier",[r,e,n],"gte")}},{key:"isLte",value:function(r,e,n){return Nn(this.config,"reifier",[r,e,n],"lte")}},{key:"isGt",value:function(r,e,n){return Nn(this.config,"reifier",[r,e,n],"gt")}},{key:"isLt",value:function(r,e,n){return Nn(this.config,"reifier",[r,e,n],"lt")}},{key:"solve",value:function(){var r=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.logging=void 0===e.log?this.logging:e.log,t=e.max||1e3;this._prepare(e,n);var a=void 0;if((e._tostring||e._debug||e._debugConfig||e._debugSpace||e._debugSolver)&&(a=function(n){return(0|e._debugDelay)>=n&&(e._tostring&&Je().log(it(r.config)),e._debug&&r._debugLegible(),e._debugConfig&&r._debugConfig(),e._debugSolver&&r._debugSolver(),!0)})(0)&&(a=void 0),!e._nosolve)return this._run(t,n,a),this.solutions}},{key:"_prepare",value:function(r,e){e>=to&&(Je().log("      - FD Preparing..."),Je().time("      - FD Prepare Time")),this._prepareConfig(r,e);var n=la(this.config);this.state.space=n,this.state.more=!0,this.state.stack=[],this._prepared=!0,e>=to&&Je().timeEnd("      - FD Prepare Time")}},{key:"_prepareConfig",value:function(r,e){var n=this.config;r.vars&&"all"!==r.vars&&wn(n,"targeted_var_names",r.vars),r.beforeSpace&&wn(n,"beforeSpace",r.beforeSpace),r.afterSpace&&wn(n,"afterSpace",r.afterSpace),qn(n)}},{key:"_run",value:function(r,e,n){this._prepared=!1;var t=this.state,a=void 0;e>=to&&((a=Je()).log("      - FD Var Count: "+this.config.allVarNames.length),a.log("      - FD Targeted: "+("all"===this.config.targetedVars?"all":this.config.targetedVars.length)),a.log("      - FD Constraint Count: "+this.config.allConstraints.length),a.log("      - FD Propagator Count: "+this.config._propagators.length),a.log("      - FD Solving..."),a.time("      - FD Solving Time"));for(var i=!1,o=t.space.vardoms,u=0,s=o.length;u<s;++u)if(wr(o[u])){i=!0,e>=to&&a.log("      - FD: rejected without propagation ("+this.config.allVarNames[u]+" is empty)");break}var f=void 0;i?(e>=to&&a.log("      - FD Input Problem Rejected Immediately"),f=[]):f=vt(t,this.config,r,n),e>=to&&(a.timeEnd("      - FD Solving Time"),a.log("      - FD Solutions: "+f.length)),lt(f,this.config,this.solutions,e)}},{key:"hasVar",value:function(r){return un(this.config._varNamesTrie,r)>=0}},{key:"setValueDistributionFor",value:function(r,e){wn(this.config,"varValueStrat",e,r)}},{key:"branch_from_current_solution",value:function(){return new r({config:pa(this.state.space,this.config)})}},{key:"_debugLegible",value:function(){var r=JSON.parse(JSON.stringify(this.config)),e=r.allVarNames,n=r.targetedVars,t=r.allConstraints,a=r.initialDomains,i=r._propagators;for(var o in r)"_"===o[0]&&"object"===_typeof(r[o])&&(r[o]="<removed>");r.allVarNames="<removed>",r.allConstraints="<removed>",r.initialDomains="<removed>",r.varDistOptions="<removed>","all"!==n&&(r.targetedVars="<removed>");var u=Je();u.log("\n## _debug:\n"),u.log("- config:"),u.log(ho(r)),u.log("- vars ("+e.length+"):"),u.log(e.map(function(r,e){return e+": "+U(a[e])+" "+(r===String(e)?"":" // "+r)}).join("\n")),"all"!==n&&u.log("- targeted vars ("+n.length+"): "+n.join(", ")),u.log("- constraints ("+t.length+" -> "+i.length+"):"),u.log(t.map(function(r,e){return void 0===r.param?e+": "+r.name+"("+r.varIndexes+")      ---\x3e  "+r.varIndexes.map(function(r){return U(a[r])}).join(",  "):"reifier"===r.name?e+": "+r.name+"["+r.param+"]("+r.varIndexes+")      ---\x3e  "+U(a[r.varIndexes[0]])+" "+r.param+" "+U(a[r.varIndexes[1]])+" = "+U(a[r.varIndexes[2]]):e+": "+r.name+"("+r.varIndexes+") = "+r.param+"      ---\x3e  "+r.varIndexes.map(function(r){return U(a[r])}).join(",  ")+" -> "+U(a[r.param])}).join("\n")),u.log("##/\n")}},{key:"_debugSolver",value:function(){var r=Je();r.log("## _debugSolver:\n");var e=this.config,n=e.allVarNames;r.log("# Variables ("+n.length+"x):"),r.log("  index name domain toArr");for(var t=0;t<n.length;++t)r.log("  ",t,":",n[t],":",U(e.initialDomains[t]));var a=e.allConstraints;r.log("# Constraints ("+a.length+"x):"),r.log("  index name vars param");for(var i=0;i<a.length;++i)r.log("  ",i,":",a[i].name,":",a[i].varIndexes.join(","),":",a[i].param);var o=e._propagators;r.log("# Propagators ("+o.length+"x):"),r.log("  index name vars args");for(var u=0;u<o.length;++u)r.log("  ",u,":",o[u].name+("reified"===o[u].name?"("+o[u].arg3+")":""),":",o[u].index1,o[u].index2,o[u].index3,"->",U(e.initialDomains[o[u].index1]),U(e.initialDomains[o[u].index2]),U(e.initialDomains[o[u].index3]));r.log("##")}},{key:"_debugConfig",value:function(){var r=ct(this.config);r.initialDomains=r.initialDomains.map(U),Je().log("## _debugConfig:\n",ho(r))}},{key:"imp",value:function(r,e){this.logging&&(Je().log("      - FD Importing DSL; "+r.length+" bytes"),Je().time("      - FD Import Time:"));var n=dt(r,this,e);return this.logging&&Je().timeEnd("      - FD Import Time:"),n}},{key:"exp",value:function(r,e,n,t){return it(this.config,r.vardoms,e,n,t)}}],[{key:"domainFromList",value:function(r){return h(r)}},{key:"getTerm",value:function(){return Je()}},{key:"setTerm",value:function(r){return He(r)}},{key:"dsl",value:function(){We("FDO.dsl: use FDO.solve()")}},{key:"imp",value:function(){We("FDO.imp: use FDO.solve()")}},{key:"solve",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments[2];n.max||(n.max=1);var a=new r(n).imp(e,t),i=a.solve(n);return n.returnFdo?a:a.config.aborted?"aborted":0===i.length?"rejected":1!==n.max?i:i[0]}}]),r}(),Ro=0,qo=++Ro,Lo=++Ro,Bo=1<<++Ro,Io=1<<++Ro,Uo=1<<++Ro,Fo=1<<++Ro,jo=1<<++Ro,Po=1<<++Ro,$o=1<<++Ro,zo=1<<++Ro,Ho=1<<++Ro,Jo=1<<++Ro,Wo=1<<++Ro,Go=1<<++Ro,Qo=1<<++Ro,Xo=1<<++Ro,Yo=1<<++Ro,Ko=1<<++Ro,Zo=1,ru=20,eu=4,nu=Zo+16,tu=nu+ru*eu,au=0,iu=1,ou=2,uu=0,su=0,fu=38,cu=64,vu=33,lu=58,du=44,pu=10,hu=13,gu=45,mu=47,bu=61,ku=62,yu=35,xu=91,_u=40,wu=60,Su=124,Eu=43,Au=63,Nu=32,Du=93,Cu=41,Ou=39,Vu=42,Mu=9,Tu=94,Ru=48,qu=49,Lu=50,Bu=51,Iu=52,Uu=53,Fu=54,ju=55,Pu=56,$u=57,zu=97,Hu=99,Ju=100,Wu=101,Gu=102,Qu=103,Xu=105,Yu=108,Ku=109,Zu=110,rs=111,es=112,ns=114,ts=115,as=116,is=120,os=122,us=65,ss=98,fs={solve:function(r,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{log:1,vars:"all"};t.logger&&He(t.logger);var a=Je();a.log("<pre>"),a.time("</pre>");var i=za(r,e,n,t);return a.timeEnd("</pre>"),i}},cs=0,vs=cs++,ls=cs++,ds=cs++,ps=cs++,hs=cs++,gs=cs++,ms=cs++,bs=cs++,ks=cs++,ys=cs++,xs=cs++,_s=cs++,ws=cs++,Ss=cs++,Es=cs++,As=cs++,Ns=cs++,Ds=cs++,Cs=cs++,Os=cs++,Vs=cs++,Ms=cs++,Ts=cs++,Rs=cs++,qs=cs++,Ls=cs++,Bs=cs++,Is=cs++,Us=cs++,Fs=cs++,js=cs++,Ps=cs++,$s=cs++,zs=255,Hs=3,Js=5,Ws=7,Gs=3,Qs=Gs+4,Xs=Gs+4+2,Ys=Gs,Ks=Gs+2,Zs=Gs+4,rf=Zs,ef=0,nf=(++ef,++ef,++ef,++ef,++ef,++ef,++ef,++ef,++ef,65535);return{FDO:To,FDP:fs,solve:function(r,e,n){return fs.solve(r,To.solve,e,n)},setTerm:He}}();exports.default=FDQ;