!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(r=r||self).FDQ=e()}(this,function(){"use strict";function r(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function e(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.forEach(function(n){r(e,n,t[n])})}return e}function n(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var t="function"==typeof require?function(r){return require("util").inspect(r,{showHidden:!1,depth:100}).replace(/\n ?/g," ")}:function(r){return""+r},a=console;function i(r){a=function(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.forEach(function(e){n(r,e,t[e])})}return r}({},a,r)}function u(){return a}function o(){for(var r=arguments.length,e=[],n=0;n<r;n++)e[n]=arguments[n];throw Error(e.join(": "))}var f=0,s=1e8,c=-1,v=Math.min(0,f)-1,l=2,d=30,p=1<<31>>>0,m=0,h=1,g=2,b=3;var k=0,y=1,x=2;var _=0,w=2,S=Math.min,E=Math.max,A=Math.floor,N=Math.ceil,D=2,O=4,C=0,V="",j=Rr(0),M=Ir(0,1);function T(r,e,n){return r|(1<<1+(0|n)-(0|e))-1<<e}function q(r,e){return"number"==typeof r?R(r,e):I(r,e)}function R(r,e){return r>=p?function(r,e){return(r^p)===e}(r,e):function(r,e){return!(e<f||e>d)&&0!=(r&1<<e)}(r,e)}function I(r,e){return function(r,e){for(var n=r.length,t=0;t<n;t+=O){var a=P(r,t);if(!(a<=e))break;var i=P(r,t+D);if(i>=e)return t}return c}(r,e)!==c}function L(r){return"number"==typeof r?function(r){return r>=p?U(r):F(r)}(r):B(r)}function U(r){return r^p}function F(r){var e=pr(r);return r===1<<e?e:v}function B(r){if(r.length!==O)return v;var e=P(r,_);return e===P(r,w)?e:v}function P(r,e){return r.charCodeAt(e)<<16|r.charCodeAt(e+1)}function H(r){return String.fromCharCode(r>>>16&65535,65535&r)}function z(r,e){return String.fromCharCode(r>>>16&65535,65535&r,e>>>16&65535,65535&e)}function J(r){return"number"==typeof r?function(r){return r>=p?function(r){return[r^p]}(r):function(r){for(var e=[],n=0;n<d;++n)(r&1<<n>>>0)>0&&e.push(n);return e}(r)}(r):function(r){for(var e=[],n=0,t=r.length;n<t;n+=O)for(var a=P(r,n),i=P(r,n+D);a<=i;++a)e.push(a);return e}(r)}function $(r,e){return"number"==typeof r?function(r,e){return r>=p?function(r,e){var n=r^p;return e.indexOf(n)>=0?n:v}(r,e):function(r,e){for(var n=0;n<e.length;++n){var t=e[n];if(t<=d&&(r&1<<t)>0)return t}return v}(r,e)}(r,e):function(r,e){for(var n=0;n<e.length;n++){var t=e[n];if(I(r,t))return t}return v}(r,e)}function W(r){return r?Gr(r.length===O?r:r=function(r){if(!r)return V;var e=r.length;if(e===O)return r;for(var n=r[_]+r[_+1],t=P(r,w),a=w,i=O;i<e;i+=O){var u=P(r,i),o=P(r,i+D);u<=t+1?o>t&&(t=o,a=i+D):(n+=r[a]+r[a+1]+r[i]+r[i+1],t=o,a=i+D)}return n+r[a]+r[a+1]}(r=function r(e){if(!e)return V;var n=e.length;if(n<=O)return e;var t=P(e,0);var a=P(e,0+D);var i=V;var u=V;for(var o=O;o<n;o+=O){var f=P(e,o);f<t||f===t&&P(e,o+D)<a?i+=e[o]+e[o+1]+e[o+2]+e[o+3]:u+=e[o]+e[o+1]+e[o+2]+e[o+3]}return r(i)+""+e[0]+e[1]+e[0+D]+e[0+D+1]+r(u)}(r))):C}function G(r,e){if(r===e)return r;var n="number"==typeof r,t="number"==typeof e;return n&&t?function(r,e){var n=e>=p;if(r>=p)return n?function(r,e){return r===e?r:C}(r,e):Q(r,e);return n?Q(e,r):function(r,e){return Yr(r&e)}(r,e)}(r,e):n?Y(r,e):t?Y(e,r):function(r,e){var n=r.length,t=e.length;if(0==(n|t))return C;var a=V,i=0,u=0,o=P(r,_),f=P(r,w),s=P(e,_),c=P(e,w);for(;;)if(f<s){if((i+=O)>=n)break;o=P(r,i),f=P(r,i+D)}else if(c<o){if((u+=O)>=t)break;s=P(e,u),c=P(e,u+D)}else{var v=S(f,c);if(a+=z(E(o,s),v),o=s=v+=2,f<v){if((i+=O)>=n)break;o=P(r,i),f=P(r,i+D)}if(c<v){if((u+=O)>=t)break;s=P(e,u),c=P(e,u+D)}}return a===V?C:Gr(a)}(r,e)}function Q(r,e){var n=r^p;return n<=d&&e&1<<n?r:C}function Y(r,e){return r>=p?function(r,e){for(var n=r^p,t=0,a=e.length;t<a;t+=O){var i=P(e,t),u=P(e,t+D);if(n<i)break;if(n<=u)return r}return C}(r,e):function(r,e){for(var n=C,t=0,a=e.length;t<a;t+=O){var i=P(e,t);if(i>d)break;for(var u=P(e,t+D),o=i,f=S(d,u);o<=f;++o){var s=1<<o;r&s&&(n|=s)}}return Yr(n)}(r,e)}function X(r,e){return q(r,e)?Rr(e):Ur()}function K(r){return"number"==typeof r?r>=p?"soldom(["+(r^p)+","+(r^p)+"])":"numdom(["+Hr(r)+"])":"string"==typeof r?"strdom(["+zr(r)+"])":Array.isArray(r)?"arrdom(["+r+"])":"???dom("+r+")"}function Z(r,e){var n;if(r&&e)do{if(n=0,r.length>O){var t=rr(r,er(e));n+=r.length-t.length,r=t}if(e.length>O){var a=rr(e,er(r));n+=e.length-a.length,e=a}}while(0!==n);return[r,e]}function rr(r,e){for(var n=r[_]+r[_+1],t=P(r,w),a=w,i=O,u=r.length;i<u;i+=O){P(r,i)-t>e&&(n+=r[a]+r[a+1]+r[i]+r[i+1]),t=P(r,i+D),a=i+D}return n+=r[a]+r[a+1]}function er(r){for(var e=s,n=0,t=r.length;n<t;n+=O){var a=P(r,n),i=1+P(r,n+D)-a;i<e&&(e=i)}return e}function nr(r,e){return"number"==typeof r&&(r=$r(r)),"number"==typeof e&&(e=$r(e)),function(r,e){for(var n=V,t=0,a=r.length;t<a;t+=O){var i=P(r,t),u=P(r,t+D);n+=tr(e,i,u)}return W(n)}(r,e)}function tr(r,e,n){for(var t=V,a=0,i=r.length;a<i;a+=O){var u=P(r,a),o=P(r,a+D);t+=z(S(s,e*u),S(s,n*o))}return t}function ar(r,e,n){return void 0===n&&(n=!0),"number"==typeof r&&(r=$r(r)),"number"==typeof e&&(e=$r(e)),function(r,e,n){void 0===n&&(n=!0);for(var t=V,a=0,i=e.length;a<i;a+=O){var u=P(e,a),o=P(e,a+D);t+=ir(r,u,o,n)}return W(t)}(r,e,n)}function ir(r,e,n,t){for(var a=V,i=0,u=r.length;i<u;i+=O){var o=P(r,i);if(n>0){var f=e>0?P(r,i+D)/e:s,c=N(o/n),v=A(f);c<=v?a+=z(c,v):t&&(a+=z(v,v))}}return a}function ur(r,e){return"number"==typeof r&&(r=$r(r)),"number"==typeof e&&(e=$r(e)),function(r,e){for(var n=V,t=0,a=e.length;t<a;t+=O){var i=P(e,t),u=P(e,t+D);n+=or(r,i,u)}return W(n)}(r,e)}function or(r,e,n){for(var t=V,a=0,i=r.length;a<i;a+=O){var u=P(r,a),o=e?P(r,a+D)/e:s,c=N(n?u/n:f),v=A(o);c<=v&&(t+=z(c,v))}return t}function fr(r){return"number"==typeof r?function(r){return r>=p?1:function(r){return 0|sr(r)}(r)}(r):cr(r)}var sr=function(){return{_domain_bit_size:function(r){switch(0|(r|=0)){case 0:return 0;case 1:case 2:return 1;case 3:return 2}return((r=(r=(858993459&(r=r-(r>>1&1431655765)|0))+(r>>2&858993459)|0)+(r>>4)&252645135|0)<<24)+(r<<16)+(r<<8)+r>>24|0}}}()._domain_bit_size;function cr(r){for(var e=0,n=0,t=r.length;n<t;n+=O)e+=1+P(r,n+D)-P(r,n);return e}function vr(r){if("number"==typeof r){if(r>=p)return r^p;r=$r(r)}return function(r){if(!r)return v;for(var e,n=cr(r),t=A(n/2),a=0,i=r.length;a<i;a+=O){e=P(r,a);var u=1+P(r,a+D)-e;if(t<u)break;t-=u}return e+t}(r)}function lr(r){return"number"==typeof r?function(r){return r>=p?function(r){return r^p}(r):pr(r)}(r):function(r){return r?P(r,_):v}(r)}var dr=function(r){var e={Math:{clz32:Math.clz32}}.Math.clz32;return{_domain_bit_min:function(r){switch(0|(r|=0)){case 0:return-1;case 1:return 0;case 2:return 1;case 3:return 0}return r|=r<<16,r|=r<<8,r|=r<<4,r|=r<<2,32-e(~(r|=r<<1))|0}}}()._domain_bit_min;function pr(r){return 0|dr(r)}function mr(r){return"number"==typeof r?function(r){return r>=p?function(r){return r^p}(r):function(r){return 0|hr(r)}(r)}(r):function(r){return r?P(r,r.length-D):v}(r)}var hr=function(r){var e={Math:{clz32:Math.clz32}}.Math.clz32;return{_domain_bit_max:function(r){switch(0|(r|=0)){case 0:return-1;case 1:return 0;case 2:case 3:return 1}return 31-e(r)|0}}}()._domain_bit_max;function gr(r){var e=r.length;return 0===e?v:r[e-1]}function br(r){return"number"==typeof r&&r>=p}function kr(r){return r===j}function yr(r){return!xr(r)}function xr(r){return 0===lr(r)}function _r(r){return r===M}function wr(r){return Sr(r)&&2===fr(r)}function Sr(r){return _r(r)||!kr(r)&&xr(r)}function Er(r,e){return e?Vr(r,0):Cr(r,0)}function Ar(r){return r===C}function Nr(r,e){return"number"==typeof r?function(r,e){return r>=p?function(r,e){return(r^p)>=e?C:r}(r,e):Yr(function(r,e){switch(e){case 0:return 0;case 1:return 1&r;case 2:return 3&r;case 3:return 7&r;case 4:return 15&r;case 5:return 31&r;case 6:return 63&r;case 7:return 127&r;case 8:return 255&r;case 9:return 511&r;case 10:return 1023&r;case 11:return 2047&r;case 12:return 4095&r;case 13:return 8191&r;case 14:return 16383&r;case 15:return 32767&r;case 16:return 65535&r;case 17:return 131071&r;case 18:return 262143&r;case 19:return 524287&r;case 20:return 1048575&r;case 21:return 2097151&r;case 22:return 4194303&r;case 23:return 8388607&r;case 24:return 16777215&r;case 25:return 33554431&r;case 26:return 67108863&r;case 27:return 134217727&r;case 28:return 268435455&r;case 29:return 536870911&r;case 30:return 1073741823&r}return r}(r,e))}(r,e):function(r,e){for(var n=0,t=r.length;n<t;n+=O){var a=P(r,n),i=P(r,n+D);if(a>=e)return n?Gr(r.slice(0,n)):C;if(e<=i){if(0===n&&e===a+1){var u=r.slice(0,D);return Gr(u+u)}var o=r.slice(0,n+D)+H(e-1);return Gr(o)}}return r}(r,e)}function Dr(r,e){return"number"==typeof r?function(r,e){return r>=p?function(r,e){return(r^p)<=e?C:r}(r,e):Gr(function(r,e){switch(e){case 0:return 2147483646&r;case 1:return 2147483644&r;case 2:return 2147483640&r;case 3:return 2147483632&r;case 4:return 2147483616&r;case 5:return 2147483584&r;case 6:return 2147483520&r;case 7:return 2147483392&r;case 8:return 2147483136&r;case 9:return 2147482624&r;case 10:return 2147481600&r;case 11:return 2147479552&r;case 12:return 2147475456&r;case 13:return 2147467264&r;case 14:return 2147450880&r;case 15:return 2147418112&r;case 16:return 2147352576&r;case 17:return 2147221504&r;case 18:return 2146959360&r;case 19:return 2146435072&r;case 20:return 2145386496&r;case 21:return 2143289344&r;case 22:return 2139095040&r;case 23:return 2130706432&r;case 24:return 2113929216&r;case 25:return 2080374784&r;case 26:return 2013265920&r;case 27:return 1879048192&r;case 28:return 1610612736&r;case 29:return 1073741824&r;case 30:return 0}return e<0?r:0}(r,e))}(r,e):function(r,e){for(var n=0,t=r.length;n<t;n+=O){var a=P(r,n),i=P(r,n+D);if(a>e)return Gr(n?r.slice(n):r);if(i===e)return n>=t-O?C:Gr(r.slice(n+O));if(e<=i)return Gr(H(e+1)+r.slice(n+D))}return C}(r,e)}function Or(r,e){return e<=f?r:e>s?Ur():Dr(r,e-1)}function Cr(r,e){return e>=s?r:e<f?Ur():Nr(r,e+1)}function Vr(r,e){return"number"==typeof r?function(r,e){return r>=p?function(r,e){return e===(r^p)?C:r}(r,e):function(r,e){if(e>30)return Gr(r);var n=1<<e;return Yr((r|n)^n)}(r,e)}(r,e):Gr(function(r,e){for(var n=-1,t=-1,a=0,i=r.length;a<i;a+=O){var u=P(r,a);if(e<u)break;var o=P(r,a+D);if(e<=o)return jr(r,i,a,u,o,e,n,t);n=u,t=o}return r}(r,e))}function jr(r,e,n,t,a,i,u,o){if(e===O){if(a-t==1)return((t===i?a:t)|p)>>>0;if(t===a)return C}else if(n&&e===2*O&&t===a&&u===o)return(u|p)>>>0;if(n===e-O&&i===a){if(t===a&&o<=d){var f=e-O;return Xr(r.slice(0,f),f)}if(a-1<=d)return Xr(r.slice(0,-D)+H(a-1),e)}var s=r.slice(0,n),c=r.slice(n+O);return a===i?t===i?s+c:s+z(t,a-1)+c:t===i?s+z(t+1,a)+c:s+z(t,i-1)+z(i+1,a)+c}function Mr(r,e){var n="number"==typeof r,t="number"==typeof e;return n&&t?function(r,e){if(r>=p)return e>=p?function(r,e){return r!==e}(r,e):Tr(r,e);return e>=p?Tr(e,r):function(r,e){return 0==(r&e)}(r,e)}(r,e):n?qr(r,e):t?qr(e,r):function(r,e){var n=r.length,t=e.length,a=0,i=0,u=P(r,_),o=P(r,w),f=P(e,_),s=P(e,w);for(;;)if(o<f){if((a+=O)>=n)break;u=P(r,a),o=P(r,a+D)}else{if(!(s<u))return!1;if((i+=O)>=t)break;f=P(e,i),s=P(e,i+D)}return!0}(r,e)}function Tr(r,e){var n=r^p;return n>d||0==(e&1<<n)}function qr(r,e){return r>=p?function(r,e){for(var n=r^p,t=0,a=e.length;t<a;t+=O){var i=P(e,t),u=P(e,t+D);if(n<i)return!0;if(n<=u)return!1}return!0}(r,e):function(r,e){for(var n=0,t=e.length,a=0;a<=d;++a)if(r&1<<a){for(;n<t;){var i=P(e,n),u=P(e,n+D);if(a>=i&&a<=u)return!1;if(i>d)return!0;if(i>a)break;n+=O}if(n>=t)return!0}return!0}(r,e)}function Rr(r){return(r|p)>>>0}function Ir(r,e){return r===e?Rr(r):e<=d?Lr(r,e):z(r,e)}function Lr(r,e){return(1<<1+e-r)-1<<r}function Ur(){return C}function Fr(r){return 0===r?Rr(0):1===r?Ir(0,1):Kr([0,0,r,r])}function Br(r){return r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16}function Pr(r,e){return"number"==typeof r?Hr(r):"string"==typeof r?zr(r):e?r.slice(0):r}function Hr(r){return r>=p?function(r){var e=r^p;return[e,e]}(r):function(r){if(r===C)return[];var e=[],n=-1,t=-1;1&r&&(n=0,t=0);2&r&&(0!==n&&(n=1),t=1);4&r&&(0===t?(e.push(0,0),n=2):1!==t&&(n=2),t=2);8&r&&(t<0?n=3:2!==t&&(e.push(n,t),n=3),t=3);if(r>=16)for(var a=4;a<=d;++a)r&1<<a&&(t<0?n=a:t!==a-1&&(e.push(n,t),n=a),t=a);return e.push(n,t),e}(r)}function zr(r){if(r===C)return[];for(var e=[],n=0,t=r.length;n<t;n+=O){e.push(P(r,n),P(r,n+D))}return e}function Jr(r){return"number"==typeof r?$r(r):"string"==typeof r?r:Wr(r)}function $r(r){return r>=p?function(r){var e=r^p;return z(e,e)}(r):function(r){if(r===C)return V;var e=V,n=-1,t=-1;1&r&&(n=0,t=0);2&r&&(0!==n&&(n=1),t=1);4&r&&(0===t?(e=z(0,0),n=2):1!==t&&(n=2),t=2);8&r&&(t<0?n=3:2!==t&&(e+=z(n,t),n=3),t=3);if(r>=16)for(var a=4;a<=d;++a)r&1<<a&&(t<0?n=a:t!==a-1&&(e+=z(n,t),n=a),t=a);return e+=z(n,t)}(r)}function Wr(r){for(var e=V,n=0,t=r.length;n<t;n+=l){e+=z(r[n],r[n+1])}return e}function Gr(r){return"number"==typeof r?function(r){return r>=p?r:Yr(r)}(r):function(r){var e=r.length;if(!e)return C;var n=P(r,0),t=P(r,e-D);if(e===O&&n===t)return Rr(n);return t<=d?Xr(r,e):r}(r)}function Qr(r){return Array.isArray(r)&&(r=Wr(r)),Gr(r)}function Yr(r){var e=L(r);return e===v?r:Rr(e)}function Xr(r,e){if(0===e)return C;for(var n=T(C,P(r,0),P(r,0+D)),t=O;t<e;t+=O){n=T(n,P(r,t),P(r,t+D))}return n}function Kr(r){var e=r.length;return 0===e?C:e===l&&r[0]===r[1]?Rr(r[0]):gr(r)<=d?function(r,e){for(var n=0,t=0;t<e;t+=l)n=T(n,r[t],r[t+1]);return n}(r,e):Wr(r)}var Zr=Math.min;function re(r,e){if(!r||!e)return C;var n,t="number"==typeof r,a="number"==typeof e;if(t&&a){if(function(r,e){return mr(r)+mr(e)<=d}(r,e))return Gr(function(r,e){if(r>=p){var n=r^p;return ee(n,n,e)}var t=0;for(;0==(r&1<<t);)++t;var a=t,i=t,u=1<<++t,o=C;for(;u<=r&&t<=d;)(u&r)>0&&(i!==t-1&&(o|=ee(a,i,e),a=t),i=t),u=1<<++t;return o|ee(a,i,e)}(r,e));n=function(r,e){if(r>=p){var n=r^p;return te(n,n,e)}var t=0;for(;0==(r&1<<t);)++t;var a=t,i=t,u=1<<++t,o=V;for(;u<=r&&t<=d;)(u&r)>0&&(i!==t-1&&(o+=te(a,i,e),a=t),i=t),u=1<<++t;return o+te(a,i,e)}(r,e)}else n=t?ne(r,e):a?ne(e,r):function(r,e){var n=Z(r,e);e=n[1];for(var t=V,a=0,i=(r=n[0]).length;a<i;a+=O){var u=P(r,a),o=P(r,a+D);t+=ae(u,o,e)}return t}(r,e);return Gr(W(n))}function ee(r,e,n){if(n>=p){var t=n^p;return ue(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,u=a,o=1<<++a,f=C;o<=n&&a<=d;)(o&n)>0&&(u!==a-1&&(f|=ue(r,e,i,u),i=a),u=a),o=1<<++a;return f|ue(r,e,i,u)}function ne(r,e){if(r>=p){var n=r^p;return ae(n,n,e)}for(var t=0;0==(r&1<<t);)++t;for(var a=t,i=t,u=1<<++t,o=V;u<=r&&t<=d;)(u&r)>0&&(i!==t-1&&(o+=ae(a,i,e),a=t),i=t),u=1<<++t;return o+ae(a,i,e)}function te(r,e,n){if(n>=p){var t=n^p;return ie(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,u=a,o=1<<++a,f=V;o<=n&&a<=d;)(o&n)>0&&(u!==a-1&&(f+=ie(r,e,i,u),i=a),u=a),o=1<<++a;return f+ie(r,e,i,u)}function ae(r,e,n){for(var t=V,a=0,i=n.length;a<i;a+=O){t+=ie(r,e,P(n,a),P(n,a+D))}return t}function ie(r,e,n,t){var a=r+n;return a<=s?z(a,Zr(s,e+t)):V}function ue(r,e,n,t){return Lr(r+n,e+t)}var oe=Math.max;function fe(r,e){if(!r||!e)return C;if(0===lr(r)&&0===lr(e))return Ir(0,mr(r));var n="number"==typeof e;if("number"==typeof r){if(n)return Gr(function(r,e){if(r>=p){var n=r^p;if(e>=p){var t=n-(e^p);return t<0?C:Rr(t)}return n<=d?se(n,n,e):ce(n,n,e)}return function(r,e){if(R(r,0)&&R(e,0))return Br(r);var n=0;for(;0==(r&1<<n);)++n;var t=n,a=n,i=1<<++n,u=C;for(;i<=r&&n<=d;)(i&r)>0&&(a!==n-1&&(u|=se(t,a,e),t=n),a=n),i=1<<++n;return u|se(t,a,e)}(r,e)}(r,e));var t=Gr(function(r,e){if(r>=p){var n=r^p;return n<=d?le(n,n,e):ve(n,n,e)}return function(r,e){if(r>=p){var n=r^p;return le(n,n,e)}if(R(r,0)&&0===lr(e))return Br(r);var t=0;for(;0==(r&1<<t);)++t;var a=t,i=t,u=1<<++t,o=C;for(;u<=r&&t<=d;)(u&r)>0&&(i!==t-1&&(o|=le(a,i,e),a=t),i=t),u=1<<++t;return o|le(a,i,e)}(r,e)}(r,e));return t===V?C:t}var a=Gr(W(n?function(r,e){if(0===lr(r)&&0===lr(e))return Ir(0,mr(r));for(var n=V,t=0,a=r.length;t<a;t+=O){var i=P(r,t),u=P(r,t+D);n+=ce(i,u,e)}return n}(r,e):function(r,e){var n=Z(r,e);e=n[1];for(var t=V,a=0,i=(r=n[0]).length;a<i;a+=O){var u=P(r,a),o=P(r,a+D);t+=ve(u,o,e)}return t}(r,e)));return a===V?C:a}function se(r,e,n){if(n>=p){var t=n^p;return pe(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,u=a,o=1<<++a,f=C;o<=n&&a<=d;)(o&n)>0&&(u!==a-1&&(f|=pe(r,e,i,u),i=a),u=a),o=1<<++a;return f|pe(r,e,i,u)}function ce(r,e,n){if(n===C)return C;if(n>=p){var t=n^p;return de(r,e,t,t)}for(var a=0;0==(n&1<<a);)++a;for(var i=a,u=a,o=1<<++a,f=V;o<=n&&a<=d;)(o&n)>0&&(u!==a-1&&(f+=de(r,e,i,u),i=a),u=a),o=1<<++a;return f+de(r,e,i,u)}function ve(r,e,n){for(var t=V,a=0,i=n.length;a<i;a+=O){t+=de(r,e,P(n,a),P(n,a+D))}return t}function le(r,e,n){for(var t=C,a=0,i=n.length;a<i;a+=O){t|=pe(r,e,P(n,a),P(n,a+D))}return t}function de(r,e,n,t){var a=e-n;return a>=f?z(oe(f,r-t),a):V}function pe(r,e,n,t){var a=e-n;return a>=f?Lr(oe(f,r-t),a):C}var me=0,he=10,ge=he+1,be=16384,ke=4096,ye=-1,xe=void 0,_e=8,we=16,Se=32,Ee=64;function Ae(r,e,n){var t=0|e||be,a=Math.max(Ce(t),0|n),i={_class:"$trie",buffer:Ne(t,a),bits:a,lastNode:me,count:0};if(r)for(var u=0,o=r.length;u<o;++u)Ve(i,r[u],u);return i}function Ne(r,e){switch(e){case _e:return new Uint8Array(r);case we:return new Uint16Array(r);case Se:return new Uint32Array(r);case Ee:return new Float64Array(r);default:o("Unsupported bit size")}}function De(r){var e=r.buffer.length,n=~~(1.1*e);e+ke>n&&(n=ke+e),Oe(r,n)}function Oe(r,e){r.bits=Math.max(r.bits,Ce(e));var n=Ne(e,r.bits);n.set(r.buffer,0),r.buffer=n}function Ce(r){return r<256?_e:r<65536?we:r<4294967296?Se:Ee}function Ve(r,e,n){return Me(r,n),function r(e,n,t,a,i,u){if(a>=i){var o=e.buffer,f=n+he,s=e.buffer[f];return s||++e.count,o[f]=u+1,s-1}var c=t.charCodeAt(a)-32;n=Te(e,n,c%10);n=Te(e,n,Math.floor(c/10));return r(e,n,t,a+1,i,u)}(r,me,e,0,e.length,n)}function je(r,e,n){return Me(r,n),function r(e,n,t,a){if(0===t){var i=e.buffer,u=n+he,o=e.buffer[u];return o||++e.count,i[u]=a+1,o-1}n=Te(e,n,t%10);t=Math.floor(t/10);return r(e,n,t,a)}(r,me,e+1,n)}function Me(r,e){var n=Ce(e);n>r.bits&&(r.bits=n,Oe(r,r.buffer.length))}function Te(r,e,n){var t=r.buffer[e+=n];return t||(t=function(r){var e=r.lastNode+ge;for(r.lastNode=e;e+ge>=r.buffer.length;)De(r);return e}(r),r.buffer[e]=t),t}function qe(r,e){return function r(e,n,t,a,i){var u=e.buffer;if(a>=i){var o=n+he;return u[o]-1}var f=t.charCodeAt(a)-32;n=u[n+f%10];if(!n)return ye;n=u[n+Math.floor(f/10)];if(!n)return ye;return r(e,n,t,a+1,i)}(r,me,e,0,e.length)}function Re(r,e){return qe(r,e)!==ye}function Ie(r,e){return function r(e,n,t){var a=e.buffer;if(0===t){var i=n+he;return a[i]-1}n=a[n+t%10];if(!n)return ye;t=Math.floor(t/10);return r(e,n,t)}(r,me,e+1)}function Le(r,e,n){return{_class:"$constraint",name:r,varIndexes:e,param:n}}function Ue(r,e,n,t,a){r.vardoms[a]=function(r,e,n){var t=ar(r,e);return G(n,t)}(r.vardoms[n],r.vardoms[t],r.vardoms[a])}function Fe(r,e,n){return r?function(r,e){var n;n=r?r.slice(0):[];for(var t=J(e),a=0;a<t.length;++a){var i=t[a];n.indexOf(i)<0&&n.push(i)}return n}(e,n):e}function Be(r,e,n,t){var a=function(r,e){for(var n,t=r.vardoms,a=0;a<e.length;a++){var i=t[(n=e[a])._boolVarIndex];if(void 0===i||1===L(i))break}return n}(r,e).vector;if(null!==n){var i=t-(a=a?a.slice(0):[]).length;if(i>0)for(var u=0;u<i;++u)a.push(n);return a}return a&&a.length===t||o("E_EACH_MARKOV_VAR_MUST_HAVE_PROB_VECTOR_OR_ENABLE_EXPAND_VECTORS"),a}function Pe(r,e,n){var t=r.vardoms[n];if(br(t)){var a=lr(t),i=e.varDistOptions,u=i[e.allVarNames[n]];u&&JSON.stringify(i);var o=u.expandVectorsWith,f=Fe(null!==o,u.legend,t),s=Be(r,u.matrix,o,f.length),c=f.indexOf(a);(c<0||c>=s.length||0===s[c])&&(r.vardoms[n]=Ur())}}function He(r,e,n,t,a){var i=function(r,e,n){var t=fe(r,e);if(!t)return t;return G(n,t)}(r.vardoms[n],r.vardoms[t],r.vardoms[a]);r.vardoms[a]=i}function ze(r,e,n,t,a){var i=r.vardoms;r.vardoms[a]=function(r,e,n){var t=nr(r,e);return G(n,t)}(i[n],i[t],i[a])}function Je(r,e,n,t,a,i,u,o,f,s,c){var v=r.vardoms,l=v[a];if(kr(l))u(r,e,n,t);else if(yr(l))i(r,e,n,t);else{var d=v[n],p=v[t];c(d,p)?(s(d,p),v[a]=Vr(l,0),i(r,e,n,t)):s(d,p)&&(v[a]=Cr(l,0),u(r,e,n,t))}}function $e(r,e,n,t,a,i,u){var o=r.vardoms;r.vardoms[a]=function(r,e,n,t,a){var i=t(r,e);return G(n,i)}(o[n],o[t],o[a],u)}function We(r,e,n,t){var a=r.vardoms[n],i=r.vardoms[t],u=lr(a);r.vardoms[n]=Nr(a,mr(i)),r.vardoms[t]=Dr(i,u)}function Ge(r,e,n,t){return We(r,0,t,n)}function Qe(r,e){return lr(r)>=mr(e)}function Ye(r,e){return Qe(e,r)}function Xe(r,e,n,t){var a=r.vardoms[n],i=r.vardoms[t],u=lr(a);r.vardoms[n]=Nr(a,mr(i)+1),r.vardoms[t]=Dr(i,u-1)}function Ke(r,e,n,t){return Xe(r,0,t,n)}function Ze(r,e){return lr(r)>mr(e)}function rn(r,e){return Ze(e,r)}function en(r,e,n,t){var a=r.vardoms,i=G(a[n],a[t]);a[n]=i,a[t]=i}function nn(r,e){return Mr(r,e)}function tn(r,e,n,t){var a=r.vardoms,i=a[n],u=a[t],o=L(i);o===v?(o=L(u))!==v&&(a[n]=Vr(i,o)):i===u?(a[n]=Ur(),a[t]=Ur()):a[t]=Vr(u,o)}function an(r,e){var n=L(r);return n!==v&&n===L(e)}function un(r,e,n,t,a,i,u,o,f,s,c){return void 0===n&&(n=-1),void 0===t&&(t=-1),void 0===a&&(a=-1),void 0===i&&(i=""),void 0===u&&(u=""),void 0===o&&(o=""),void 0===f&&(f=""),void 0===s&&(s=""),void 0===c&&(c=""),{_class:"$propagator",name:r,stepper:e,index1:n,index2:t,index3:a,arg1:i,arg2:u,arg3:o,arg4:f,arg5:s,arg6:c}}function on(r,e,n){Sn(r,un("eq",en,e,n))}function fn(r,e,n){Sn(r,un("lt",We,e,n))}function sn(r,e,n){Sn(r,un("lte",Xe,e,n))}function cn(r,e,n){Sn(r,un("neq",tn,e,n))}function vn(r,e,n,t,a,i,u,o){ln(r,i,u,o,e,t),ln(r,o,u,i,n,a),ln(r,o,i,u,n,a)}function ln(r,e,n,t,a,i){Sn(r,un("ring",$e,e,n,t,a,i))}function dn(r,e,n,t){vn(r,"plus","min",re,fe,e,n,t)}function pn(r,e,n,t){vn(r,"mul","div",nr,ur,e,n,t)}function mn(r,e){Sn(r,un("markov",Pe,e))}function hn(){return{_class:"$config",allVarNames:[],_varNamesTrie:Ae(),varStratConfig:_n(),valueStratName:"min",targetedVars:"all",varDistOptions:{},beforeSpace:void 0,afterSpace:void 0,rngCode:"",_defaultRng:void 0,allConstraints:[],constantCache:{},initialDomains:[],_propagators:[],_varToPropagators:[],_constrainedAway:[],_constraintHash:{}}}function gn(r,e){var n=r.varStratConfig,t=r.valueStratName,a=r.targetedVars,i=r.varDistOptions,u=r.constantCache,o=r.allVarNames,f=r.allConstraints,s=r.initialDomains,c=r._propagators,v=r._varToPropagators,l=r._constrainedAway;return{_class:"$config",_varNamesTrie:Ae(o),varStratConfig:n,valueStratName:t,targetedVars:Array.isArray(a)?a.slice(0):a,varDistOptions:JSON.parse(JSON.stringify(i)),rngCode:r.rngCode,_defaultRng:r.rngCode?void 0:r._defaultRng,constantCache:u,allVarNames:o.slice(0),allConstraints:f.slice(0),initialDomains:e?e.map(Gr):s,_propagators:c&&c.slice(0),_varToPropagators:v&&v.slice(0),_constrainedAway:l&&l.slice(0),_constraintHash:{}}}function bn(r){return function(r,e){return xn(r,e,Ir(f,s))}(r,!0)}function kn(r,e,n){return e===n?yn(r,e):function(r,e,n,t){return xn(r,e,Ir(n,t))}(r,!0,e,n)}function yn(r,e){return void 0!==r.constantCache[e]?r.constantCache[e]:function(r,e,n){return xn(r,e,Ir(n,n))}(r,!0,e)}function xn(r,e,n,t,a){if(void 0===a&&(a=!1),!a){var i=r.allVarNames.length;!0===e?e="__"+i+"__":("string"!=typeof e&&o("Var names should be a string or anonymous, was: "+JSON.stringify(e)),e||o("Var name cannot be empty string"),parseInt(e,10)+""===e&&o("Don't use numbers as var names ("+e+")")),i<100&&Re(r._varNamesTrie,e)&&o("Var name already part of this config. Probably a bug?",e);var u=L(n);return u===c||r.constantCache[u]||(r.constantCache[u]=i),r.initialDomains[i]=n,r.allVarNames.push(e),Ve(r._varNamesTrie,e,i),i}r.initialDomains[qe(r._varNamesTrie,e)]=n}function _n(r){return{_class:"$var_strat_config",type:r&&r.type||"naive",priorityByName:r&&r.priorityByName,_priorityByIndex:void 0,inverted:!(!r||!r.inverted),fallback:r&&r.fallback}}function wn(r,e,n,t){"varStratOverride"===e&&o("deprecated, should be wiped internally");var a=!1;switch(e){case"varStrategyFallback":a=!0;case"varStrategy":"function"==typeof n&&o("functions no longer supported",n),"string"==typeof n&&o("strings should be passed on as {type:value}",n),"object"!=typeof n&&o("varStrategy should be object",n),n.name&&o("name should be type"),n.dist_name&&o("dist_name should be type");var i=_n(n);if(a){for(var u=r.varStratConfig;u.fallback;)u=u.fallback;u.fallback=i}else for(r.varStratConfig=i;i.fallback;)i.fallback=_n(i.fallback),i=i.fallback;break;case"valueStrategy":r.valueStratName=n;break;case"targeted_var_names":n&&0!==n.length||o("ONLY_USE_WITH_SOME_TARGET_VARS"),r.targetedVars=n;break;case"varStratOverrides":for(var f=0,s=Object.entries(n);f<s.length;f++){var c=s[f];wn(r,"varValueStrat",c[1],c[0])}break;case"varValueStrat":if(r.varDistOptions||(r.varDistOptions={}),r.varDistOptions[t]=n,"markov"===n.valtype){var v=n.matrix;v||(n.expandVectorsWith?(n.matrix=[{vector:[]}],v=n.matrix):o("FDO: markov var missing distribution (needs matrix or expandVectorsWith)"));for(var l=Array.isArray(p=v),d=0,p=l?p:p[Symbol.iterator]();;){var m;if(l){if(d>=p.length)break;m=p[d++]}else{if((d=p.next()).done)break;m=d.value}var h=m;h.boolean&&o("row.boolean was deprecated in favor of row.boolVarName"),void 0!==h.booleanId&&o("row.booleanId is no longer used, please use row.boolVarName");var g=h.boolVarName;"function"==typeof g&&(g=g(n)),g&&("string"!=typeof g&&o("row.boolVarName, if it exists, should be the name of a var or a func that returns that name, was/got: "+g+" ("+typeof g+")"),h._boolVarIndex=qe(r._varNamesTrie,g))}}break;case"beforeSpace":r.beforeSpace=n;break;case"afterSpace":r.afterSpace=n;break;case"var":return o("REMOVED. Replace `var` with `varStrategy`");case"val":return o("REMOVED. Replace `var` with `valueStrategy`");case"rng":"string"==typeof n?r.rngCode=n:"number"==typeof n?r.rngCode="return "+n+";":r._defaultRng=n;break;default:o("unknown option")}}function Sn(r,e){r._propagators.push(e)}function En(r,e,n,t){br(e[r])||(n[r]?n[r].indexOf(t)<0&&n[r].push(t):n[r]=[t])}function An(r,e,n,t){n.every(function(r){return"string"==typeof r||"number"==typeof r||void 0===r});var a,i=e,u=!1;switch(e){case"reifier":u=!0,i=t;case"plus":case"min":case"ring-mul":case"ring-div":case"mul":case"sum":case"product":var f,s="product"===e||"sum"===e;void 0===(a=s?t:n[2])?(f=u?kn(r,0,1):bn(r),a=r.allVarNames[f]):"number"==typeof a?(f=yn(r,a),a=r.allVarNames[f]):"string"==typeof a?(f=qe(r._varNamesTrie,a))<0&&o("Vars must be defined before using them ("+a+")"):o("expecting result var name to be absent or a number or string: `"+a+"`"),s?t=f:n[2]=a;break;case"distinct":case"eq":case"neq":case"lt":case"lte":case"gt":case"gte":break;default:o("UNKNOWN_PROPAGATOR "+e)}if(function(r,e){for(var n=0,t=e.length;n<t;++n)if("number"==typeof e[n]){var a=yn(r,e[n]);e[n]=r.allVarNames[a]}}(r,n),function(r,e,n){r._constraintHash||(r._constraintHash={});var t=r._constraintHash[e];if(!0===t){if(void 0!==n)throw Error("How is this possible?");return!0}if(void 0!==t)return An(r,"eq",[n,t]),!0;return r._constraintHash[e]=n||!0,!1}(r,i+"|"+n.join(","),a))return a;var c=function(r,e){for(var n=[],t=0,a=e.length;t<a;++t){var i=e[t],u=qe(r._varNamesTrie,i);u===ye&&o("CONSTRAINT_VARS_SHOULD_BE_DECLARED","name=",i,"index=",t,"names=",e),n[t]=u}return n}(r,n);return r.allConstraints.push(Le(e,c,t)),a}function Nn(r,e,n,t,a){switch(JSON.stringify(a),e){case"plus":return dn(r,n[0],n[1],n[2]);case"min":return function(r,e,n,t){Sn(r,un("min",He,e,n,t))}(r,n[0],n[1],n[2]);case"ring-mul":return pn(r,n[0],n[1],n[2]);case"ring-div":return function(r,e,n,t){Sn(r,un("div",Ue,e,n,t))}(r,n[0],n[1],n[2]);case"mul":return function(r,e,n,t){Sn(r,un("mul",ze,e,n,t))}(r,n[0],n[1],n[2]);case"sum":return function r(e,n,t){var a;switch(n.length){case 0:return void o("SUM_REQUIRES_VARS");case 1:return void on(e,t,n[0]);case 2:return void dn(e,n[0],n[1],t)}var i=Math.floor(n.length/2);i>1?(a=bn(e),r(e,n.slice(0,i),a)):a=n[0];var u=bn(e);r(e,n.slice(i),u),dn(e,a,u,t)}(r,n.slice(0),t);case"product":return function r(e,n,t){switch(n.length){case 0:return void o("PRODUCT_REQUIRES_VARS");case 1:return void on(e,t,n[0]);case 2:return void pn(e,n[0],n[1],t)}var a,i=Math.floor(n.length/2);i>1?(a=bn(e),r(e,n.slice(0,i),a)):a=n[0];var u=bn(e);r(e,n.slice(i),u),pn(e,a,u,t)}(r,n.slice(0),t);case"distinct":return function(r,e){for(var n=0;n<e.length;n++)for(var t=e[n],a=0;a<n;++a)cn(r,t,e[a])}(r,n.slice(0));case"reifier":return function r(e,n,t,a,i){var u,f,s,c,v;switch(n){case"eq":u="neq",f=en,s=tn,c=nn,v=an;break;case"neq":u="eq",f=tn,s=en,c=an,v=nn;break;case"lt":f=We,c=Qe,u="gte",s=Ke,v=rn;break;case"lte":f=Xe,c=Ze,u="gt",s=Ge,v=Ye;break;case"gt":return r(e,"lt",a,t,i);case"gte":return r(e,"lte",a,t,i);default:o("UNKNOWN_REIFIED_OP")}Sn(e,un("reified",Je,t,a,i,f,s,n,u,c,v))}(r,t,n[0],n[1],n[2]);case"neq":return cn(r,n[0],n[1]);case"eq":return on(r,n[0],n[1]);case"gte":return function(r,e,n){sn(r,n,e)}(r,n[0],n[1]);case"lte":return sn(r,n[0],n[1]);case"gt":return function(r,e,n){fn(r,n,e)}(r,n[0],n[1]);case"lt":return fn(r,n[0],n[1]);default:o("UNEXPECTED_NAME: "+e)}}function Dn(r){r._varNamesTrie||(r._varNamesTrie=Ae(r.allVarNames)),r._defaultRng||(r._defaultRng=r.rngCode?Function(r.rngCode):Math.random),function(r){var e=r.allConstraints;r._propagators=[];for(var n=Array.isArray(i=e),a=0,i=n?i:i[Symbol.iterator]();;){var o;if(n){if(a>=i.length)break;o=i[a++]}else{if((a=i.next()).done)break;o=a.value}var f=o;if(f.varNames){u().warn("saw constraint.varNames, converting to varIndexes, log out result and update test accordingly"),f.varIndexes=f.varNames.map(function(e){return qe(r._varNamesTrie,e)});var s=f.param;delete f.param,delete f.varNames,f.param=s}if(-1===f.varIndexes[1])throw Error("nope? "+t(f));Nn(r,f.name,f.varIndexes,f.param,f)}}(r),function(r){for(var e=r.varDistOptions,n=0,t=Object.keys(e);n<t.length;n++){var a=t[n],i=qe(r._varNamesTrie,a);i<0&&o("Found markov var options for an unknown var name (name="+a+")");var u=e[a];if(u&&"markov"===u.valtype)return mn(r,i)}}(r),function(r){for(var e=[],n=r._propagators,t=r.initialDomains,a=0,i=n.length;a<i;++a){var u=n[a];En(u.index1,t,e,a),u.index2>=0&&En(u.index2,t,e,a),u.index3>=0&&En(u.index3,t,e,a)}r._varToPropagators=e}(r),function(r){for(var e=r.varStratConfig;e;){if(e.priorityByName){for(var n={},t=e.priorityByName,a=0,i=t.length;a<i;++a)n[qe(r._varNamesTrie,t[a])]=i-a;e._priorityByIndex=n}e=e.fallback}}(r)}function On(r,e,n,t,a,i){var f=r.varDistOptions,s=e||r.initialDomains,c=r.allVarNames,v=function(r){return Cn(c[r])},l=c.map(function(r,e){var n=Vn(s[e]),t=": "+v(e)+" = "+n,a=f[r];if(a&&("list"!==a.valtype||a.list&&a.list.length>0))switch(t+=" @"+a.valtype,a.valtype){case"markov":"expandVectorsWith"in a&&(t+="expand("+(a.expandVectorsWith||0)+")"),"legend"in a&&(t+=" legend("+a.legend.join(" ")+")"),"matrix"in a&&(t+=" matrix("+JSON.stringify(a.matrix).replace(/"/g,"")+")");break;case"list":t+="function"==typeof a.list?" prio(???func???)":" prio("+a.list.join(" ")+")";break;case"max":case"mid":case"min":case"minMaxCycle":case"naive":case"splitMax":case"splitMin":break;default:u().warn("Unknown value strategy override: "+a.valtype),t+=" @? "+JSON.stringify(a)}return t}),d=n?[]:r.allConstraints.map(function(r){var e=r.varIndexes,n=e.map(v);e.forEach(function(r,e){var t=L(s[r]);t>=0&&(n[e]=t)});var i="";if("number"==typeof r.param){var f=L(s[r.param]);i=f>=0?f:v(r.param)}var c,l="",d="";switch(r.name){case"reifier":switch(r.param){case"eq":c="==";break;case"neq":c="!=";break;case"lt":c="<";break;case"lte":c="<=";break;case"gt":c=">";break;case"gte":c=">=";break;default:o("what dis param: "+c)}l+=n[2]+" = "+n[0]+" "+c+"? "+n[1];break;case"plus":l+=n[2]+" = "+n[0]+" + "+n[1];break;case"min":l+=n[2]+" = "+n[0]+" - "+n[1];break;case"ring-mul":l+=n[2]+" = "+n[0]+" * "+n[1];break;case"ring-div":l+=n[2]+" = "+n[0]+" / "+n[1];break;case"mul":l+=n[2]+" = "+n[0]+" * "+n[1];break;case"sum":l+=i+" = sum("+n.join(" ")+")";break;case"product":l+=i+" = product("+n.join(" ")+")";break;case"markov":l+="# markov("+n+")";break;case"distinct":l+="distinct("+n+")";break;case"eq":l+=n[0]+" == "+n[1];break;case"neq":l+=n[0]+" != "+n[1];break;case"lt":l+=n[0]+" < "+n[1];break;case"lte":l+=n[0]+" <= "+n[1];break;case"gt":l+=n[0]+" > "+n[1];break;case"gte":l+=n[0]+" >= "+n[1];break;default:u().warn("unknown constraint: "+r.name),l+="unknown = "+JSON.stringify(r)}var p=l;if((l.indexOf("'")<0||"distinct"===r.name&&n.length<=1||("product"===r.name||"sum"===r.name)&&0===n.length)&&(t||(d+=(d?", ":" # ")+"dropped; constraint already solved ("+l+") ("+e.map(v)+", "+v(r.param)+")"),l=""),!t||a){if(n.forEach(function(r,n){"string"==typeof r&&(p=p.replace(r,Vn(s[e[n]])))}),"number"==typeof r.param&&"string"==typeof i&&(p=p.replace(i,Vn(s[r.param]))),l||!t){for(var m=Math.max(0,30-l.length);m>=0;--m)l+=" ";l+="      # "+p}l+=d}return l}).filter(function(r){return!!r}),p=n?r._propagators.map(function(r){var e,n=r.index1,a=r.index2,i=r.index3,f=n>=0?L(s[n]):-1,c=f>=0?f:n<0?void 0:v(n),l=a>=0?L(s[a]):-1,d=l>=0?l:a<0?void 0:v(a),p=i>=0?L(s[i]):-1,m=p>=0?p:i<0?void 0:v(i),h="",g="";switch(r.name){case"reified":switch(r.arg3){case"eq":e="==";break;case"neq":e="!=";break;case"lt":e="<";break;case"lte":e="<=";break;case"gt":e=">";break;case"gte":e=">=";break;default:o("what dis param: "+e)}h+=m+" = "+c+" "+e+"? "+d;break;case"eq":h+=c+" == "+d;break;case"lt":h+=c+" < "+d;break;case"lte":h+=c+" <= "+d;break;case"mul":h+=m+" = "+c+" * "+d;break;case"div":h+=m+" = "+c+" / "+d;break;case"neq":h+=c+" != "+d;break;case"min":h+=m+" = "+c+" - "+d;break;case"ring":switch(r.arg1){case"plus":h+=m+" = "+c+" + "+d;break;case"min":h+=m+" = "+c+" - "+d;break;case"ring-mul":h+=m+" = "+c+" * "+d;break;case"ring-div":h+=m+" = "+c+" / "+d;break;default:throw Error("Unexpected ring op:"+r.arg1)}break;case"markov":return"";default:u().warn("unknown propagator: "+r.name),h+="unknown = "+JSON.stringify(r)}var b=h;return h.indexOf("$")<0&&(t||(g+=(g?", ":" # ")+"dropped; constraint already solved ("+h+")"),h=""),t||("string"==typeof c&&(b=b.replace(c,Vn(s[n]))),"string"==typeof d&&(b=b.replace(d,Vn(s[a]))),"string"==typeof m&&(b=b.replace(m,Vn(s[i]))),h+=" ".repeat(Math.max(0,30-h.length))+"      # initial: "+b,h+=g),h}).filter(function(r){return!!r}):[];return["## constraint problem export","@custom var-strat = "+JSON.stringify(r.varStratConfig),"@custom val-strat = "+r.valueStratName,l.join("\n")||"# no vars",d.join("\n")||p.join("\n")||"# no constraints","@custom targets "+("all"===r.targetedVars?" = all":"("+r.targetedVars.map(function(e){return v(qe(r._varNamesTrie,e))}).join(" ")+")"),"## end of export"].join("\n\n")}function Cn(r){return"number"==typeof r?r:"'"+r+"'"}function Vn(r){var e=Pr(r);if(2===e.length&&e[0]===e[1])return e[0]+"";if(e.length>2){for(var n=[],t=0,a=e.length;t<a;t+=2)n.push("["+e[t]+" "+e[t+1]+"]");e=n}return"["+e.join(" ")+"]"}function jn(r,e,n){e||(e=new ct);for(var t=0,a=r.length;!b();)k();return e;function i(){return r[t]}function o(e){return r[t+e]}function c(){++t}function v(r,e){i()!==r&&I("Expected "+(e?e+" ":"")+"`"+r+"`, found `"+i()+"`"),c()}function l(){for(;t<a&&d(i());)c()}function d(r){return" "===r||"\t"===r}function p(r){return"\n"===r||"\r"===r}function m(r){return"#"===r}function h(){if(l(),t<a){var r=i();"#"===r?_():p(r)?c():I("Expected EOL but got `"+i()+"`")}}function g(){if(t>=a)return!0;var r=i();return"#"===r||p(r)}function b(){return t>=a}function k(){switch(function(){for(;!b();){var r=i();if(d(e=r)||p(e))c();else{if(!m(r))break;_()}}var e}(),i()){case":":return function(){c(),l();var n=y();if(l(),","===i()){n=[n];do{c(),l(),n.push(y()),l()}while(!b()&&","===i())}"="===i()&&(c(),l());var a=x();l();var u=function(){if("@"!==i())return;c();var e={},n=t;for(;i()>="a"&&i()<="z";)c();var a=r.slice(n,t);switch(a){case"list":!function(e){l(),"prio("!==r.slice(t,t+5)&&I("Expecting the priorities to follow the `@list`");t+=5,e.list=T(),v(")","list end")}(e);break;case"markov":!function(e){for(;;){if(l(),"matrix("===r.slice(t,t+7)){var n=r.slice(t+7,t=r.indexOf(")",t)),a="return "+n,i=Function(a);e.matrix=i(),-1===t&&I("The matrix must be closed by a `)` but did not find any")}else if("legend("===r.slice(t,t+7))t+=7,e.legend=T(),l(),v(")","legend closer");else{if("expand("!==r.slice(t,t+7))break;t+=7,e.expandVectorsWith=N(),l(),v(")","expand closer")}c()}}(e);break;case"max":case"mid":case"min":case"naive":break;case"minMaxCycle":case"splitMax":case"splitMin":default:I("implement me (var mod) [`"+a+"`]")}return e.valtype=a,e}();h(),"string"==typeof n?e.decl(n,a,u,!0):n.forEach(function(r){return e.decl(r,a,u,!0)})}();case"#":return _();case"@":return function(){if(v("@"),"custom"===r.slice(t,t+6)){t+=6,l();var n=y();switch(l(),"="===i()&&(c(),l(),"="===i()&&I("Unexpected double eq sign")),n){case"var-strat":!function(){l();var r=!1;if("f"===i()){var n=y();"fallback"!==n&&I("Expecting `fallback` here"),r=!0,l()}var t=!1;if("i"===i()){var a=y();"inverted"!==a&&I("Expecting `inverted` here"),t=!0,l()}if("l"===i()||"("===i()){"l"===i()&&("list"!==y()&&I("Unexpected ident after `inverted` (only expecting `list` or the list)"),l()),v("(");var u=q();wn(e.config,r?"varStrategyFallback":"varStrategy",u.length>0?{type:"list",inverted:t,priorityByName:u}:{type:"naive"}),l(),v(")")}else{"="===i()&&(c(),l()),t&&I("The `inverted` keyword is only valid for a prio list");var o=y();"list"===o&&I("Use a grouped list of idents for vardist=list"),"naive"!==o&&"size"!==o&&"min"!==o&&"max"!==o&&"throw"!==o&&I("Unknown var dist ["+o+"]"),wn(e.config,r?"varStrategyFallback":"varStrategy",{type:o})}}();break;case"val-strat":o=y(),h(),e.config.valueStratName=o;break;case"set-valdist":l();var a=y(),u=function(){l(),"="===i()&&(c(),l());return R()}();e.setValueDistributionFor(a,JSON.parse(u));break;case"targets":!function(){if(l(),"all"===r.slice(t,t+3))t+=3,e.config.targetedVars="all";else{v("(","ONLY_USE_WITH_SOME_TARGET_VARS"),l(),","===i()&&I("Leading comma not supported");var n=q();n.length>0&&(e.config.targetedVars=n),v(")")}}();break;case"nobool":case"noleaf":case"free":l(),","===i()&&I("Leading comma not supported"),g()&&I("Expected to parse some var values"),R();break;default:I("Unsupported custom rule: "+n)}}else I("Unknown atrule");var o;h()}();default:if(!b())return function(){if(function(){if("all("===r.slice(t,t+4))!function(){t+=4,l();var r=E(),n=e.product(r,e.decl(void 0,[1,s]));l(),v(")","ALL closer")}();else if("distinct("===r.slice(t,t+9))D(9);else if("diff("===r.slice(t,t+5))D(5);else if("nall("===r.slice(t,t+5))!function(){t+=5,l();var r=E();e.product(r,e.num(0)),l(),v(")","nall closer"),h()}();else if("none("===r.slice(t,t+5))!function(){t+=5,l();var r=E();e.sum(r,e.num(0)),l(),v(")","none closer"),h()}();else if("same("===r.slice(t,t+5))!function(){t+=5,l();for(var r=E(),n=1;n<r.length;++n)e.eq(r[n-1],r[n]);l(),v(")","same closer"),h()}();else if("some("===r.slice(t,t+5))!function(){t+=5,l();var r=E();e.sum(r,e.decl(void 0,[1,s])),l(),v(")","some closer"),h()}();else{if("xnor("!==r.slice(t,t+5))return!1;!function(){t+=5,l();var r=E();l(),v(")","xnor() closer"),h();var n=e.decl(),a=e.decl();e.sum(r,n),e.product(r,a),e.plus(e.isEq(n,0),e.isNeq(a,0),1)}()}return!0}())return;var n=A();l();var a=function(){var r=i();switch(r){case"=":return c(),"="===i()?(c(),"=="):"=";case"!":return c(),"="===(r=i())?(c(),"!="):"&"===r?(c(),"!&"):"^"===r?(c(),"!^"):"|"===r?(c(),"!|"):"-"===r&&">"===o(1)?(c(),c(),"!->"):"!";case"<":return c(),"="===i()?(c(),"<="):"<";case">":return c(),"="===i()?(c(),">="):">";case"&":case"|":case"^":return c(),r;case"#":I("Expected to parse a cop but found a comment instead");break;case"-":if(">"===o(1))return c(),c(),"->"}b()&&I("Expected to parse a cop but reached eof instead");I("Unknown cop char: `"+r+"`")}();switch(l(),a){case"=":w(n);break;case"==":e.eq(n,A());break;case"!=":e.neq(n,A());break;case"<":e.lt(n,A());break;case"<=":e.lte(n,A());break;case">":e.gt(n,A());break;case">=":e.gte(n,A());break;case"&":e.neq(e.mul(n,A()),e.num(0));break;case"!&":e.mul(n,A(),e.num(0));break;case"|":e.neq(e.plus(n,A()),e.num(0));break;case"!|":e.eq(n,e.num(0)),e.eq(A(),e.num(0));break;case"^":e.eq(e.plus(e.isEq(n,0),e.isEq(A(),0)),1);break;case"!^":e.eq(e.isEq(n,e.num(0)),e.isEq(A(),e.num(0)));break;case"->":var u=A();e.lte(e.isNeq(n,e.num(0)),e.isNeq(u,e.num(0))),e.lte(e.isEq(u,e.num(0)),e.isEq(n,e.num(0)));break;case"!->":e.gt(n,e.num(0)),e.eq(A(),e.num(0));break;default:a&&I("Unknown cop that starts with: ["+a+"]")}h()}()}}function y(){return"'"===i()?function(){v("'","start of Quoted identifier");var e=t,n=i();for(;!b()&&!p(n)&&"'"!==n;)c(),n=i();b()&&I("Quoted identifier must be closed");e===t&&I("Expected to parse identifier, found none");return v("'","end of Quoted identifier"),r.slice(e,t-1)}():function(){var e=t;i()>="0"&&i()<="9"&&I("Unquoted ident cant start with number");for(;!b()&&(n=i(),n>="a"&&n<="z"||n>="A"&&n<="Z"||n>="0"&&n<="9"||"_"===n||"$"===n||"-"===n||n>"~");)c();var n;e===t&&I("Expected to parse identifier, found none ["+i()+"]");return r.slice(e,t)}()}function x(){var r,e=i();switch(e){case"[":if(v("[","domain start"),l(),r=[],"["===i())do{c(),l();var n=N();l(),","===i()&&(c(),l());var t=N();l(),v("]","range-end"),l(),r.push(n,t),","===i()&&(c(),l())}while("["===i());else if("]"!==i())do{l();var a=N();l(),","===i()&&(c(),l());var u=N();l(),r.push(a,u),","===i()&&(c(),l())}while("]"!==i());return v("]","domain-end"),0===r.length&&I("Empty domain [] in dsl, this problem will always reject"),r;case"*":return c(),[f,s];case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":var o=N();return l(),[o,o];default:I("Expecting valid domain start, found `"+e+"`")}}function _(){for(v("#","comment start");!b()&&!p(i());)c();b()||c()}function w(r){var n="string"==typeof r&&!e.hasVar(r);n&&(r=e.decl(r));var t=A(r,n);l();var a=i();return b()||p(a)||m(a)?(e.eq(t,r),t):S(t,r,n)}function S(r,n,t){var a=function(){var r=i();switch(r){case"=":c();var e=i();return"="===e?(c(),v("?","reifier suffix"),"==?"):"=";case"!":if(c(),"="===i())return v("=","middle part of !=? op"),v("?","reifier suffix"),"!=?";if("|"===i())return v("|","middle part of !|? op"),v("?","reifier suffix"),"!|?";if("&"===i())return v("&","middle part of !&? op"),v("?","reifier suffix"),"!&?";I("invalid rop char after ! ["+i()+"]");break;case"<":return c(),"="===i()?(c(),v("?","reifier suffix"),"<=?"):(v("?","reifier suffix"),"<?");case">":return c(),"="===i()?(c(),v("?","reifier suffix"),">=?"):(v("?","reifier suffix"),">?");case"|":return c(),v("?","reifier suffix"),"|?";case"&":return c(),v("?","reifier suffix"),"&?";case"+":case"-":case"*":case"/":return c(),r;default:I("Expecting right paren or rop, got: `"+r+"`")}}();switch(l(),a){case"==?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isEq(r,A(),n);case"!=?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isNeq(r,A(),n);case"<?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isLt(r,A(),n);case"<=?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isLte(r,A(),n);case">?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isGt(r,A(),n);case">=?":return t&&e.decl(n,[0,1],void 0,!1,!0),e.isGte(r,A(),n);case"|?":return t&&e.decl(n,[0,1],void 0,!1,!0),j(n,[r,A()]);case"!|?":return t&&e.decl(n,[0,1],void 0,!1,!0),V(n,[r,A()]);case"&?":return t&&e.decl(n,[0,1],void 0,!1,!0),O(n,[r,A()]);case"!&?":return t&&e.decl(n,[0,1],void 0,!1,!0),C(n,[r,A()]);case"+":return e.plus(r,A(),n);case"-":return e.minus(r,A(),n);case"*":return e.mul(r,A(),n);case"/":return e.div(r,A(),n);default:return void 0!==a&&I("Expecting right paren or rop, got: `"+a+"`"),r}}function E(){var r=[];for(l();!b()&&")"!==i();){var e=A();r.push(e),l(),","===i()&&(c(),l())}return r}function A(r,n){var t,a=i();if("("===a)t=function(){v("(","group open"),l();var r=A();if(l(),"="===i()&&"="!==i())return w(r),l(),v(")","group closer"),r;if(")"===i())return c(),r;var e=S(r);return l(),v(")","group closer"),e}();else if("["===a){var u=x();t=u[0]===u[1]&&2===u.length?u[0]:e.decl(void 0,u)}else if(a>="0"&&a<="9")t=N();else{var o=y(),f=i();"sum"===o&&"("===f?t=function(r){v("(","sum call opener"),l();var n=E(),t=e.sum(n,r);return l(),v(")","sum closer"),t}(r):"product"===o&&"("===f?t=function(r){v("(","product call opener"),l();var n=E(),t=e.product(n,r);return l(),v(")","product closer"),t}(r):"all"===o&&"?"===f&&(c(),"("===i())?(n&&e.decl(r,[0,1],void 0,!1,!0),t=function(r){v("(","isall call opener"),l();var e=E(),n=O(r,e);return l(),v(")","isall closer"),n}(r)):"diff"===o&&"?"===f&&(c(),"("===i())?(n&&e.decl(r,[0,1],void 0,!1,!0),t=function(r){v("(","isdiff call opener"),l();for(var n=E(),t=[],a=0;a<n.length;++a)for(var i=n[a],u=a+1;u<n.length;++u){var o=n[u];t.push(e.isNeq(i,o))}return e.isEq(e.sum(t),e.num(t.length),r),l(),v(")","isdiff closer"),r}(r)):"nall"===o&&"?"===f&&(c(),"("===i())?(n&&e.decl(r,[0,1],void 0,!1,!0),t=function(r){v("(","isnall call opener"),l();var e=E(),n=C(r,e);return l(),v(")","isnall closer"),n}(r)):"none"===o&&"?"===f&&(c(),"("===i())?(n&&e.decl(r,[0,1],void 0,!1,!0),t=function(r){v("(","isnone call opener"),l();var e=E(),n=V(r,e);return l(),v(")","isnone closer"),n}(r)):"same"===o&&"?"===f&&(c(),"("===i())?(n&&e.decl(r,[0,1],void 0,!1,!0),t=function(r){v("(","issame call opener"),l();for(var n=E(),t=[],a=1;a<n.length;++a){var i=e.decl(void 0,[0,1]);e.isEq(n[a-1],n[a],i),t.push(i)}var u=e.decl();e.sum(t,u);var o=e.isEq(u,e.num(t.length),r);return l(),v(")","issame closer"),o}(r)):"some"===o&&"?"===f&&(c(),"("===i())?(n&&e.decl(r,[0,1],void 0,!1,!0),t=function(r){v("(","issome call opener"),l();var e=E(),n=j(r,e);return l(),v(")","issome closer"),n}(r)):"?"===f?I("Unknown reifier constraint func: ["+o+"]"):t=o}return t}function N(){for(var e=t;i()>="0"&&i()<="9";)c();return e===t&&I("Expecting to parse a number but did not find any digits ["+e+","+t+"]["+i()+"]"),parseInt(r.slice(e,t),10)}function D(r){t+=r,l();var n=E();0===n.length&&I("Expecting at least one expression"),e.distinct(n),l(),v(")","distinct call closer"),h()}function O(r,n){var t=e.decl();return e.product(n,t),e.isNeq(t,e.num(0),r)}function C(r,n){var t=e.decl();return e.product(n,t),e.isEq(t,e.num(0),r)}function V(r,n){var t=e.decl();return e.sum(n,t),e.isEq(t,e.num(0),r)}function j(r,n){var t=e.decl();return e.sum(n,t),e.isNeq(t,e.num(0),r)}function M(){for(var e=t;i()>="0"&&i()<="9";)c();return r.slice(e,t)}function T(){var r=[];l();for(var e=M();e;)r.push(parseInt(e,10)),l(),","===i()&&(++t,l()),e=M();return 0===r.length&&I("Expected to parse a list of at least some numbers but found none"),r}function q(){for(var r=[];l(),g()&&I("Missing target char at eol/eof"),")"!==i();){","===i()&&(c(),l(),g()&&I("Trailing comma not supported")),","===i()&&I("Double comma not supported");var e=y();r.push(e)}return 0===r.length&&I("Expected to parse a list of at least some identifiers but found none"),r}function R(){for(var r="";!b()&&!p(i());)r+=i(),c();return r}function I(e){throw n&&u().log(r.slice(0,t)+"##|PARSER_IS_HERE["+e+"]|##"+r.slice(t)),e="Importer parser error: "+e+", source at #|#: `"+r.slice(Math.max(0,t-70),t)+"#|#"+r.slice(t,Math.min(r.length,t+70))+"`",Error(e)}}function Mn(){return Rn([])}function Tn(r){var e=Mn();return function(r,e){(function(r,e){for(var n=r.vardoms,t=e.initialDomains,a=0,i=e.allVarNames.length;a<i;a++){var u=t[a];n[a]=Gr(u)}})(r,e),function(r,e){var n=e.targetedVars,t=r.vardoms,a=[];if(r._unsolved=a,"all"===n)for(var i=0,u=t.length;i<u;++i)br(t[i])||(e._varToPropagators[i]||e._constrainedAway&&e._constrainedAway.indexOf(i)>=0)&&a.push(i);else{n.every(function(r){return"string"==typeof r});for(var o=e._varNamesTrie,f=n,s=Array.isArray(f),c=0,f=s?f:f[Symbol.iterator]();;){var v;if(s){if(c>=f.length)break;v=f[c++]}else{if((c=f.next()).done)break;v=c.value}var l=v;In(l,o,t,a)}}}(r,e)}(e,r),e}function qn(r,e){for(var n=r.vardoms,t=[],a=0,i=e.allVarNames.length;a<i;a++){t[a]=Jr(n[a])}return gn(e,void 0)}function Rn(r,e,n,t,a){return{_class:"$space",vardoms:r,_unsolved:e,next_distribution_choice:0,updatedVarIndex:-1,_lastChosenValue:-1}}function In(r,e,n,t){var a=qe(e,r);a===ye&&o("E_VARS_SHOULD_EXIST_NOW ["+r+"]"),br(n[a])||t.push(a)}function Ln(r,e){if(function(r,e){var n=e.beforeSpace;if(n&&n(r))return e.aborted=!0,!0;return!1}(r,e))return!0;var n=e._propagators,t=Ae(xe,Math.ceil(r._unsolved.length*ge*.3)),a=0,i=[],u=1;if(r.updatedVarIndex>=0)i.push(r.updatedVarIndex);else if(function(r,e,n,t,a,i){for(var u=Array.isArray(f=n),o=0,f=u?f:f[Symbol.iterator]();;){var s;if(u){if(o>=f.length)break;s=f[o++]}else{if((o=f.next()).done)break;s=o.value}var c=s,v=Un(r,e,c,t,a,i);if(v)return!0}return!1}(r,e,n,i,t,++a))return!0;for(;i.length;){var o=[];if(Bn(r,e,n,u,i,o,t,++a))return!0;i=o,u=2}return!!function(r,e){var n=e.afterSpace;if(n&&n(r))return e.aborted=!0,!0;return!1}(r,e)}function Un(r,e,n,t,a,i){var u=r.vardoms,o=n.index1,f=n.index2,s=n.index3,c=u[o],v=void 0!==f&&u[f],l=void 0!==s&&u[s];if((0,n.stepper)(r,e,o,f,s,n.arg1,n.arg2,n.arg3,n.arg4,n.arg5,n.arg6),c!==u[o]){if(Ar(u[o]))return!0;Fn(o,a,t,i)}if(void 0!==f&&v!==u[f]){if(Ar(u[f]))return!0;Fn(f,a,t,i)}if(void 0!==s&&-1!==s&&l!==u[s]){if(Ar(u[s]))return!0;Fn(s,a,t,i)}return!1}function Fn(r,e,n,t){if("number"==typeof r)Ie(e,r)!==t&&(n.push(r),je(e,r,t));else for(var a=Array.isArray(u=r),i=0,u=a?u:u[Symbol.iterator]();;){var o;if(a){if(i>=u.length)break;o=u[i++]}else{if((i=u.next()).done)break;o=i.value}Fn(o,e,n,t)}}function Bn(r,e,n,t,a,i,u,o){for(var f=e._varToPropagators,s=function(s,c){var v=f[a[s]];if(v&&v.length>=t&&function(r,e,n,t,a,i,u){for(var o=function(o,f){if(Un(r,e,n[t[o]],a,i,u))return{v:!0}},f=0,s=t.length;f<s;f++){var c=o(f);if("object"==typeof c)return c.v}return!1}(r,e,n,v,i,u,o))return{v:!0}},c=0,v=a.length;c<v;c++){var l=s(c);if("object"==typeof l)return l.v}return!1}function Pn(r,e){for(var n=e.allVarNames,t={},a=0,i=n.length;a<i;a++){t[n[a]]=Hn(r,a)}return t}function Hn(r,e){var n=r.vardoms[e];if(Ar(n))return!1;var t=L(n);return t!==v?t:Pr(n)}var zn=1,Jn=2,$n=3;function Wn(r,e){var n=e.varStratConfig;return function(r,e,n,t){var a=0,i=r._unsolved,u=i[a++];if(n)for(var o=i.length;a<o;a++){var f=i[a];zn===n(r,e,f,u,t)&&(u=f)}return u}(r,e,function(r){switch(r){case"naive":return null;case"size":return Gn;case"min":return Qn;case"max":return Yn;case"markov":return Xn;case"list":return Kn;case"throw":return o("Throwing an error because var-strat requests it");default:return o("unknown next var func",r)}}(n.type),n)}function Gn(r,e,n,t){var a=fr(r.vardoms[n])-fr(r.vardoms[t]);return a<0?zn:a>0?$n:Jn}function Qn(r,e,n,t){var a=lr(r.vardoms[n])-lr(r.vardoms[t]);return a<0?zn:a>0?$n:Jn}function Yn(r,e,n,t){var a=mr(r.vardoms[n])-mr(r.vardoms[t]);return a>0?zn:a<0?$n:Jn}function Xn(r,e,n,t,a){var i=e.varDistOptions,u=e.allVarNames[n];if(i[u]&&"markov"===i[u].valtype)return zn;var o=e.allVarNames[t];return i[o]&&"markov"===i[o].valtype?$n:Zn(r,e,n,t,a.fallback)}function Kn(r,e,n,t,a){var i=a._priorityByIndex,u=i[n],o=i[t];if(!u&&!o)return Zn(r,e,n,t,a.fallback);var f=a.inverted;return o?u&&u>o?f?$n:zn:f?zn:$n:f?$n:zn}function Zn(r,e,n,t,a){if(!a)return Jn;var i=a.type;switch(i){case"size":return Gn(r,0,n,t);case"min":return Qn(r,0,n,t);case"max":return Yn(r,0,n,t);case"markov":return Xn(r,e,n,t,a);case"list":return Kn(r,e,n,t,a);case"throw":return o("nope");default:return o("Unknown var dist fallback name: "+i)}}function rt(r,e,n,t,a){void 0===a&&(a=!0);for(var i=[],u=[],o=0,f=0;f<e.length;f++){var s=e[f];if(s>0){var c=n[f];q(r,c)&&(u.push(o+=s),i.push(c))}}if(0!==u.length)return 1===u.length?i[0]:function(r,e,n,t,a){var i=r(),u=i;a&&(u=i*e);for(var o=0,f=n.length;o<f;o++){var s=n[o];if(s>u)break}return t[o]}(t,o,u,i,a)}var et=0,nt=1,tt=void 0;function at(r,e,n,t,a){switch(r){case"max":return ut(e,t,a);case"markov":return function(r,e,n,t){var a=r.vardoms[n];switch(t){case et:var i=e.allVarNames[n],u=e.varDistOptions,o=u[i],f=o.expandVectorsWith,s=o.random||e._defaultRng,c=Fe("number"==typeof f,o.legend,a),v=c.length;if(!v)return tt;var l=Be(r,o.matrix,f,v),d=rt(a,l,c,s);return null===d?tt:(r._lastChosenValue=d,Rr(d));case nt:var p=r._lastChosenValue,m=Vr(a,p);return m;default:return tt}}(e,n,t,a);case"mid":return function(r,e,n){var t=r.vardoms[e];switch(n){case et:var a=vr(t);return r._lastChosenValue=a,Rr(a);case nt:return Vr(t,r._lastChosenValue);default:return tt}}(e,t,a);case"min":case"naive":return it(e,t,a);case"minMaxCycle":return function(r,e,n){if(t=e,t%2==0)return it(r,e,n);var t;return ut(r,e,n)}(e,t,a);case"list":return function(r,e,n,t){var a=r.vardoms[n],i=e.allVarNames[n],u=e.varDistOptions[i],o=u.list,f="";u.fallback&&(f=u.fallback.valtype);var s=o;"function"==typeof o&&(s=o(r,i,t));switch(t){case et:var c=$(a,s);return c===v?at(f||"naive",r,e,n,et):(r._lastChosenValue=c,Rr(c));case nt:return r._lastChosenValue>=0?Vr(a,r._lastChosenValue):at(f||"naive",r,e,n,nt);default:return tt}}(e,n,t,a);case"splitMax":return function(r,e,n){var t=r.vardoms[e],a=lr(t);switch(n){case et:var i=mr(t),u=a+Math.floor((i-a)/2);return r._lastChosenValue=u,G(t,Ir(u+1,i));case nt:return G(t,Ir(a,r._lastChosenValue));default:return tt}}(e,t,a);case"splitMin":return function(r,e,n){var t=r.vardoms[e],a=mr(t);switch(n){case et:var i=lr(t),u=i+Math.floor((a-i)/2);return r._lastChosenValue=u,G(t,Ir(i,u));case nt:return G(t,Ir(r._lastChosenValue+1,a));default:return tt}}(e,t,a);case"throw":return o("Throwing an error because val-strat requests it");default:o("unknown next var func",r)}}function it(r,e,n){var t=r.vardoms[e];switch(n){case et:var a=lr(t);return r._lastChosenValue=a,Rr(a);case nt:return Vr(t,r._lastChosenValue);default:return tt}}function ut(r,e,n){var t=r.vardoms[e];switch(n){case et:var a=mr(t);return r._lastChosenValue=a,Rr(a);case nt:return Vr(t,r._lastChosenValue);default:return tt}}function ot(r,e,n){var t=r.stack,a=0;if(!t||0===t.length){t||(r.stack=[],t=r.stack);var i=ft(r.space,e,t,r);if(n&&n(++a)&&(n=void 0),i)return}for(;t.length>0&&!e.aborted;){var u=st(t[t.length-1],e);if(u){var o=ft(u,e,t,r);if(n&&n(++a)&&(n=void 0),o)return}else t.pop()}r.status="end",r.more=!1}function ft(r,e,n,t){return function(r,e,n,t,a){if(r)return e.failed=!0,!1;if(function(r,e){for(var n=r.vardoms,t=r._unsolved,a=0,i=Array.isArray(o=t),u=0,o=i?o:o[Symbol.iterator]();;){var f;if(i){if(u>=o.length)break;f=o[u++]}else{if((u=o.next()).done)break;f=u.value}var s=f;br(n[s])||(t[a++]=s)}return t.length=a,0===a}(e))return function(r,e,n){r.status="solved",r.space=e,r.more=n.length>0}(a,e,t),!0;return void t.push(e)}(Ln(r,e),r,0,n,t)}function st(r,e){var n=Wn(r,e);if(n!==v&&!br(r.vardoms[n])){var t=r.next_distribution_choice++,a=function(r,e,n,t){var a=e.valueStratName,i=e.varDistOptions,u=e.allVarNames[n],o=i[u]&&i[u].valtype;return o&&(a=o),"function"==typeof a?a(r,n,t):at(a,r,e,n,t)}(r,e,n,t);if(a){var i=function(r){return Rn(r.vardoms.slice(0),r._unsolved.slice(0))}(r);return i.updatedVarIndex=n,i.vardoms[n]=a,i}}}var ct=function(){function r(r){if(void 0===r&&(r={}),this._class="fdo",r.logger&&i(r.logger),this.logging=r.log||k,this.distribute=r.distribute||"naive",r.config){this.config=r.config;var e=this.config;if(e.initialDomains)for(var n=e.initialDomains,t=0,a=n.length;t<a;++t){var u=n[t];0===u.length&&(u=Ur()),n[t]=Qr(u)}e._propagators&&(e._propagators=void 0),e._varToPropagators&&(e._varToPropagators=void 0)}else this.config=hn();this.solutions=[],this.state={space:null,more:!1},this._prepared=!1}var e=r.prototype;return e.num=function(r){"number"!=typeof r&&o("FDO#num: expecting a number, got "+r+" (a "+typeof r+")"),isNaN(r)&&o("FDO#num: expecting a number, got NaN");var e=yn(this.config,r);return this.config.allVarNames[e]},e.decl=function(r,e,n,t,a){""===r&&o("Var name can not be the empty string");var i="number"==typeof e?[e,e]:e||[f,s];0!==i.length||t||o("EMPTY_DOMAIN_NOT_ALLOWED");var u=function(r,e,n,t,a){return xn(r,e,Qr(n),0,a)}(this.config,r||!0,i,0,a);return r=this.config.allVarNames[u],n&&(n.distribute&&o("Use `valtype` to set the value distribution strategy"),wn(this.config,"varValueStrat",n,r)),r},e.decls=function(r,e,n){for(var t=0,a=r.length;t<a;++t)this.decl(r[t],e,n)},e.declRange=function(r,e,n,t){return this.decl(r,[e,n],t)},e.plus=function(r,e,n){return An(this.config,"plus",[r,e,n])},e.minus=function(r,e,n){return An(this.config,"min",[r,e,n])},e.mul=function(r,e,n){return An(this.config,"ring-mul",[r,e,n])},e.div=function(r,e,n){return An(this.config,"ring-div",[r,e,n])},e.sum=function(r,e){return An(this.config,"sum",r,e)},e.product=function(r,e){return An(this.config,"product",r,e)},e.distinct=function(r){An(this.config,"distinct",r)},e.eq=function(r,e){if(Array.isArray(r))for(var n=0,t=r.length;n<t;++n)this.eq(r[n],e);else if(Array.isArray(e))for(var a=0,i=e.length;a<i;++a)this.eq(r,e[a]);else An(this.config,"eq",[r,e])},e.neq=function(r,e){if(Array.isArray(r))for(var n=0,t=r.length;n<t;++n)this.neq(r[n],e);else if(Array.isArray(e))for(var a=0,i=e.length;a<i;++a)this.neq(r,e[a]);else An(this.config,"neq",[r,e])},e.gte=function(r,e){An(this.config,"gte",[r,e])},e.lte=function(r,e){An(this.config,"lte",[r,e])},e.gt=function(r,e){An(this.config,"gt",[r,e])},e.lt=function(r,e){An(this.config,"lt",[r,e])},e.isNeq=function(r,e,n){return An(this.config,"reifier",[r,e,n],"neq")},e.isEq=function(r,e,n){return An(this.config,"reifier",[r,e,n],"eq")},e.isGte=function(r,e,n){return An(this.config,"reifier",[r,e,n],"gte")},e.isLte=function(r,e,n){return An(this.config,"reifier",[r,e,n],"lte")},e.isGt=function(r,e,n){return An(this.config,"reifier",[r,e,n],"gt")},e.isLt=function(r,e,n){return An(this.config,"reifier",[r,e,n],"lt")},e.solve=function(r){var e=this;void 0===r&&(r={}),r.log&&(this.logging=r.log);var n,t=this.logging,a=r.max,i=void 0===a?1e3:a;if(this._prepare(r,t),(r._tostring||r._debug||r._debugConfig||r._debugSpace||r._debugSolver)&&(n=function(n){return(0|r._debugDelay)>=n&&(r._tostring&&u().log(On(e.config)),r._debug&&e._debugLegible(),r._debugConfig&&e._debugConfig(),r._debugSolver&&e._debugSolver(),!0)})(0)&&(n=void 0),!r._nosolve)return this._run(i,t,n),this.solutions},e._prepare=function(r,e){void 0===r&&(r={}),e>=y&&(u().log("      - FD Preparing..."),u().time("      - FD Prepare Time")),this._prepareConfig(r,e);var n=Tn(this.config);this.state.space=n,this.state.more=!0,this.state.stack=[],this._prepared=!0,e>=y&&u().timeEnd("      - FD Prepare Time")},e._prepareConfig=function(r,e){var n=this.config;r.vars&&"all"!==r.vars&&wn(n,"targeted_var_names",r.vars),r.beforeSpace&&wn(n,"beforeSpace",r.beforeSpace),r.afterSpace&&wn(n,"afterSpace",r.afterSpace),Dn(n)},e._run=function(r,e,n){this._prepared=!1;var t,a=this.state;e>=y&&((t=u()).log("      - FD Var Count: "+this.config.allVarNames.length),t.log("      - FD Targeted: "+("all"===this.config.targetedVars?"all":this.config.targetedVars.length)),t.log("      - FD Constraint Count: "+this.config.allConstraints.length),t.log("      - FD Propagator Count: "+this.config._propagators.length),t.log("      - FD Solving..."),t.time("      - FD Solving Time"));for(var i,o=!1,f=a.space.vardoms,s=0,c=f.length;s<c;++s)if(Ar(f[s])){o=!0,e>=y&&t.log("      - FD: rejected without propagation ("+this.config.allVarNames[s]+" is empty)");break}o?(e>=y&&t.log("      - FD Input Problem Rejected Immediately"),i=[]):i=function(r,e,n,t){var a=[];for(;r.more&&a.length<n;)ot(r,e,t),"end"!==r.status&&a.push(r.space);return a}(a,this.config,r,n),e>=y&&(t.timeEnd("      - FD Solving Time"),t.log("      - FD Solutions: "+i.length)),function(r,e,n,t){t>=y&&u().time("      - FD Solution Construction Time");for(var a=0;a<r.length;++a){var i=Pn(r[a],e);n.push(i),t>=x&&(u().log("      - FD solution() ::::::::::::::::::::::::::::"),u().log(JSON.stringify(i)),u().log("                      ::::::::::::::::::::::::::::"))}t>=y&&u().timeEnd("      - FD Solution Construction Time")}(i,this.config,this.solutions,e)},e.hasVar=function(r){return qe(this.config._varNamesTrie,r)>=0},e.setValueDistributionFor=function(r,e){wn(this.config,"varValueStrat",e,r)},e.branch_from_current_solution=function(){return new r({config:qn(this.state.space,this.config)})},e._debugLegible=function(){var r=JSON.parse(JSON.stringify(this.config)),e=r.allVarNames,n=r.targetedVars,a=r.allConstraints,i=r.initialDomains,o=r._propagators;for(var f in r)"_"===f[0]&&"object"==typeof r[f]&&(r[f]="<removed>");r.allVarNames="<removed>",r.allConstraints="<removed>",r.initialDomains="<removed>",r.varDistOptions="<removed>","all"!==n&&(r.targetedVars="<removed>");var s=u();s.log("\n## _debug:\n"),s.log("- config:"),s.log(t(r)),s.log("- vars ("+e.length+"):"),s.log(e.map(function(r,e){return e+": "+K(i[e])+" "+(r===e+""?"":" // "+r)}).join("\n")),"all"!==n&&s.log("- targeted vars ("+n.length+"): "+n.join(", ")),s.log("- constraints ("+a.length+" -> "+o.length+"):"),s.log(a.map(function(r,e){return void 0===r.param?e+": "+r.name+"("+r.varIndexes+")      ---\x3e  "+r.varIndexes.map(function(r){return K(i[r])}).join(",  "):"reifier"===r.name?e+": "+r.name+"["+r.param+"]("+r.varIndexes+")      ---\x3e  "+K(i[r.varIndexes[0]])+" "+r.param+" "+K(i[r.varIndexes[1]])+" = "+K(i[r.varIndexes[2]]):e+": "+r.name+"("+r.varIndexes+") = "+r.param+"      ---\x3e  "+r.varIndexes.map(function(r){return K(i[r])}).join(",  ")+" -> "+K(i[r.param])}).join("\n")),s.log("##/\n")},e._debugSolver=function(){var r=u();r.log("## _debugSolver:\n");var e=this.config,n=e.allVarNames;r.log("# Variables ("+n.length+"x):"),r.log("  index name domain toArr");for(var t=0;t<n.length;++t)r.log("  ",t,":",n[t],":",K(e.initialDomains[t]));var a=e.allConstraints;r.log("# Constraints ("+a.length+"x):"),r.log("  index name vars param");for(var i=0;i<a.length;++i)r.log("  ",i,":",a[i].name,":",a[i].varIndexes.join(","),":",a[i].param);var o=e._propagators;r.log("# Propagators ("+o.length+"x):"),r.log("  index name vars args");for(var f=0;f<o.length;++f)r.log("  ",f,":",o[f].name+("reified"===o[f].name?"("+o[f].arg3+")":""),":",o[f].index1,o[f].index2,o[f].index3,"->",K(e.initialDomains[o[f].index1]),K(e.initialDomains[o[f].index2]),K(e.initialDomains[o[f].index3]));r.log("##")},e._debugConfig=function(){var r=function r(e){switch(typeof e){case"object":if(!e)return null;if(Array.isArray(e))return e.map(function(e){return r(e)});for(var n={},t=0,a=Object.entries(e);t<a.length;t++){var i=a[t],u=i[0],f=i[1];n[u]=r(f)}return n;case"function":for(var s={__THIS_IS_A_FUNCTION:1,__source:""+e},c=0,v=Object.entries(e);c<v.length;c++){var l=v[c],u=l[0],f=l[1];s[u]=r(f)}return s;case"string":case"number":case"boolean":case"undefined":return e;default:o("config value what?",e)}}(this.config);r.initialDomains=r.initialDomains.map(K),u().log("## _debugConfig:\n",t(r))},e.imp=function(r,e){this.logging&&(u().log("      - FD Importing DSL; "+r.length+" bytes"),u().time("      - FD Import Time:"));var n=jn(r,this,e);return this.logging&&u().timeEnd("      - FD Import Time:"),n},e.exp=function(r,e,n,t){return On(this.config,r.vardoms,e,n,t)},r.domainFromList=function(r){return function(r){if(0===r.length)return[];(r=r.slice(0)).sort(function(r,e){return r-e});for(var e,n,t=[],a=0;a<r.length;a++){var i=r[a];0===a?(n=i,e=i):(i>e+1&&(t.push(n,e),n=i),e=i)}return t.push(n,e),t}(r)},r.getTerm=function(){return u()},r.setTerm=function(r){return i(r)},r.dsl=function(){o("FDO.dsl: use FDO.solve()")},r.imp=function(){o("FDO.imp: use FDO.solve()")},r.solve=function(e,n,t){void 0===n&&(n={}),n.max||(n.max=1);var a=new r(n).imp(e,t),i=a.solve(n);return n.returnFdo?a:a.config.aborted?"aborted":0===i.length?"rejected":1!==n.max?i:i[0]},r}();var vt=0,lt=vt++,dt=vt++,pt=vt++,mt=vt++,ht=vt++,gt=vt++,bt=vt++,kt=vt++,yt=vt++,xt=vt++,_t=vt++,wt=vt++,St=vt++,Et=vt++,At=vt++,Nt=vt++,Dt=vt++,Ot=vt++,Ct=vt++,Vt=vt++,jt=vt++,Mt=vt++,Tt=vt++,qt=vt++,Rt=vt++,It=vt++,Lt=vt++,Ut=vt++,Ft=vt++,Bt=vt++,Pt=vt++,Ht=vt++,zt=vt++,Jt=255,$t=3,Wt=5,Gt=7,Qt=3,Yt=Qt+4,Xt=Qt+4+2,Kt=Qt,Zt=Qt+2,ra=Qt+4,ea=ra;function na(r,e,n){switch(n){case mt:case ht:case gt:case kt:case St:return Yt;case lt:return 1;case Nt:case Dt:case qt:case Rt:return Gt;case dt:case pt:case bt:case yt:case xt:case _t:case wt:return r&&e>=0?Qt+2*aa(r,e+1):-1;case Et:case At:case Ot:case Ct:case Vt:case jt:return r&&e>=0?Qt+2*aa(r,e+1)+2:-1;case Mt:case Tt:return r&&e>=0?Qt+2*aa(r,e+1)+2:-1;case Lt:case It:return $t;case Ut:return $t+aa(r,e+1);case Ft:return Wt+ua(r,e+1);case Bt:return 1;case Pt:return 2;case Ht:return 3;case zt:return 4;case Jt:return 1;default:u().log("(ml) unknown op",n," at",e),o("(ml_sizeof) unknown op: "+r[e]," at",e)}}function ta(r,e){return function(r,e){return r[e]}(r,e)}function aa(r,e){return r[e++]<<8|r[e]}function ia(r,e){return aa(r,e)}function ua(r,e){return r[e++]<<24|r[e++]<<16|r[e++]<<8|r[e]}function oa(r,e){return ua(r,e)}function fa(r,e,n){r[e]=n}function sa(r,e,n){r[e++]=n>>8&255,r[e]=255&n}function ca(r,e,n){r.length<50&&r.join(" "),la(r,e,n),r.length<50&&r.join(" ")}function va(r,e,n){switch(r[e+n]){case Bt:return va(r,e,n+1);case Pt:return va(r,e,n+2);case Ht:return va(r,e,n+3);case zt:return va(r,e,n+4);case Ut:return va(r,e,n+$t+ia(r,e+n+1));case Ft:return va(r,e,n+Wt+oa(r,e+n+1))}la(r,e,n)}function la(r,e,n){switch(n){case 0:return o("this is a bug");case 1:return fa(r,e,Bt);case 2:return fa(r,e,Pt);case 3:return fa(r,e,Ht);case 4:return fa(r,e,zt);default:n<65535?(fa(r,e,Ut),sa(r,e+1,n-$t)):(fa(r,e,Ft),function(r,e,n){r[e++]=n>>24&255,r[e++]=n>>16&255,r[e++]=n>>8&255,r[e]=255&n}(r,e+1,n-Wt))}}function da(r){for(var e=0;e<r.length;)switch(r[e]){case lt:if(0!==e)return wa("oops");++e;break;case Jt:return!1;case Bt:++e;break;case Pt:e+=2;break;case Ht:e+=3;break;case zt:e+=4;break;case Ut:e+=$t+aa(r,e+1);break;case Ft:e+=Wt+ua(r,e+1);break;default:return!0}o("ML OOB")}function pa(r,e,n,t,a,i){fa(r,e,t),sa(r,e+1,2),sa(r,e+Kt,a),sa(r,e+Zt,i);var u=Qt+2*n;Yt<u&&la(r,e+Yt,u-Yt)}function ma(r,e,n,t,a){a.sort(function(r,e){return r-e});fa(r,e,t),sa(r,e+1,n);for(var i=0;i<n;++i)sa(r,e+Qt+2*i,a[i])}function ha(r,e,n,t,a){var i=a.length,u=Qt+2*i;fa(r,e,t),sa(r,e+1,i);for(var o=0;o<i;++o)sa(r,e+Qt+2*o,a[o]);u<n&&la(r,e+u,n-u)}function ga(r,e,n,t,a,i,u){fa(r,e,t),sa(r,e+1,2),sa(r,e+Kt,a),sa(r,e+Zt,i),sa(r,e+ra,u);var o=Qt+2*n+2;Xt<o&&la(r,e+Xt,o-Xt)}function ba(r,e,n,t,a,i){var u=ia(r,e+1);fa(r,e,t),sa(r,e+1,2),sa(r,e+Kt,a),sa(r,e+Zt,i);var o=Qt+2*u+2;Yt<o&&la(r,e+Yt,o-Yt)}function ka(r,e,n,t,a){fa(r,e,n),sa(r,e+1,2),sa(r,e+Kt,t),sa(r,e+Zt,a)}function ya(r,e,n,t){var a=[];return function(r,e,n){for(var t=r.length,a=r[e];e<t;){var i=na(r,e,a=r[e]),u=n(r,e,a,i);if(void 0!==u)return u;e+=i}}(r,e,function(r,e,i){if(i===Ut||i===Ft){var u=xa(r,e);if(u>=t){a.push(e);do{--n,u-=t}while(n&&u>=t);if(!n)return!0}}}),!n&&a}function xa(r,e){return na(r,e,r[e])}function _a(r,e,n,t,a,i){var u,f=t&&t.getDomain,s=t&&t.varNames;function c(e){var n=aa(r,e);return"{index="+n+(t&&n<s.length?",name="+s[n]:"")+(t?","+K(f(n)):"")+"}"}function v(e){return aa(r,e)}var l=[];n<0&&(n=r.length);for(var d=e,p=0;p++<n&&d<r.length;){var m="",h=r[d];switch(h){case lt:if(0!==d)return i||wa(r,d,"ML_START at non-zero"),l.push("unused_error(0)"),l.join("\n");break;case mt:m||(m="->");case kt:m||(m="!->");case ht:m||(m="<");case gt:m||(m="<=");case St:m||(m="^"),l.push(c(d+Kt)+" "+m+" "+c(d+Zt));break;case Nt:m||(m="<?");case Dt:m||(m="<=?"),u=c(d+1)+" "+m+" "+c(d+3),l.push(c(d+5)+" = "+u);break;case Mt:m||(m="sum");case Tt:m||(m="product");case Et:m||(m="isall");case At:m||(m="isdiff");case Ot:m||(m="isnall");case Vt:m||(m="issame");case jt:m||(m="issome");case Ct:m||(m="isnone");for(var g="",b=v(d+1),k=0;k<b;++k)g+=c(d+Qt+2*k)+" ";g=m+"("+g+")",g=c(d+Qt+2*b)+" = "+g,l.push(g);break;case dt:m||(m="all");case bt:m||(m="nall");case xt:m||(m="same");case _t:m||(m="some");case yt:m||(m="none");case wt:m||(m="xnor");case pt:m||(m="diff");for(var y="",x=v(d+1),_=0;_<x;++_)y+=c(d+Qt+2*_)+" ";l.push(y=m+"("+y+")");break;case qt:m||(m="-");case Rt:m||(m="/"),u=c(d+1)+" "+m+" "+c(d+3),l.push(c(d+5)+" = "+u);break;case Ut:l.push("jmp("+aa(r,d+1)+")");break;case Ft:l.push("jmp32("+ua(r,d+1)+")");break;case Lt:l.push("nobool("+aa(r,d+1)+")");break;case It:l.push("noleaf("+aa(r,d+1)+")");break;case Bt:l.push("noop(1)");break;case Pt:l.push("noop(2)");break;case Ht:l.push("noop(3)");break;case zt:l.push("noop(4)");break;case Jt:l.push("stop()");break;default:o("add me [pc="+d+", op="+r[d]+"]")}var w=na(r,d,h);(1!==n||a)&&l.push("[90m"+w+"b ("+d+" ~ "+(d+w)+") -> 0x   "+[].concat(r.slice(d,d+Math.min(w,100))).map(function(r){return(r<16?"0":"")+r.toString(16)}).join(" ")+(w>100?"... (trunced)":"")+"[0m"),d+=w}return 1===n?l.join("\n"):" ## ML Debug:\n"+l.join("\n")+"\n ## End of ML Debug"+(e||d<r.length?e?" (did not start at begin of ml!)":" (did not list all ops, ml at "+d+" / "+r.length+"))...":"")+"\n"}function wa(r,e,n){var t=u();t.error("\nThere was an ML related error;",n);var a=r.slice(Math.max(0,e-30),e),i=r.slice(e,e+20);t.error("ML at error (offset="+e+"/"+r.length+"):",a,i),t.error("->",_a(r,e,1,void 0,!0,!0)),o(n)}function Sa(r,e,n){!function(r,e,n){if(r.slice(e,e+2*n),[].fill(0).map(function(n,t){return aa(r,e+2*t)}).join(" "),n<=1)return;!function(r,e,n){r.slice(e,e+2*n);var t=(a=n-1,Math.floor((a-1)/2));var a;for(;t>=0;)Na(r,e,t,n-1),--t}(r,e,n);var t=n-1;for(;t>0;)aa(r,e),aa(r,e+2*t),Da(r,e,e+2*t),[].map.call(r.slice(e,e+2*n),function(r){return(r<16?"0":"")+r.toString(16)}).join(" "),Na(r,e,0,--t)}(r,e,n),[].fill(0).map(function(n,t){return aa(r,e+2*t)}).join(" "),r.slice(e,e+2*n).join(" ")}function Ea(r){return 2*r+1}function Aa(r){return 2*r+2}function Na(r,e,n,t){[].map.call(r.slice(e+2*n,e+2*n+2*(t-n+1)),function(r){return(r<16?"0":"")+r.toString(16)}).join(" ");for(var a=n,i=ia(r,e+2*a),u=Ea(a);u<=t;){Aa(a),aa(r,e+2*a),aa(r,e+2*u),Aa(a)<=t&&aa(r,e+2*Aa(a));var o=ia(r,e+2*u),f=a,s=i;s<o&&(f=u,s=o);var c=Aa(a);if(c<=t){var v=ia(r,e+2*c);s<v&&(f=c,s=v)}if(f===a)return void[].map.call(r.slice(e+2*n,e+2*n+2*(t-n+1)),function(r){return(r<16?"0":"")+r.toString(16)}).join(" ");sa(r,e+2*a,s),sa(r,e+2*f,i),u=Ea(a=f)}r.slice(e+2*n,e+2*n+2*(t-n+1)).join(" ")}function Da(r,e,n){var t=ia(r,e);sa(r,e,ia(r,n)),sa(r,n,t)}var Oa=0,Ca=++Oa,Va=++Oa,ja=1<<++Oa,Ma=1<<++Oa,Ta=1<<++Oa,qa=1<<++Oa,Ra=1<<++Oa,Ia=1<<++Oa,La=1<<++Oa,Ua=1<<++Oa,Fa=1<<++Oa,Ba=1<<++Oa,Pa=1<<++Oa,Ha=1<<++Oa,za=1<<++Oa,Ja=1<<++Oa,$a=1<<++Oa,Wa=1<<++Oa,Ga=1,Qa=20,Ya=4,Xa=Ga+16,Ka=Xa+Qa*Ya;function Za(r,e,n){r.length<50&&r.join(" ");var t=e.getAlias,a=e.getDomain,i=0;return n||(n=new Uint8Array(e.varNames.length*Ka)),n.fill(0),function(){i=0;for(;i<r.length;){var e=i,n=r[i];switch(n){case ht:f(Kt,Va|Ca),f(Zt,Va|Ca),i+=Yt;break;case gt:f(Kt,Ba|Ca),f(Zt,Pa|Ca),i+=Yt;break;case St:f(Kt,$a),f(Zt,$a),i+=Yt;break;case wt:for(var t=ia(r,i+1),a=0;a<t;++a)f(Qt+2*a,Va);i+=Qt+2*t;break;case mt:f(Kt,Ma),f(Zt,Ta),i+=Yt;break;case kt:f(Kt,Va),f(Zt,Va),i+=Yt;break;case dt:for(var s=ia(r,i+1),c=0;c<s;++c)f(Qt+2*c,Va);i+=Qt+2*s;break;case bt:for(var v=ia(r,i+1),l=0;l<v;++l)f(Qt+2*l,Ha);i+=Qt+2*v;break;case xt:for(var d=ia(r,i+1),p=0;p<d;++p)f(Qt+2*p,Va|Ca);i+=Qt+2*d;break;case _t:for(var m=ia(r,i+1),h=0;h<m;++h)f(Qt+2*h,za);i+=Qt+2*m;break;case yt:for(var g=ia(r,i+1),b=0;b<g;++b)f(Qt+2*b,Va);i+=Qt+2*g;break;case Vt:for(var k=ia(r,i+1),y=0;y<k;++y)f(Qt+2*y,La|Ca);f(Qt+2*k,Ua),i+=Qt+2*k+2;break;case jt:for(var x=ia(r,i+1),_=0;_<x;++_)f(Qt+2*_,Va);f(Qt+2*x,Fa),i+=Qt+2*x+2;break;case pt:for(var w=ia(r,i+1),S=0;S<w;++S)f(Qt+2*S,ja|Ca);i+=Qt+2*w;break;case At:for(var E=ia(r,i+1),A=0;A<E;++A)f(Qt+2*A,Va|Ca);f(Qt+2*E,Va),i+=Qt+2*E+2;break;case Nt:f(1,Va|Ca),f(3,Va|Ca),f(5,Va),i+=Gt;break;case Dt:f(1,Ia|Ca),f(3,Ia|Ca),f(5,Va),i+=Gt;break;case qt:case Rt:f(1,Va|Ca),f(3,Va|Ca),f(5,Va|Ca),i+=Gt;break;case Et:for(var N=ia(r,i+1),D=0;D<N;++D)f(Qt+2*D,qa);f(Qt+2*N,Ra),i+=Qt+2*N+2;break;case Ot:case Ct:for(var O=ia(r,i+1),C=0;C<O;++C)f(Qt+2*C,Va);f(Qt+2*O,Va),i+=Qt+2*O+2;break;case Mt:for(var V=ia(r,i+1),j=0;j<V;++j)f(Qt+2*j,Va|Ca);f(Qt+2*V,Ja|Ca),i+=Qt+2*V+2;break;case Tt:for(var M=ia(r,i+1),T=0;T<M;++T)f(Qt+2*T,Va|Ca);f(Qt+2*M,Va|Ca),i+=Qt+2*M+2;break;case lt:if(0!==i)return o(" ! compiler problem @",e);++i;break;case Jt:return;case Lt:f(1,Va|Ca),i+=$t;break;case It:f(1,Va),i+=$t;break;case Ut:i+=$t+ia(r,i+1);break;case Ft:i+=Wt+oa(r,i+1);break;case Bt:++i;break;case Pt:i+=2;break;case Ht:i+=3;break;case zt:i+=4;break;default:u().error("(cnt) unknown op",i," at",i),wa(r,i,"(bnt) expecting bounty to run after the minifier and these ops should be gone")}}wa(r,i,"ML OOB")}(),n;function f(e,u){ui(u);var o=ia(r,i+e);o=t(o);var f=a(o,!0);if(!(L(f)>=0)){var s=o*Ka,c=n[s]++,v=s+Ga;if(c>=255)fi(n,v,Wa);else{var l=oi(n,v);if(ui(l),ui(u),ui(l|u),c<Qa){var d=function(r){return r*Ka+Xa}(o);fi(n,d+c*Ya,i)}fi(n,v,l|u)}}}}function ri(r,e){return r[e*Ka]}function ei(r,e){r[e*Ka]=0}function ni(r,e,n){return oi(r,e*Ka+Ga)}function ti(r,e,n,t){return oi(r,e*Ka+Xa+n*Ya)}function ai(r,e,n){var t=ri(r,e),a="{B: index="+e+", counts="+t+", meta="+ii(r,e);if(n){a+=", offsets:[";for(var i=0;i<Qa;++i)i&&(a+=", "),i>=t&&(a+="("),a+=oi(r,e*Ka+Xa+i*Ya),i>=t&&(a+=")");a+="]"}return a+"}"}function ii(r,e){var n=0|ri(r,e);return 0===n?"[ constant or marked var ]":ui(n&&ni(r,e))}function ui(r){var e="0".repeat(32-r.toString(2).length)+r.toString(2),n=[];return r||n.push("BOUNTY_NONE"),n.push((r&Ca)===Ca?"NOT_BOOLY":"BOOLY"),(r&Va)===Va&&n.push("OTHER"),(r&Ba)===Ba&&n.push("LTE_LHS"),(r&Pa)===Pa&&n.push("LTE_RHS"),(r&qa)===qa&&n.push("ISALL_ARG"),(r&Ra)===Ra&&n.push("ISALL_RESULT"),(r&Ma)===Ma&&n.push("IMP_LHS"),(r&Ta)===Ta&&n.push("IMP_RHS"),(r&Ia)===Ia&&n.push("ISLTE_ARG"),(r&La)===La&&n.push("ISSAME_ARG"),(r&Ua)===Ua&&n.push("ISSAME_RESULT"),(r&Fa)===Fa&&n.push("ISSOME_RESULT"),(r&Ha)===Ha&&n.push("NALL"),(r&ja)===ja&&n.push("DIFF"),(r&za)===za&&n.push("SOME"),(r&Ja)===Ja&&n.push("SUM_RESULT"),(r&$a)===$a&&n.push("XOR"),(r&Wa)===Wa&&n.push("JUST_IGNORE"),"[ "+e+": "+n.join(", ")+" ]"}function oi(r,e){return r[e++]<<24|r[e++]<<16|r[e++]<<8|r[e]}function fi(r,e,n){r[e++]=n>>24&255,r[e++]=n>>16&255,r[e++]=n>>8&255,r[e]=255&n}function si(r,e,n,t){var a=!!t.debugDsl,i=!!t.hashNames,f=!!t.indexNames,s=!!t.groupedConstraints,c=e.varNames,v=e.domains,l=e.valdist,d=e.getDomain,p=e.getAlias,m=e.solveStack,h=e.targeted,g=0,b="",k=r.length;function y(r){return i?"$"+r.toString(36)+"$":f?"_"+r+"_":c[r]}function x(r,e){return e>=0?e:y(r)}function _(r,e){return e>=0?"lit("+e+")":K(r)}function w(r){var e=ri(n,r);return void 0===e?"-":e}var S=[],E=[],A=[],N=0;if(function(){for(;g<k;){var e=g,n=r[g++],t="";switch(n){case lt:case Jt:case Lt:case It:case Bt:case Pt:case Ht:case zt:case Ut:case Ft:break;default:++N}switch(n){case lt:if(1!==g)return o(" ! ml2dsl compiler problem @",e);break;case Jt:return;case Ut:var a=T();a<=0&&o("Must jump some bytes"),g+=a;break;case Ft:var i=r[g++]<<24|r[g++]<<16|r[g++]<<8|r[g++];i<=0&&o("Must jump some bytes"),g+=i;break;case ht:t=F("lt");break;case gt:t=F("lte");break;case St:t=F("xor");break;case mt:t=F("imp");break;case kt:t=F("nimp");break;case dt:t=F("all");break;case pt:t=F("diff");break;case bt:t=F("nall");break;case yt:t=F("none");break;case xt:t=F("same");break;case _t:t=F("some");break;case wt:t=F("xnor");break;case Nt:t=I("<?");break;case Dt:t=I("<=?");break;case Et:t=B("all?");break;case At:t=B("diff?");break;case Ot:t=B("nall?");break;case Ct:t=B("none?");break;case Vt:t=B("same?");break;case jt:t=B("some?");break;case qt:t=I("-");break;case Rt:t=I("/");break;case Mt:t=B("sum");break;case Tt:t=B("product");break;case Lt:var u=q("<debug>",!0);!1!==u&&(t="@custom nobool "+u+"\n");break;case It:var f=q("<debug>",!0);!1!==f&&(t="@custom noleaf "+f+"\n");break;case Bt:g=e+1;break;case Pt:g=e+2;break;case Ht:g=e+3;break;case zt:g=e+4;break;default:wa("(m2d) unknown op",g," at")}S.push(t)}}(),a){var D=[],O=0,C=0,V=0,j=0;v.forEach(function(r,e){var t="";if(!1===r||n&&!w(e))L(r=d(e))>=0?++V:++C;else{++O,d(e),++j,t=": "+y(e)+" ["+Pr(r)+"]";var a=l[e];if(a)switch(a.valtype){case"max":case"mid":case"min":case"naive":t+=" @"+a.valtype;break;case"list":t+=" @"+a.valtype,t+=" prio("+a.list+")";break;case"markov":t+=" # skipping markov dist (no longer supported)";break;case"minMaxCycle":case"splitMax":case"splitMin":default:o("unknown var dist ["+a.valtype+"] "+JSON.stringify(a))}}D[e]=t});var M=v.map(function(r,e){if(!1===v[e])return"";var t=w(e);if(!t)return"";var a=D[e];E[e]&&E[e].map(function(r){return S[r]});var u=A[e].split(/ /g).sort().join(" ");return a+" # T:"+h[e]+"  # ocounts: "+t+(i||!f?"  # index = "+e:"")+"  # ops ("+(u.replace(/[^ ]/g,"").length+1)+"): "+u+" $ meta: "+ii(n,e)+(s&&E[e]?"\n ## "+E[e].map(function(r){return S[r]}).join(" ## "):"")}).filter(function(r){return!!r}).join("\n");b="\n# Constraints: "+N+" x\n# Vars: "+v.length+" x\n#   Aliases: "+C+" x\n#   Domained: "+O+" x\n#    - Solved: "+V+" x\n#    - Unsolved: "+j+" x\n#    - Solve stack: "+m.length+" x (or "+(m.length-C)+" x without aliases)\n",u().log(b),b+="\n# Var decls:\n"+M+"\n\n"}else b+="# vars ("+v.length+"x total):\n",b+=v.map(function(r,e){return[r,e]}).filter(function(r){return!1!==r[0]}).filter(function(r){return!n||w(r[1])>0}).map(function(r){return": "+y(r[1])+" ["+Pr(r[0])+"]"}).join("\n"),b+="\n\n";return b+="\n# Constraints ("+S.length+"x):\n"+S.join(""),b+="\n# Meta:\n"+function(){for(var r=[],n=e.targeted,t=v.length,a=0,i=0,u=0;u<t;++u)!1!==v[u]&&w(u)&&(++a,n[u]?r.push(y(u)):++i);return"@custom targets"+(i&&i.length?"( "+r.join(" ")+" )":" all")+" # "+(a-i)+" / "+a+"\n"}();function T(){return r[g++]<<8|r[g++]}function q(r,e){var t=p(T()),i=d(t),u=L(i);if(u>=0&&e)return!1;if(a){u<0&&(E[t]||(E[t]=[]),E[t].push(S.length),A[t]=(void 0===A[t]?"":A[t]+" ")+r);var o=x(t,u);return o+=" ".repeat(Math.max(45-o.length,3)),o+="# "+_(i,u),o+=" ".repeat(Math.max(110-o.length,3)),o+="# args: "+t,o+=" ".repeat(Math.max(150-o.length,3)),n&&(o+="# counts: "+w(t)+" "),o+=" \n"}return x(t,u)}function R(r,e,t){var i=d(e),u=L(i),o=d(t);return function(r,e,t,i,u,o,f){if(a){i<0&&(E[e]||(E[e]=[]),E[e].push(S.length),A[e]=(void 0===A[e]?"":A[e]+" ")+r),f<0&&(E[u]||(E[u]=[]),E[u].push(S.length),A[u]=(void 0===A[u]?"":A[u]+" ")+r);var s=x(e,i)+" "+r+" "+x(u,f);return s+=" ".repeat(Math.max(45-s.length,3)),s+="# "+_(t,i)+" "+r+" "+_(o,f),s+=" ".repeat(Math.max(110-s.length,3)),s+="# args: "+e+", "+u,s+=" ".repeat(Math.max(150-s.length,3)),n&&(s+="# counts: "+w(e)+" "+r+" "+w(u)+" "),s+=" \n"}return x(e,i)+" "+r+" "+x(u,f)+"\n"}(r,e,i,u,t,o,L(o))}function I(r){return U(r,p(T()),p(T()),p(T()))}function U(r,e,t,i){var u=d(e),o=L(u),f=d(t),s=L(f),c=d(i);return function(r,e,t,i,u,o,f,s,c,v){if(a){i<0&&(E[e]||(E[e]=[]),E[e].push(S.length),A[e]=(void 0===A[e]?"":A[e]+" ")+r),f<0&&(E[u]||(E[u]=[]),E[u].push(S.length),A[u]=(void 0===A[u]?"":A[u]+" ")+r),v<0&&(E[s]||(E[s]=[]),E[s].push(S.length),A[s]=(void 0===A[s]?"":A[s]+" ")+r);var l=x(s,v)+" = "+x(e,i)+" "+r+" "+x(u,f);return l+=" ".repeat(Math.max(45-l.length,3)),l+="# "+_(c,v)+" = "+_(t,i)+" "+r+" "+_(o,f),l+=" ".repeat(Math.max(110-l.length,3)),l+="# indexes: "+s+" = "+e+" "+r+" "+u,l+=" ".repeat(Math.max(150-l.length,3)),n&&(l+="# counts: "+w(s)+" = "+w(e)+" "+r+" "+w(u)+" "),l+="\n"}return x(s,v)+" = "+x(e,i)+" "+r+" "+x(u,f)+"\n"}(r,e,u,o,t,f,s,i,c,L(c))}function F(r){var e=T();if(2===e){if("all"===r)return R("&",p(T()),p(T()));if("diff"===r)return R("!=",p(T()),p(T()));if("imp"===r)return R("->",p(T()),p(T()));if("lt"===r)return R("<",p(T()),p(T()));if("lte"===r)return R("<=",p(T()),p(T()));if("nall"===r)return R("!&",p(T()),p(T()));if("nimp"===r)return R("!->",p(T()),p(T()));if("same"===r)return R("==",p(T()),p(T()));if("some"===r)return R("|",p(T()),p(T()));if("xnor"===r)return R("!^",p(T()),p(T()));if("xor"===r)return R("^",p(T()),p(T()))}for(var t="",i="",u="",o="",f=0;f<e;++f){var s=p(T()),c=d(s),v=L(c);u+=x(s,v)+" ",a&&(v<0&&(E[s]||(E[s]=[]),E[s].push(S.length),A[s]=(void 0===A[s]?"":A[s]+" ")+r),t+=s+" ",n&&(i+=w(s)+" "),o+=_(c,v)+" ")}if(a){var l=r+"( "+u+")";return l+=" ".repeat(Math.max(45-l.length,3)),l+="# "+r+"( "+o+") ",l+=" ".repeat(Math.max(110-l.length,3)),l+="# indexes: "+t,l+=" ".repeat(Math.max(150-l.length,3)),n&&(l+="# counts: "+r+"( "+i+")"),l+="\n"}return r+"( "+u+")\n"}function B(r){return function(r,e){if(2===e){if("diff?"===r)return U("!=?",p(T()),p(T()),p(T()));if("same?"===r)return U("==?",p(T()),p(T()),p(T()));if("sum"===r)return U("+",p(T()),p(T()),p(T()));if("product"===r)return U("*",p(T()),p(T()),p(T()))}for(var t="",i="",u="",o="",f=0;f<e;++f){var s=p(T()),c=d(s),v=L(c);u+=x(s,v)+" ",a&&(v<0&&(E[s]||(E[s]=[]),E[s].push(S.length),A[s]=(void 0===A[s]?"":A[s]+" ")+r),t+=s+" ",n&&(i+=w(s)+" "),o+=_(c,v)+" ")}var l=p(T()),m=d(l),h=L(m);if(a){h<0&&(E[l]||(E[l]=[]),E[l].push(S.length),A[l]=(void 0===A[l]?"":A[l]+" ")+r);var g=x(l,h)+" = "+r+"( "+u+")";return g+=" ".repeat(Math.max(45-g.length,3)),g+="# "+_(m,h)+" = "+r+"( "+o+") ",g+=" ".repeat(Math.max(110-g.length,3)),g+="# indexes: "+l+" = "+t,g+=" ".repeat(Math.max(150-g.length,3)),n&&(g+="# counts: "+w(l)+" = "+r+"( "+i+")"),g+="\n"}return x(l,h)+" = "+r+"( "+u+")\n"}(r,T())}}function ci(r,e){return e?"\n## current remaining problem as dsl:\n"+si(r.ml,r,Za(r.ml,r),{debugDsl:!1,hashNames:!1})+"## end of current remaining problem\n":""}var vi=0,li=1,di=2;function pi(r,e,n){r.length<50&&r.join(" ");var t,a,i=u(),f=e.getDomain,s=e.setDomain,c=e.addAlias,v=e.getAlias,l=e.solveStack,d=e.leafs,p=e.isConstant,m=0,h=!1,g=0,b=0,k=!1;do{i.time("-> cut_loop "+b),t=Za(r,e,t),ci(e),a=l.length,g=0,E(),i.timeEnd("-> cut_loop "+b),i.log("   - end cutter outer loop",b,", removed:",l.length-a," vars, total changes:",g,", emptyDomain =",h,"once=",n),++b}while(!h&&g&&!n&&!k);return h?-1:b+(k?1:0);function y(){++g}function x(r,e){return v(ia(r,e))}function _(r,e,n,t){if(!p(e)){var a=ni(r,e);return n?a:function(r){return(r|Ca)^Ca}(a)}return 0}function w(r,e){return(r&e)===e}function S(r,e){return p(e)?0:ri(r,e)}function E(){for(m=0;m<r.length&&!h&&!k;){var e=r[m];switch(e){case dt:return wa(r,m,"all() should be solved and eliminated");case pt:A(r,m);break;case Rt:m+=Gt;break;case mt:N(r,m);break;case Et:D(r,m);break;case At:O(r,m);break;case Nt:j(r,m);break;case Dt:T(r,m);break;case Ot:I(r,m);break;case Vt:U(r,m);break;case jt:B(r,m);break;case Ct:m+=Qt+2*ia(r,m+1)+2;break;case ht:P(r,m);break;case gt:H(r,m);break;case qt:m+=Gt;break;case bt:z(r,m);break;case kt:m+=Yt;break;case yt:return wa(r,m,"nors should be solved and eliminated");case Tt:m+=Qt+2*ia(r,m+1)+2;break;case xt:return wa(r,m,"eqs should be aliased and eliminated");case _t:J(r,m);break;case Mt:$(r,m);break;case St:Q(r,m);break;case wt:W(r,m);break;case lt:if(0!==m)return wa(r,m," ! compiler problem @");++m;break;case Jt:return;case Lt:case It:m+=$t;break;case Ut:le(r,m,$t+ia(r,m+1));break;case Ft:le(r,m,Wt+oa(r,m+1));break;case Bt:le(r,m,1);break;case Pt:le(r,m,2);break;case Ht:le(r,m,3);break;case zt:le(r,m,4);break;default:u().error("(cut) unknown op",m," at",m),wa(r,m,"(cut) unknown op")}}h||k||o("ML OOB")}function A(r,e){var n=ia(r,e+1),a=x(r,e+Kt),i=S(t,a);if(!(i>1&&i<Qa&&function(r,e,n,a,i){for(var u=0;u<i;++u){var o=ti(t,a,u);if(o!==e){var c=ta(r,o);if(c===pt){var v=ia(r,o+1);if(n>v&&(vr(r,e,n),vr(r,o,v),cr(r,o,v,e,n)))return ve(r,o,v),ca(r,o,Qt+2*v),!0}else if(c===At){var l=ia(r,o+1);if(n>=l&&(vr(r,e,n),vr(r,o,l),cr(r,o,l,e,n))){var d=x(r,o+Qt+2*l),p=f(d),m=Vr(p,0);return p!==m&&s(d,m),ve(r,o,l),ca(r,o,Qt+2*l+2),!0}}else if(c===Vt){var h=ia(r,o+1);if(n<=h&&(vr(r,e,n),vr(r,o,h),cr(r,e,n,o,h))){var g=x(r,o+Qt+2*h),b=f(g),k=Cr(b,0);return b!==k&&s(g,k),ve(r,o,h),ca(r,o,Qt+2*h+2),!0}}}}}(r,e,n,a,i)))if(2===n){var u=x(r,e+Zt),o=S(t,u);if(f(a,!0),f(u,!0),!i||f(a,!0),f(a,!0),!o||f(u,!0),f(u,!0),ii(t,a),ii(t,u),a!==u){if(1===i)return Y(r,e,a,u,a,u);if(1===o)return Y(r,e,u,a,a,u);var c=Ba|Pa|za|Ha|Ma|Ta;if(i>1&&i<=Qa){var v=_(t,a),l=(v&c)>0,d=(v|c|ja)^(c|ja);if(w(v,ja)&&l&&!d&&Br(e,a,i,u))return;if(w(v,ja|$a)&&Hr(r,e,a,i,u))return;if(zr(a,u,i))return}if(o>1&&o<=Qa){var p=_(t,u);if((p&c)>0&&!((p|c|ja)^(c|ja))&&Br(e,u,o,a))return;if(w(p,ja|$a)&&Hr(r,e,u,o,a))return;if(zr(u,a,o))return;var h=f(a,!0),g=f(u,!0);if(wr(h)&&h===g)return fa(r,e,St),ei(t,a),ei(t,u),void y()}m+=Yt}else k=!0}else m+=Qt+2*n}function N(r,e){var n=x(r,e+Kt),a=x(r,e+Zt),i=f(n,!0),u=f(a,!0),o=S(t,n),c=S(t,a);if(ii(t,n),ii(t,a),n!==a){if(!Sr(i)||yr(u))return k=!0,!1;if(1===o)return Z(r,e,n,a,!0);if(1===c)return Z(r,e,n,a,!1);if(o>0){var d=_(t,n);if(d===Ma&&function(r,e,n){ai(t,e);var a=f(e,!0);if(kr(a)||yr(a))return k=!0,!1;for(var i=0;i<n;++i){var u=ti(t,e,i);x(r,u+Kt);var o=x(r,u+Zt);if(kr(o))return f(o),k=!0,!1}for(var c=[],v=0;v<n;++v){var l=ti(t,e,v),d=x(r,l+Zt);c.push(d),ca(r,l,Yt)}s(e,X(a,0)),ei(t,e);for(var p=0,m=c.length;p<m;++p)ei(t,c[p]);return y(),!0}(r,n,o))return;if((d===Ha||d===(Ha|Ma))&&function(r,e,n){if(ai(t,e),f(e),_(t,e)===Ma||_(t,e)===Ha||_(t,e),v(e),yr(f(e,!0)))return k=!0,!1;var a=f(e,!0);if(!kr(a)){var i=Cr(a,0);a!==i&&s(e,i),ei(t,e)}return y(),!0}(0,n))return;if(2===o&&d===(Ma|za)&&function(r,e,n,a){var i=f(n,!0);if(_(t,n),v(n),!_r(i))return!1;var u=x(r,e+Zt);if(!_r(f(u,!0)))return!1;var o=ti(t,n,0),s=ti(t,n,1),c=o===e?s:o,d=ia(r,c+1),p=ce(r,c,d,n);return ca(r,e,Yt),ma(r,c,d,_t,[u].concat(p)),l.push(function(r,e,t,a){var i=t(n),o=i;if(!kr(o=yr(t(u))?Vr(o,0):Cr(o,0))){for(var f=!0,s=0,c=p.length;s<c;++s){var v=t(p[s]);if(yr(v))break;if(Sr(v)){f=!0;break}f=!1}f&&(o=Vr(o,0))}i!==o&&a(n,o)}),ei(t,n),y(),!0}(r,e,n))return;if(w(d,Ra)){if(function(r,e,n,a){ii(t,n),x(r,e+Zt),f(n,!0),f(x(r,e+Zt),!0),ii(t,n),S(t,n),S(t,n),w(_(t,n),Ma|Ra);for(var i=x(r,e+Zt),u=Math.min(a,Qa),o=0;o<u;++o){var s=ti(t,n,o);if(s!==e){var c=ta(r,s);if(c===Et&&pr(e,s,n,i))return!0}}return!1}(r,e,n,o))return;if(2===o&&function(r,e,n,a){var i=x(r,e+Zt);if(f(n),f(i),ii(t,n),ii(t,n),S(t,n),_(t,n),!_r(f(n,!0))||!_r(f(i,!0)))return!1;var u=ti(t,n,0),o=ti(t,n,1),s=u===e?o:u;if(x(r,s+ea),2!==ia(r,s+1))return!1;if(!_r(f(c,!0))||!_r(f(v,!0)))return!1;var c=x(r,s+Kt),v=x(r,s+Zt);return ga(r,s,2,Ot,c,v,n),pa(r,e,2,_t,n,i),ei(t,n),ei(t,i),ei(t,c),ei(t,v),y(),!0}(r,e,n))return}if(o>=3){if(d===(za|Ha|Ma)&&ne(n,o))return;if(d===(za|Ha|Ma|Ta)&&ae(n,o))return}}if(_r(i)&&_r(u))if(2===c)if(_(t,a,!0)===(Ta|Ra)&&gr(a,e,c,n))return;m+=Yt}else k=!0}function D(r,e){var n=ia(r,e+1),a=Qt+2*n+2,i=x(r,e+Qt+2*n),u=S(t,i);if(ii(t,i),!u||f(i,!0),f(i,!0),u>0&&u<Qa){if(1===u)return function(r,e,n,a){var i=ce(r,e,n);l.push(function(r,e,t,u){i.join(" "),t(a),i.map(function(r){return K(t(r))}).join(" ");for(var o=1,f=0;f<n;++f)if(0===e(i[f])){o=0;break}var s=t(a),c=Er(s,o);u(a,c)}),ca(r,e,Qt+2*n+2),ei(t,a),y()}(r,e,n,i);var o=_(t,i);if(o===(Ra|qa)&&function(r,e,n){var a=f(e,!0);if(!_r(a))return!1;for(var i=[],u=[],o=[],s=[],c=[],v=0;v<n;++v){var d=ti(t,e,v);if(c.indexOf(d)<0){for(var p=ia(r,d+1),m=x(r,d+Qt+2*p),h=[],g=!1,b=0;b<p;++b){var k=x(r,d+Qt+2*b);h.push(k),k===e&&(g=!0)}m!==e?i.push(d):g?o.push(d):u.push(d),s.push(h),c.push(d)}}if(u.length)return!1;if(i.length)return function(r,e,n,a,i,u,o,s){if(3!==u)return!1;var c=o[0],v=ia(r,c+1),d=s[0],p=ia(r,d+1),m=x(r,c+Qt+2*v);if(2!==v||2!==p){var h=function(r,e,n,t){for(var a=[],i=0;i<t.length;++i)for(var u=t[i],o=i>=2,s=0;s<u.length;++s){var c=u[s];c!==e&&(!o&&s<2?o=!0:a.push(c))}var v=a.length;if(v){var l=ya(r,0,v,Yt);if(!l)return!1;for(var d=0;d<v;){var p=l.pop(),m=xa(r,p);do{var h=a[d];f(n,!0),f(h,!0),ha(r,p,xa(r,p),mt,[n,h]),++d,m-=Yt,p+=Yt}while(m>=Yt&&d<v)}}return!0}(r,e,m,n);if(!h)return!1}var g=x(r,c+Kt);g===e&&(g=x(r,c+Zt));var b=x(r,d+Kt);b===e&&(b=x(r,d+Zt));return f(e),f(e),f(g),f(m),f(e),ba(r,c,0,mt,m,g),ba(r,d,0,mt,m,b),l.push(function(r,n,t,a){var i=t(e),u=i;0===n(g)?u=Cr(u,0):n(m)?u=Vr(u,0):n(b)>0&&(u=Cr(u,0)),i!==u&&a(e,u)}),ei(t,g),ei(t,b),ei(t,e),ei(t,m),y(),!0}(r,e,s,0,0,n,i,o);return function(r,e,n,a,i){l.push(function(r,t,a,i){a(e);for(var u=!0,o=0,f=n.length;o<f;++o){for(var s=n[o],c=0,v=s.length;c<v;++c){var l=s[c];if(l!==e){var d=a(l);yr(d)||(u=!1)}}if(!u){i(e,Rr(0));break}}});for(var u=0,o=a.length;u<o;++u){var f=a[u],s=n[u];ca(r,f,Qt+2*s.length+2);for(var c=0,v=s.length;c<v;++c)ei(t,s[c])}return y(),!0}(r,e,s,c)}(r,i,u))return;if(2===u&&o===(Ha|Ra)&&function(r,e,n,a){var i=ti(t,e,0),u=ti(t,e,1);_(t,e,!0);var o=i===n?u:i,s=ia(r,o+1),c=ia(r,n+1);if(_(t,e),v(e),x(r,n+Qt+2*c),3!==s)return!1;var l=x(r,o+Qt),d=x(r,o+Qt+2),p=x(r,o+Qt+4);f(l,!0),f(d),f(p);for(var m=0;m<c;++m){var h=x(r,n+Qt+2*m);if(h===l)return jr(r,o,d,p,l);if(h===d)return jr(r,o,l,p,d);if(h===p)return jr(r,o,l,d,p)}return!1}(r,i,e))return;if(o===(Ha|Ra)&&function(r,e,n,a){_(t,e),ii(t,e),v(e),x(r,n+Qt+2*ia(r,n+1));for(var i=ia(r,n+1),u=Qt+2*i+2,o=[],f=0;f<i;++f){var s=x(r,n+Qt+2*f);o.push(s)}for(var c=0,d=0;d<a;++d){var p=ti(t,e,d);if(p!==n){var m=ta(r,p);if(m!==bt)return!1;if(2!==ia(r,p+1))return!1;++c}p===n||x(r,p+Kt)===e||x(r,p+Zt)}var h,g=Qt+2*(i+1),b=c-1;if(b&&!(h=ya(r,0,b,g)))return!1;var k=o.slice(0),y=0;b&&function(r,e,n,t,a){for(var i=0;i<n;){var u=e.pop(),o=xa(r,u);do{if(a(u,i,o))return;++i,o-=t,u+=t}while(o>=t&&i<n);o&&la(r,u,o)}}(r,h,b,g,function(i,u,f){var s;do{if(y>=a)return!0;s=ti(t,e,y++)}while(s===n);return Fr(r,e,o.slice(0),k,s,i,f),!1});var w=ti(t,e,y++);w===n&&(w=ti(t,e,y++));Fr(r,e,o.slice(0),k,w,n,u),l.push(function(r,n,t,a){t(e),k.map(function(r){return K(t(r))});var i=t(e);k.some(function(r){var e=t(r);if(!yr(e)){var a=n(r);if(0===a)return i=Cr(i,0),!0}}),a(e,i)}),ei(t,e);for(var S=0,E=k.length;S<E;++S)ei(t,k[S]);return!0}(r,i,e,u))return}m+=a}function O(r,e){var n=ia(r,e+1),a=x(r,e+Qt+2*n);if(f(a,!0),2===n){var i=x(r,e+Kt),u=x(r,e+Zt),o=S(t,i),s=S(t,u),c=S(t,a);if(f(a,!0),f(i,!0),f(u,!0),!o||f(i,!0),f(i,!0),!s||f(u,!0),f(u,!0),!c||f(a,!0),f(a,!0),ii(t,a),ii(t,i),ii(t,u),1===c)return rr(r,e,i,u,a,a);if(1===o&&(f(i,!0),V(i,u,a)))return rr(r,e,i,u,a,i);if(1===s&&(f(u,!0),V(u,i,a)))return rr(r,e,i,u,a,u);var v=f(a,!0),l=f(i,!0),d=f(u,!0);if(wr(v)){if(wr(l)&&br(d)){if(kr(d))return ba(r,e,0,wt,i,a),ei(t,i),ei(t,u),ei(t,a),void y();if(mr(l)===L(d))return ba(r,e,0,St,i,a),ei(t,i),ei(t,u),ei(t,a),void y()}if(br(l)&&wr(d)){if(kr(l))return ba(r,e,0,wt,u,a),ei(t,i),ei(t,u),ei(t,a),void y();if(mr(d)===L(l))return ba(r,e,0,St,u,a),ei(t,i),ei(t,u),ei(t,a),void y()}}m=e+Xt}else m=e+Qt+2*n+2}function V(r,e,n){f(n,!0),f(r,!0),f(e,!0);var t=f(n,!0);if(yr(t))return!0;var a=f(r,!0),i=f(e,!0),u=G(a,i);return kr(t)?!!u||(s(r,Ur(),!1,!0),!1):u===i&&u!==a}function j(r,e){var n=x(r,e+1),a=x(r,e+3),i=x(r,e+5),u=S(t,n),o=S(t,a),s=S(t,i);return f(i,!0),f(n,!0),f(a,!0),!u||f(n,!0),f(n,!0),!o||f(a,!0),f(a,!0),!s||f(i,!0),f(i,!0),ii(t,i),ii(t,n),ii(t,a),1===s?er(r,e,n,a,i,i):1===u&&M(n,a,i,n,a)?er(r,e,n,a,i,n):1===o&&M(a,n,i,n,a)?er(r,e,n,a,i,a):void(m=e+Gt)}function M(r,e,n,t,a){f(n,!0),f(t,!0),f(a,!0);var i=f(t,!0),u=f(a,!0),o=f(n,!0);return yr(o)?r===t?lr(i)<lr(u):mr(u)>mr(i):kr(o)?r===t?lr(i)>=lr(u):mr(u)<=mr(i):r===t?lr(i)<lr(u)&&mr(i)>=mr(u):mr(u)>mr(i)&&lr(u)<=lr(i)}function T(r,e){var n=x(r,e+1),a=x(r,e+3),i=x(r,e+5),u=S(t,n),o=S(t,a),s=S(t,i);if(f(i,!0),f(n,!0),f(a,!0),!u||f(n,!0),f(n,!0),!o||f(a,!0),f(a,!0),!s||f(i,!0),f(i,!0),ii(t,i),ii(t,n),ii(t,a),Sr(f(i,!0))){if(1===s)return nr(r,e,n,a,i,i);var c=f(n,!0),v=f(a,!0);if(1===u&&R(n,a,n,a,c,v))return nr(r,e,n,a,i,n);if(1===o&&R(a,n,n,a,c,v))return nr(r,e,n,a,i,a);if(s>0&&s<Qa){if(br(c))if(w(_(t,i),Ta))if(w(_(t,a),Ma)&&Mr(e,i,n,a,s))return;if(br(v))if(w(_(t,i),Ta))if(w(_(t,n),Ma)&&qr(e,i,n,a,s))return}m=e+Gt}else k=!0}function R(r,e,n,t,a,i){return f(n,!0),f(t,!0),r===n?lr(a)<=lr(i)&&mr(a)>mr(i):mr(i)>=mr(a)&&lr(i)<lr(a)}function I(r,e){var n=ia(r,e+1),a=Qt+2*n+2,i=x(r,e+Qt+2*n),u=S(t,i);if(!u||f(i,!0),f(i,!0),1===u)return function(r,e,n,a,i){var u=ce(r,e,n);l.push(function(r,e,t,i){t(a),u.map(function(r){return K(t(r))});for(var o=0,f=0;f<n;++f)if(0===e(u[f])){o=1;break}var s=t(a),c=Er(s,o);i(a,c),t(a),t(a),u.some(function(r){return kr(t(r))})}),ca(r,e,Qt+2*n+2),ei(t,a),y()}(r,e,n,i);m+=a}function U(r,e){var n=ia(r,e+1);if(2===n){var a=x(r,e+Kt),i=x(r,e+Zt),u=x(r,e+ra),o=S(t,a),s=S(t,i),c=S(t,u);return f(u,!0),f(a,!0),f(i,!0),!o||f(a,!0),f(a,!0),!s||f(i,!0),f(i,!0),!c||f(u,!0),f(u,!0),ii(t,u),ii(t,a),ii(t,i),1===c?tr(r,e,a,i,u,u):1===o&&(f(a,!0),F(a,i,u))?tr(r,e,a,i,u,a):1===s&&(f(i,!0),F(i,a,u))?tr(r,e,a,i,u,i):void(m=e+Xt)}m=e+Qt+2*n+2}function F(r,e,n){f(n,!0),f(r,!0),f(e,!0);var t=f(n,!0);if(kr(t))return!0;var a=f(r,!0),i=f(e,!0),u=G(a,i);return yr(t)?!!u||(s(r,Ur(),!1,!0),!1):u===i&&u!==a}function B(r,e){var n=ia(r,e+1),a=Qt+2*n+2,i=x(r,e+Qt+2*n);if(1===S(t,i))return function(r,e,n,a){f(n);var i=ce(r,e,a);l.push(function(r,e,t,a){for(var u=!1,o=0;o<i.length;++o){var f=i[o];if(e(f)>0){u=!0;break}}var s=t(n);a(n,s=u?Vr(s,0):Cr(s,0))}),ca(r,e,Qt+2*a+2),ei(t,n),y()}(r,e,i,n);for(var u=0;u<n;++u){var o=x(r,e+Qt+2*u);if(kr(f(o,!0))){k=!0;break}}m+=a}function P(r,e){var n=x(r,e+Kt),a=x(r,e+Zt),i=S(t,n),u=S(t,a);if(f(n,!0),f(a,!0),!i||f(n,!0),f(n,!0),!u||f(a,!0),f(a,!0),ii(t,n),ii(t,a),n!==a)return 1===i?ar(r,e,n,a):1===u?ar(r,e,n,a):void(m+=Yt);k=!0}function H(r,e){var n=x(r,e+Kt),a=x(r,e+Zt),i=S(t,n),u=S(t,a);if(f(n,!0),f(a,!0),!i||f(n,!0),f(n,!0),!u||f(a,!0),f(a,!0),ii(t,n),ii(t,a),n!==a){if(!(1===i&&ir(r,e,n,a,!0)||1===u&&ir(r,e,n,a,!1))){if(i>0){var o=_(t,n);if((o===Ha||o===(Ha|Ba))&&function(r,e,n){if(ai(t,e),f(e),_(t,e)===Ba||_(t,e)===Ha||_(t,e),v(e),yr(f(e,!0)))return!1;for(var a=0;a<n;++a){var i=ti(t,e,a),u=ta(r,i);if(u===gt){x(r,i+Kt),x(r,i+1);var o=x(r,i+Zt);o!==e&&(ei(t,o),ca(r,i,Yt))}else{if(u!==bt)return!1;for(var c=x(r,i+1),l=0;l<c;++l){var d=x(r,i+Qt+2*l);d!==e&&ei(t,d)}ca(r,i,Qt+2*c)}}var p=f(e,!0),m=Cr(p,0);p!==m&&s(e,m);return ei(t,e),y(),!0}(r,n,i))return;if(o===Ba&&function(r,e,n){ai(t,e);for(var a=f(e,!0),i=[],u=0;u<n;++u){var o=ti(t,e,u);x(r,o+Kt);var c=x(r,o+Zt);if(mr(f(c))<lr(a))return f(c),s(c,0),!0;i.push(c),ca(r,o,Yt)}l.push(function(r,n,t,a){for(var u=t(e),o=u,f=0,s=i.length;f<s;++f){var c=i[f];t(c),o=Cr(o,lr(t(c)))}u!==o&&a(e,o)}),ei(t,e);for(var v=0,d=i.length;v<d;++v)ei(t,i[v]);return y(),!0}(r,n,i))return;if(2===i&&o===(Ba|za)&&function(r,e,n,a){var i=f(n,!0);if(_(t,n),v(n),!_r(i))return!1;var u=x(r,e+Zt);if(!_r(f(u,!0)))return!1;var o=ti(t,n,0),s=ti(t,n,1),c=o===e?s:o,d=ia(r,c+1),p=ce(r,c,d,n);return ca(r,e,Yt),ma(r,c,d,_t,[u].concat(p)),l.push(function(r,e,t,a){var i=t(n),o=t(u),f=i;if(mr(f)>lr(o)&&(f=Cr(f,lr(o))),!kr(f)){for(var s=!0,c=0,v=p.length;c<v;++c){var l=t(p[c]);if(yr(l))break;if(Sr(l)){s=!0;break}s=!1}s&&(f=Vr(f,0))}i!==f&&a(n,f)}),ei(t,n),y(),!0}(r,e,n))return;if(i>=3){if(o===(za|Ha|Ba)&&ee(n,i))return;if(o===(za|Ha|Ba|Pa)&&te(n,i))return}if(w(o,Ra)){if(function(r,e,n,a){var i=x(r,e+Zt);f(n),f(i),ii(t,n),ii(t,n),S(t,n),w(_(t,n),Ba|Ra);for(var u=Math.min(a,Qa),o=0;o<u;++o){var s=ti(t,n,o);if(s!==e){var c=ta(r,s);if(c===Et&&dr(e,s,n,i))return!0}}return!1}(r,e,n,i))return;if(2===i&&function(r,e,n,a){var i=x(r,e+Zt);if(f(n),f(i),ii(t,n),ii(t,i),S(t,n),_(t,n),!_r(f(n,!0))||!_r(f(i,!0)))return!1;var u=ti(t,n,0),o=ti(t,n,1),s=u===e?o:u;if(x(r,s+ea),2!==ia(r,s+1))return!1;var c=x(r,s+Kt),v=x(r,s+Zt);if(!_r(f(c,!0))||!_r(f(v,!0)))return!1;return ga(r,s,2,Ot,c,v,n),pa(r,e,2,_t,n,i),ei(t,n),ei(t,i),ei(t,c),ei(t,v),y(),!0}(r,e,n))return}}if(2===u){var c=_(t,a);if(c===(Pa|Ra)&&hr(a,e))return;if(c===(Pa|Ua)&&Ar(a,e,u,n))return}m+=Yt}}else k=!0}function z(r,e){var n=ia(r,e+1),a=x(r,e+Kt),i=S(t,a);if(!(i>1&&i<Qa&&function(r,e,n,a,i){for(var u=0;u<i;++u){var o=ti(t,a,u);if(o!==e){var c=ta(r,o);if(c===bt){var v=ia(r,o+1);if(n<v&&(vr(r,e,n),vr(r,o,v),cr(r,e,n,o,v)))return ve(r,o,v),ca(r,o,Qt+2*v),!0}else if(c===Ot){var l=ia(r,o+1);if(n<=l&&(vr(r,e,n),vr(r,o,l),cr(r,e,n,o,l))){var d=x(r,o+Qt+2*l),p=f(d),m=Vr(p,0);return p!==m&&s(d,m),ve(r,o,l),ca(r,o,Qt+2*l+2),!0}}else if(c===Et){var h=ia(r,o+1);if(n<=h&&(vr(r,e,n),vr(r,o,h),cr(r,e,n,o,h))){var g=x(r,o+Qt+2*h),b=f(g),k=Cr(b,0);return b!==k&&s(g,k),ve(r,o,h),ca(r,o,Qt+2*h+2),!0}}}}}(r,e,n,a,i)))if(2!==n||x(r,e+Kt)!==x(r,e+Zt)){for(var u=0;u<n;++u){var o=x(r,e+Qt+2*u),c=S(t,o);if(c>0)if(_(t,o)===Ha&&Xr(o,c))return!0}m+=Qt+2*n}else k=!0}function J(r,e){var n=ia(r,m+1),a=x(r,e+Kt),i=S(t,a);if(!(i>1&&i<Qa&&function(r,e,n,a,i){for(var u=0;u<i;++u){var o=ti(t,a,u);if(o!==e){var c=ta(r,o);if(c===_t){var v=ia(r,o+1);if(n<v&&(vr(r,e,n),vr(r,o,v),cr(r,e,n,o,v)))return ve(r,o,v),ca(r,o,Qt+2*v),y(),!0}else if(c===jt){var l=ia(r,o+1);if(n<=l&&(vr(r,e,n),vr(r,o,l),cr(r,e,n,o,l))){var d=x(r,o+Qt+2*l),p=f(d),m=Vr(p,0);return p!==m&&s(d,m),ve(r,o,l),ca(r,o,Qt+2*l+2),y(),!0}}else if(c===Ct){var h=ia(r,o+1);if(n<=h&&(vr(r,e,n),vr(r,o,h),cr(r,e,n,o,h))){var g=x(r,o+Qt+2*h),b=f(g),k=Cr(b,0);return b!==k&&s(g,k),ve(r,o,h),ca(r,o,Qt+2*h+2),y(),!0}}}}}(r,e,n,a,i))){if(2===n){var u=x(r,e+Zt);if(a===u)return void(k=!0);if(1===i)return void ur(r,e,a,u,a,u);if(1===S(t,u))return void ur(r,e,u,a,a,u)}for(var o=!1,c=0;c<n;++c){var v=x(r,e+Qt+2*c),l=S(t,v);if(l>0)if(_(t,v)===za&&Zr(v,l))return!0;kr(f(v,!0))&&(o=!0)}o&&(k=!0),m+=Qt+2*n}}function $(r,e){var n=ia(r,e+1),a=e+Qt,i=Qt+2*n+2,u=x(r,a+2*n),o=f(u,!0),s=S(t,u);ii(t,u),!s||f(u,!0),f(u,!0);for(var c=wr(o),v=!0,d=!0,p=Rr(0),h=0,g=0,b=0,w=-1,E=!1,A=0;A<n;++A){var N=x(r,a+2*A),D=f(N,!0),O=lr(D),C=mr(D);p=re(p,D),h+=O,g+=C,O===C?(E=w>=0,b=O,w=A):(wr(D)||(d=!1),_r(D)||(v=!1))}if(!E)if(c&&d&&mr(o)===g)fa(r,e,Et);else{if(1===s){if(p===G(o,p))return function(r,e,n,a){var i=ce(r,e,n);i.map(function(r){return K(f(r))}).join(", "),l.push(function(r,e,n,t){n(a),i.map(function(r){return K(n(r))}).join(", ");for(var u=0,o=0;o<i.length;++o){var f=i[o],s=e(f);u+=s}var c=X(n(a),u);t(a,c)}),ca(r,e,Qt+2*n+2),ei(t,a),y()}(r,e,n,u);if(v&&o===Ir(0,n-1))return function(r,e,n,a){f(a),f(a)===Ir(0,n-1)&&0===lr(f(a))&&f(a);var i=ce(r,e,n);i.map(f).map(K).join(", "),i.map(f).every(_r),l.push(function(r,e,n,t){n(a),i.map(function(r){return K(n(r))});for(var u=n(a),o=0,f=0;f<i.length;++f){var s=i[f],c=n(s),v=L(c);v>=0&&(o+=v)}for(var l=lr(Or(u,o)),d=l-o,p=0;p<i.length;++p){var m=i[p],h=n(m);br(h)||(d>0?(h=Vr(h,0),--d):h=Vr(h,1),e(m,h))}t(a,X(u,l)),n(a),n(a),n(a),i.reduce(function(r,n){return r+e(n)},0)}),function(r,e,n,t,a){Array.isArray(a)&&a.every(function(r){return"number"==typeof r&&r>=0});var i=a.length;fa(r,e,t),sa(r,e+1,i);for(var u=0;u<i;++u)sa(r,e+Qt+2*u,a[u]);var o=Qt+2*n+2,f=Qt+2*i;f<o&&la(r,e+f,o-f)}(r,e,n,bt,i),ei(t,a),y()}(r,e,n,u);if(v&&o===Ir(1,n))return function(r,e,n,a){var i=ce(r,e,n);l.push(function(r,e,t,u){t(a),i.map(function(r){return K(t(r))});for(var o=!0,f=-1,s=0;s<n;++s){var c=i[s],v=t(c);if(yr(v)){o=!1;break}kr(v)||(f=c)}if(o){var l=t(f);u(f,l=Vr(l,0))}for(var d=0,p=0;p<n;++p)d+=e(i[p]);var m=t(a);u(a,m=X(m,d))}),fa(r,e,_t),sa(r,e+1,n);for(var u=0;u<n;++u)sa(r,e+Qt+2*u,i[u]);la(r,e+Qt+2*n,2),ei(t,a),y()}(r,e,n,u)}if(s>=2){var V=_(t,u);if(d&&2===s){if(V===(La|Ja)&&function(r,e,n,a,i,u,o,s,c,v,l){var d=ti(t,n,0),p=ti(t,n,1),m=d===e?p:d;if(ii(t,n),_(t,n),ii(t,n),2!==ia(r,m+1))return!1;var h=x(r,m+Kt),g=x(r,m+Zt),b=x(r,m+ea),y=h;y===n&&(y=g);f(b),f(n),f(y);var w=f(n,!0),S=f(y,!0),E=L(S);if(E>=0&&!q(w,E))return k=!0,!1;var A=G(w,u);if(A!==u)return!1;if(l&&E===s)return fa(r,e,Et),ie(e,m,i,n,b,y,c,v);if(E>=0)return function(r,e,n,t,a,i,u,o,f,s,c){if(o===s)fa(r,e,Ct);else{if(o!==f)return!1;fa(r,e,Et)}return ie(e,a,n,t,i,u,s,c)}(r,e,i,n,m,b,y,E,s,c,v);return function(r,e,n,t,a,i,u,o,f,s){if(o===Ir(f+1,f+n-(f?1:0)))fa(r,e,jt);else{if(o!==Ir(f,f-(f?1:0)+(n-1)))return!1;fa(r,e,Ot)}return ie(e,a,n,t,i,u,f,s)}(r,e,i,n,m,b,y,S,c,v)}(r,e,u,0,n,p,0,g,b,w,d))return;if(V===(Ia|Ja)&&function(r,e,n,a,i,u,o,s,c){var v=ti(t,n,0),d=ti(t,n,1),p=v===e?d:v;ii(t,n),_(t,n),ii(t,n);var m=x(r,p+1),h=x(r,p+3),g=x(r,p+5),b=m;b===n&&(b=h);var w=L(f(b,!0));if(w<0)return!1;var S=f(n,!0);if(!q(S,w))return k=!0,!1;var E=Ir(u,o),A=G(S,E);if(A!==E)return!1;var N=0;if(m===n)if(w===s)N=Ct;else{if(w!==s-(s?1:0)+(i-1))return!1;N=Ot}else if(w===s+1)N=jt;else{if(w!==s-(s?1:0)+i)return!1;N=Et}fa(r,e,N);var D=oe(s,c,i,e),O=ce(r,e,D);return sa(r,e+Qt+2*D,g),l.push(function(r,e,t,a){var i=t(g),u=t(n);Sr(i)||a(g,i=b===m?w<=lr(u)?Vr(i,0):Cr(i,0):mr(u)<=w?Vr(i,0):Cr(i,0)),t(g),t(n),t(b),t(g),t(n),O.every(t),t(g),t(n),t(g),t(n)}),fe(n,O,s),ca(r,p,Gt),ei(t,n),y(),!0}(r,e,u,0,n,h,g,b,w))return}if(3===s&&2===n&&V===(La|Ja)&&function(r,e,n,a,i,u){var o=ti(t,n,0),s=ti(t,n,1);o===e||s===e||ti(t,n,2),o===e?o=ti(t,n,2):s===e&&(s=ti(t,n,2));if(ta(r,o)!==Vt||ta(r,s)!==Vt)return!1;var c=ia(r,o+1),v=ia(r,s+1);if(2!==c||2!==v)return!1;var d=x(r,e+Kt),p=x(r,e+Zt),m=f(d,!0),h=f(p,!0);if(!_r(m)||!_r(h))return!1;var g=x(r,o+Kt),b=x(r,o+Zt),k=x(r,o+ea),_=x(r,s+Kt),w=x(r,s+Zt),S=x(r,s+ea),E=g;E===n&&(E=b);var A=_;A===n&&(A=w);var N=f(E,!0),D=L(N),O=f(A,!0),C=L(O);if(f(k,!0),f(g,!0),f(b,!0),f(S,!0),f(_,!0),f(w,!0),1!==D&&2!==D||1!==C&&2!==C||D===C)return!1;return l.push(function(r,e,t,a){var i=t(n),u=X(i,e(d)+e(p));i!==u&&a(n,u),t(d),t(p),t(n),t(d),t(p),t(n),t(n),t(d),t(p)}),fa(r,e,Et),sa(r,e+ra,2===D?k:S),fa(r,o,At),sa(r,o+Kt,d),sa(r,o+Zt,p),sa(r,o+ea,1===D?k:S),ca(r,s,Xt),ei(t,d),ei(t,p),ei(t,n),ei(t,k),ei(t,E),ei(t,S),ei(t,A),y(),!0}(r,e,u))return;if(s<Qa&&function(r,e,n,a,i,u){ii(t,n),_(t,n);var o=f(n,!0);if(!wr(o))for(var s=0;s<a;++s){var c=ti(t,n,s);if(c!==e){var v=ta(r,c),d=ue(v,!0,r,c,n);if(d===vi)return}}if(i!==G(o,i))return!1;var p=ce(r,e,u),m=o;return l.push(function(r,e,t,a){for(var i=0,o=0;o<u;++o)i+=e(p[o]);var f=X(m,i);m!==f&&a(n,f,!1,!0)}),fa(r,e,jt),ei(t,n),y(),!0}(r,e,u,s,p,n))return}m+=i}}function W(r,e){var n=ia(r,e+1);if(2===n){var a=x(r,e+Kt),i=x(r,e+Zt),u=S(t,a),o=S(t,i);if(f(a,!0),f(i,!0),!u||f(a,!0),f(a,!0),!o||f(i,!0),f(i,!0),ii(t,a),ii(t,i),a===i)return void(k=!0);if(1===u)return or(r,e,a,i,a,i);if(1===o)return or(r,e,i,a,a,i);if(u>0&&o>0){var s=_(t,a,!0),c=_(t,i,!0);ii(t,a),ii(t,i);var v=!w(s,Ca),l=!w(c,Ca);if(v||l)return function(r,e,n,a,i,u){var o=i,f=n;u||(o=n,f=i);se(f,o),ca(r,e,Yt),ei(t,n),ei(t,i),y()}(r,e,a,0,i,l)}}m+=Qt+2*n}function Q(r,e){var n=x(r,e+Kt),a=x(r,e+Zt),i=S(t,n),u=S(t,a);if(f(n,!0),f(a,!0),ii(t,n),ii(t,a),!i||f(n,!0),f(n,!0),!u||f(a,!0),f(a,!0),n!==a){if(1===i)return sr(r,e,n,a,n,a);if(1===u)return sr(r,e,a,n,n,a);var o=f(n,!0),s=f(a,!0);if(Sr(o)&&Sr(s)){if(i>0&&u>0){var c=_(t,n,!0),v=_(t,a,!0),l=!w(c,Ca),d=!w(v,Ca),p=za|Ha|Ma|Ta|$a;if(i<Qa){if((c&p)===c&&Pr(e,n,i,a))return;if(2===i){if(w(c,Ra)&&$r(n,a,e,i))return;if(l&&w(c,Fa)&&Gr(n,a,e,i))return;if(c===($a|za)&&Yr(n,a,e))return}if(Jr(n,a,i,s,fr(s),d))return}if(u<Qa){if(wr(s)&&(v&p)===v&&Pr(e,a,u,n))return;if(2===u){if(w(v,Ra)&&$r(a,n,e,u))return;if(d&&w(v,Fa)&&Gr(a,n,e,u))return;if(v===($a|za)&&Yr(a,n,e))return}if(Jr(a,n,u,o,fr(o),l))return}}m+=Yt}else k=!0}else k=!0}function Y(r,e,n,a,i,u){l.push(function(r,e,n,t){n(i),n(u);var a=n(i),o=n(u);if(fr(a)<fr(o)){var f=e(i);t(u,Vr(o,f))}else{var s=e(u);t(i,Vr(a,s))}n(i),n(u)}),ca(r,e,Yt),ei(t,n),ei(t,a),y()}function Z(r,e,n,a,i){l.push(function(r,e,t,u){t(n),t(a),t(n),t(a);var o=t(n),f=t(a);if(i)if(yr(f)){var s=Vr(o,0);o!==s&&u(n,s)}else{var c=X(o,0);o!==c&&u(n,c)}else if(yr(o)){var v=Vr(f,0);o!==v&&u(a,v)}else{var l=X(f,0);f!==l&&u(a,l)}}),ca(r,e,Yt),ei(t,n),ei(t,a),y()}function rr(r,e,n,a,i,u){f(i),f(n),f(a),l.push(function(r,e,t,u){var o=t(n),f=t(a),s=t(i);if(br(o))br(f)?u(i,s=o!==f?Vr(s,0):Cr(s,0)):Sr(s)?(u(a,f=Vr(f,L(o))),u(i,s=Vr(s,0))):u(a,kr(s)?o:f=Vr(f,L(o)));else if(br(f))Sr(s)?(u(n,o=Vr(o,L(f))),u(i,s=Vr(s,0))):u(n,kr(s)?f:o=Vr(o,L(f)));else if(Sr(s))G(o,f)!==C&&(f=Vr(f,e(n)),u(a,f)),u(i,s=Vr(s,0));else if(kr(s)){var c=e(n,G(o,f));u(a,f=Rr(c))}else{var v=e(n);u(a,f=Vr(f,v))}t(i),t(n),t(a),t(n),t(a),t(n),t(a),t(i),G(t(n),t(a))===C||br(t(n))||t(a),t(i),t(n),t(a),t(i)}),ca(r,e,Xt),ei(t,n),ei(t,a),ei(t,i),y()}function er(r,e,n,a,i,u){f(i),f(n),f(a),l.push(function(r,e,t,u){t(i),t(n),t(a);var o=t(n),f=t(a),s=t(i);if(Sr(s)){var c=e(n),v=e(a);u(i,s=c<v?Vr(s,0):Cr(s,0))}else kr(s)?(o=Rr(mr(o)),f=Rr(lr(f)),u(n,o),u(a,f)):(o=Rr(lr(o)),f=Rr(mr(f)),u(n,o),u(a,f));t(i),t(n),t(a),t(n),t(a),t(i),t(i),t(i),t(n),t(a)}),ca(r,e,Gt),ei(t,n),ei(t,a),ei(t,i),y()}function nr(r,e,n,a,i,u){f(i),f(n),f(a),l.push(function(r,e,t,u){t(i),t(n),t(a);var o=t(n),f=t(a),s=t(i);if(Sr(s)){var c=e(n),v=e(a);u(i,s=c<=v?Vr(s,0):Cr(s,0))}else kr(s)?(o=Rr(mr(o)),f=Rr(lr(f)),u(n,o),u(a,f)):(o=Rr(lr(o)),f=Rr(mr(f)),u(n,o),u(a,f));t(i),t(n),t(a),t(n),t(a),t(i),t(i),t(i),t(n),t(a)}),ca(r,e,Gt),ei(t,n),ei(t,a),ei(t,i),y()}function tr(r,e,n,a,i,u){f(i),f(n),f(a),l.push(function(r,e,t,u){t(i),t(n),t(a);var o=t(n),f=t(a),s=G(o,f),c=t(i);if(br(c))kr(c)?s&&(br(o)?u(a,Vr(f,L(o))):u(n,Vr(o,e(a)))):(e(n,s),e(a,t(n)));else{if(s)if(br(o))c=Er(c,o===f);else if(br(f))u(n,f),c=Er(c,!0);else{var v=Rr(lr(s));u(n,v),u(a,v),c=Er(c,!0)}else c=Er(c,!1);u(i,c)}t(i),t(n),t(a),t(i),br(t(n))||br(t(a))||(t(n),t(a)),t(n),t(a),t(i),!!kr(t(i))||br(t(n))&&t(a)}),ca(r,e,Xt),ei(t,n),ei(t,a),ei(t,i),y()}function ar(r,e,n,a,i){l.push(function(r,e,t,i){t(n),t(a);var u=t(n),o=t(a),f=mr(u),s=lr(o);if(f<s);else if(lr(u)>=s){var c=lr(u);i(n,Cr(u,c)),i(a,Dr(o,c))}else i(n,Nr(u,s));t(n),t(a),t(n),t(a),t(n),t(a)}),ca(r,e,Yt),ei(t,n),ei(t,a),y()}function ir(r,e,n,a,i){var u=f(n,!0),o=f(a,!0),c=lr(u),v=mr(o),d=Cr(u,v),p=Or(o,c);return!d||br(d)||!p||br(p)?(k=!0,!1):(u!==d&&s(n,d),o!==p&&s(a,p),l.push(function(r,e,t,u){t(n),t(a),t(n),t(a);var o=t(n),f=t(a),s=mr(o),c=lr(f);if(s>c)if(i){var v=Cr(o,c);u(n,v)}else{var l=Or(f,s);u(a,l)}t(n),t(a),t(n),t(a)}),ca(r,e,Yt),ei(t,n),ei(t,a),y(),!0)}function ur(r,e,n,a,i,u){l.push(function(r,e,t,i){var u=t(a),o=t(n);kr(u)?i(n,Vr(o,0)):kr(o)?i(a,Vr(u,0)):yr(u)||yr(u)||i(n,Vr(o,0))}),ca(r,e,Yt),ei(t,n),ei(t,a),y()}function or(r,e,n,a,i,u){l.push(function(r,e,n,t){n(i),n(u);var a=n(i),o=n(u);kr(a)?t(u,Cr(o,0)):kr(o)?t(i,Cr(a,0)):yr(a)?t(u,Vr(o,0)):yr(o)?t(i,Vr(a,0)):(t(i,Vr(a,0)),t(u,Vr(o,0)))}),ca(r,e,Yt),ei(t,n),ei(t,a),y()}function sr(r,e,n,a,i,u){l.push(function(r,e,n,t){n(i),n(u);var a=n(i),o=n(u);kr(a)?t(u,Vr(o,0)):kr(o)?t(i,Vr(a,0)):yr(a)?t(u,Cr(o,0)):yr(o)?t(i,Cr(a,0)):(t(i,Vr(a,0)),t(u,Cr(o,0)))}),ca(r,e,Yt),ei(t,n),ei(t,a),y()}function cr(r,e,n,t,a){for(var i=0,u=0,o=ia(r,e+Qt+2*i),f=0;u<a;){for(f=ia(r,t+Qt+2*u);o===f;){if(++i>=n)return!0;o=ia(r,e+Qt+2*i)}++u}return!1}function vr(r,e,n){for(var t=0;t<n;++t){var a=e+Qt+2*t,i=ia(r,a),u=v(i);i!==u&&sa(r,a,u)}Sa(r,e+Qt,n)}function dr(e,n,a,i){for(var u=ia(r,n+1),o=(x(r,n+Qt+2*u),0);o<u;++o){if(x(r,n+Qt+2*o)===i)return ca(r,e,Yt),ei(t,a),ei(t,i),y(),!0}return!1}function pr(e,n,a,i){for(var u=ia(r,n+1),o=(x(r,n+Qt+2*u),0);o<u;++o){if(x(r,n+Qt+2*o)===i)return ca(r,e,Yt),ei(t,a),ei(t,i),y(),!0}return!1}function hr(e,n,a){var i=ti(t,e,0),u=ti(t,e,1),o=n===i?u:i;_(t,e),x(r,ta(r,o)===Et?o+Qt+2*ia(r,o+1):o+5);var s=x(r,n+Kt),c=f(s,!0);x(r,n+Zt);var v=f(e,!0);if(mr(c)>1&&mr(v)>1)return!1;if(yr(v))return k=!0,!1;if(mr(c)>mr(v))return k=!0,!1;for(var d=ia(r,o+1),p=mr(c),m=0;m<d;++m){var h=x(r,o+Qt+2*m),g=f(h,!0);if(mr(g)<p)return!1}if(d<2)return!1;if(d>2&&!function(r,e,n,t){var a=n-2,i=ya(r,0,a,Yt);if(!i)return!1;var u=0;for(;u<a;){var o=i.pop(),s=xa(r,o);do{var c=x(r,e+Qt+2*(u+2));f(t,!0),f(c,!0),fa(r,o,gt),sa(r,o+1,2),sa(r,o+Kt,t),sa(r,o+Zt,c),++u,s-=Yt,o+=Yt}while(s>=Yt&&u<a);s&&la(r,o,s)}return!0}(r,o,d,s))return!1;var b=x(r,o+Kt),w=x(r,o+Zt);ei(t,s),ei(t,e);var S=ce(r,o,d);return pa(r,n,2,gt,s,b),ba(r,o,0,gt,s,w),l.push(function(r,n,t,a){t(s),t(e),t(e),S.map(function(r){return K(t(r))});var i=t(e);i=Or(i,mr(t(s)));for(var u=!1,o=0;o<S.length;++o){var f=t(S[o]);if(kr(f)||!yr(i)&&0===n(f)){t(S[o]),u=!0;break}}a(e,i=u?Cr(i,0):Vr(i,0))}),y(),!0}function gr(e,n,a,i){var u=ti(t,e,0),o=ti(t,e,1),s=n===u?o:u;_(t,e),x(r,ta(r,s)===Et?s+Qt+2*ia(r,s+1):s+5),x(r,n+Kt);var c=f(i,!0);x(r,n+Zt);var v=f(e,!0);if(mr(c)>1&&mr(v)>1)return!1;if(yr(v))return k=!0,!1;if(mr(c)>mr(v))return k=!0,!1;var d=ia(r,s+1);if(d<2)return k=!0,!1;if(d>2&&!function(r,e,n,t){var a=n-2,i=ya(r,0,a,Yt);if(!i)return!1;var u=0;for(;u<a;){var o=i.pop(),s=xa(r,o);do{var c=x(r,e+Qt+2*(u+2));f(t,!0),f(c,!0),fa(r,o,mt),sa(r,o+1,2),sa(r,o+Kt,t),sa(r,o+Zt,c),++u,s-=Yt,o+=Yt}while(s>=Yt&&u<a);s&&la(r,o,s)}return!0}(r,s,d,i))return!1;var p=x(r,s+Kt),m=x(r,s+Zt);ei(t,i),ei(t,e);var h=ce(r,s,d);return pa(r,n,2,mt,i,p),ba(r,s,0,mt,i,m),l.push(function(r,n,t,a){t(i),t(e),t(e),h.map(function(r){return K(t(r))});var u=t(e),o=t(i),f=!1,s=!1;yr(o)&&(f=!0);for(var c=!0,v=0;v<d;++v){var l=h[v],p=t(l);if(kr(p)){s=!0,c=!1;break}xr(p)&&(c=!1)}c&&(f=!0);var m=!1;f?(a(e,Vr(u,0)),m=!0):s?(a(e,Cr(u,0)),m=!1):m=n(e)>0,t(i),h.map(function(r){return K(t(r))}),m||a(i,Cr(o,0));for(var g=0;g<d;++g){var b=h[g],k=t(b);if(m)a(b,Vr(k,0));else{if(kr(k))break;if(xr(k)){a(b,Cr(k,0));break}}}t(i),h.map(function(r){return K(t(r))}),t(i),t(e),h.some(function(r){return!t(r)}),yr(t(i))&&t(e),kr(t(e))&&t(i),t(e),t(e),h.some(function(r){return kr(t(r))})}),y(),!0}function Ar(e,n,a,i){var u=ti(t,e,0),o=ti(t,e,1),s=u===n?o:u;if(x(r,s+ea),2!==ia(r,s+1))return!1;var c=x(r,s+Kt),v=x(r,s+Zt),l=f(c,!0),d=f(v,!0),p=f(i,!0),m=f(e,!0);return!!(_r(l)&&_r(d)&&_r(p)&&_r(m))&&(pa(r,n,2,mt,i,e),ei(t,i),ei(t,e),y(),!0)}function jr(r,e,n,a,i){return sa(r,e+1,2),sa(r,e+Kt,n),sa(r,e+Zt,a),fa(r,e+ra,Pt),ei(t,i),ei(t,n),ei(t,a),y(),!0}function Mr(e,n,a,i,u){for(var o=0;o<u;++o){var f=ti(t,n,o);if(f!==e)if(ta(r,f)===mt&&x(r,f+Kt)===i&&x(r,f+Zt)===n)return Tr(n,a,i,e,f)}return!1}function Tr(e,n,a,i,u){f(n);var o=f(n,!0),c=f(a,!0),v=L(o);if(v<=lr(c))return k=!0,!1;if(v>mr(c))return k=!0,!1;f(n),f(a),f(e);var l=Kr([0,0,v,mr(c)]),d=G(c,l);return c===d||(s(a,d),d)?(pa(r,u,2,wt,e,a),ca(r,i,Gt),ei(t,a),ei(t,e),y(),!0):h=!0}function qr(e,n,a,i,u){for(var o=0;o<u;++o){var f=ti(t,n,o);if(f!==e)if(ta(r,f)===mt&&x(r,f+Kt)===a&&x(r,f+Zt)===n)return Lr(n,a,i,e,f)}return!1}function Lr(e,n,a,i,u){f(a);var o=f(e,!0);if(!(o=Vr(o,0)))return h=!0,!1;var c=f(n,!0);return L(f(a,!0))<=lr(c)?(k=!0,!1):(f(n),f(a),f(e),s(e,o),pa(r,u,2,gt,n,a),ca(r,i,Gt),ei(t,n),ei(t,a),ei(t,e),y(),!0)}function Fr(r,e,n,t,a,i,u){var o=x(r,a+Kt),s=x(r,a+Zt),c=o===e?s:o;f(c,!0),n.push(c),t.push(c),ha(r,i,u,bt,n),a!==i&&ca(r,a,Yt)}function Br(e,n,a,i){if(f(n),f(i),ii(t,n),ii(t,i),!wr(f(n)))return!1;for(var u=[],o=[],s=[],c=[],v=[],p=[],m=[],h=[],g=[],b=[],_=[],w=[],S=0;S<a;++S){var E=ti(t,n,S),A=ta(r,E);if(2!==ia(r,E+1))return!1;var N=x(r,E+Kt),D=x(r,E+Zt),O=f(N,!0),C=f(D,!0);if(!wr(N===n?C:O))return!1;var V=N===n?D:N;if(A===gt){if(mr(O)>mr(C)||lr(C)<lr(O))return k=!0,!1;N===n?(u.push(E),o.push(V)):(s.push(E),c.push(V))}else if(A===mt)N===n?(g.push(E),b.push(V)):(_.push(E),w.push(V));else if(A===pt){if(e!==E)return!1}else A===_t?(v.push(E),p.push(V)):(m.push(E),h.push(V))}for(var j=0,M=u.length;j<M;++j){var T=u[j],q=x(r,T+Kt);q===n&&(q=x(r,T+Zt)),ei(t,q),pa(r,T,2,_t,q,i)}for(var R=0,I=s.length;R<I;++R){var U=s[R],F=x(r,U+Kt);F===n&&(F=x(r,U+Zt)),ei(t,F),pa(r,U,2,bt,F,i)}for(var B=0,P=v.length;B<P;++B){var H=v[B],z=x(r,H+Kt);z===n&&(z=x(r,H+Zt)),ei(t,z),pa(r,H,2,gt,i,z)}for(var J=0,$=m.length;J<$;++J){var W=m[J],G=x(r,W+Kt);G===n&&(G=x(r,W+Zt)),ei(t,G),pa(r,W,2,gt,G,i)}for(var Q=0,Y=g.length;Q<Y;++Q){var K=g[Q],Z=x(r,K+Kt);Z===n&&(Z=x(r,K+Zt)),ei(t,Z),pa(r,K,2,_t,Z,i)}for(var rr=0,er=_.length;rr<er;++rr){var nr=_[rr],tr=x(r,nr+Kt);tr===n&&(tr=x(r,nr+Zt)),ei(t,tr),pa(r,nr,2,bt,tr,i)}return ca(r,e,Yt),d.push(n),l.push(function(r,e,t,a){var u=t(n),f=t(i);t(i);for(var s=u,v=lr(u),l=mr(u),d=0;d<o.length;++d){var m=o[d],g=t(m);if(l>lr(g)){var k=mr(g);k>=l?a(m,g=Or(g,l)):(a(m,g=X(g,k)),u=Cr(u,k))}}for(var y=0;y<c.length;++y){var x=c[y],_=t(x),S=mr(_);if(v<S){var E=lr(_);E<=v?a(x,_=Cr(_,v)):(a(x,_=X(_,E)),u=Or(u,S))}}for(var A=0;A<p.length;++A){var N=p[A],D=t(N);t(N),kr(D)?u=Vr(u,0):xr(D)&&a(N,D=Vr(D,0))}for(var O=0;O<h.length;++O){var C=h[O],V=t(C);yr(V)?u=Cr(u,0):yr(V)&&a(C,V=Cr(V,0))}for(var j=0;j<b.length;++j){var M=b[j],T=t(M);yr(T)||kr(u)||(kr(T)?u=Cr(u,0):yr(T)?u=Vr(u,0):a(M,Vr(T,0)))}for(var q=0;q<w.length;++q){var R=w[q],I=t(R);yr(I)?u=Cr(u,0):Sr(I)&&(I=Vr(I,0))}t(i),br(u)?a(i,f=Vr(f,L(u))):u=Vr(u,e(i)),u!==s&&a(n,u)}),ei(t,n),ei(t,i),y(),!0}function Pr(e,n,a,i){if(f(n),f(i),ii(t,n),ii(t,i),!Sr(f(n)))return!1;for(var u=[],o=[],s=[],c=[],v=0;v<a;++v){var p=ti(t,n,v),m=ta(r,p);if(2!==ia(r,p+1))return!1;var h=x(r,p+Kt),g=x(r,p+Zt);f(h,!0),f(g,!0);var b=h===n?g:h;if(0===ri(t,b))return!1;if(!wr(f(b,!0))&&w(ni(t,b),Ca))return!1;if(m===mt)h===n?s.indexOf(p)<0&&s.push(p):c.indexOf(p)<0&&c.push(p);else if(m===St){if(e!==p)return!1}else m===_t?u.indexOf(p)<0&&u.push(p):o.indexOf(p)<0&&o.push(p)}for(var k=0,_=u.length;k<_;++k){var S=u[k],E=x(r,S+Kt);E===n&&(E=x(r,S+Zt)),ei(t,E),pa(r,S,2,mt,i,E)}for(var A=0,N=o.length;A<N;++A){var D=o[A],O=x(r,D+Kt);O===n&&(O=x(r,D+Zt)),ei(t,O),pa(r,D,2,mt,O,i)}for(var C=0,V=s.length;C<V;++C){var j=s[C],M=x(r,j+Kt);M===n&&(M=x(r,j+Zt)),ei(t,M),pa(r,j,2,_t,M,i)}for(var T=0,q=c.length;T<q;++T){var R=c[T],I=x(r,R+Kt);I===n&&(I=x(r,R+Zt)),ei(t,I),pa(r,R,2,bt,I,i)}return ca(r,e,Yt),d.push(n),l.push(function(r,e,t,a){var u=t(n);t(i),u=0===e(i)?Vr(u,0):Cr(u,0),a(n,u)}),ei(t,n),ei(t,i),y(),!0}function Hr(r,e,n,a,i){for(var u=0,o=0;o<a;++o){var s=ti(t,n,o);ta(r,s)===St&&(u=s)}if(2!==ia(r,u+1))return!1;x(r,u+Kt)===n||x(r,u+Zt);var c=x(r,u+Kt);c===n&&(c=x(r,u+Zt));var v=f(i,!0),l=f(c,!0),d=f(n,!0);return!(!wr(v)||!wr(l)||G(d,v)!==v||G(d,l)!==l)&&(ca(r,e,Yt),se(c,i),y(),!0)}function zr(e,n,a){var i=f(e),u=f(n);if(i===u&&2===fr(i))for(var o=0;o<a;++o){var s=ti(t,e,o);if(ta(r,s)===pt){if(2!==ia(r,s+1))continue;var v=x(r,s+Kt),l=x(r,s+Zt);f(v),f(l);var d=void 0;if(v===e){if(l===n)continue;d=l}else{if(v===n)continue;d=v}var p=f(d);if(i===p)return c(d,n,"double bin diff"),ca(r,s,Yt),ei(t,e),ei(t,n),ei(t,d),y(),!0}}return!1}function Jr(e,n,a,i,u,s){var v=2===u;if(f(e),!s&&!v)return!1;for(var l=0;l<a;++l){var d=ti(t,e,l);if(ta(r,d)===St){var p=x(r,d+Kt),m=x(r,d+Zt),h=void 0;if(p===e){if(m===n)continue;h=m}else if(m===e){if(p===n)continue;h=p}else o("X should be left or right of its xors");var g=!1,b=f(h,!0);if(v&&b===i)c(h,n),g=!0;else if(v&&2===fr(b))se(n,h),g=!0;else if(s){var k=_(t,h,!0);ii(t,h),w(k,Ca)||(se(n,h),g=!0)}if(g)return ca(r,d,Yt),ei(t,e),ei(t,n),ei(t,h),y(),!0}}return!1}function $r(e,n,a,i,u){for(var f=0;f<i;++f){var s=ti(t,e,f);if(s!==a)if(ta(r,s)===Et)return Wr(e,n,a,s)}o("bounty should have asserted that an isall existed")}function Wr(e,n,a,i){var u=ia(r,i+1);return v(ia(r,i+Qt+2*u)),fa(r,i,Ot),sa(r,i+Qt+2*u,n),ca(r,a,Yt),l.push(function(r,t,a,i){var u=a(e),o=a(n);Sr(o)&&(o=Rr(t(n))),i(e,u=kr(o)?Vr(u,0):Cr(u,0)),a(e),a(n),!Sr(a(e))&&a(n),a(e),a(n)}),ei(t,e),ei(t,n),ve(r,i,u),y(),!0}function Gr(e,n,a,i,u){for(var f=0;f<i;++f){var s=ti(t,e,f);if(s!==a)if(ta(r,s)===jt)return Qr(e,n,a,s)}o("bounty should have asserted that an issome existed")}function Qr(e,n,a,i){var u=ia(r,i+1),o=i+Qt+2*u;x(r,o);var f=ce(r,i,u);return ei(t,n),ei(t,e),fa(r,i,Ct),sa(r,o,n),ca(r,a,Yt),l.push(function(r,t,a,i){var u=a(n),o=a(e);if(kr(u))i(e,o=Vr(o,0));else if(kr(o))i(n,u=Cr(u,0));else if(yr(u))i(e,o=Cr(o,0));else if(yr(o))i(n,u=Cr(u,0));else{for(var s=!0,c=!1,v=-1,l=0;l<f.lenght;++l){var d=a(f[l]);if(yr(d)){c=!0;break}kr(d)||(s=!1,v=l)}if(c)o=Vr(o,0);else if(s)o=Cr(o,0);else{o=Vr(o,0);var p=f[v],m=a(p);i(p,m=Vr(m,0))}i(e,o)}a(n),a(e),!Sr(a(n))&&a(e),a(n),a(e),a(e),f.some(function(r){return yr(a(r))})}),y(),!0}function Yr(e,n,a,i){var u=ti(t,e,0),o=ti(t,e,1),s=u===a?o:u;if(ii(t,n),2!==ia(r,s+1))return!1;if(!Sr(f(e,!0)))return k=!0,!1;x(r,s+Kt)===e||x(r,s+Zt);var c=x(r,s+Kt);return c===e&&(c=x(r,s+Zt)),f(e),f(n),f(c),f(n),f(c),f(e),l.push(function(r,t,a,i){var u=a(n),o=a(c),f=a(e);f=kr(u)?Vr(f,0):yr(u)?Cr(f,0):kr(o)?Vr(f,0):0===t(n)?Vr(f,0):Cr(f,0),i(e,f),a(n)&&a(n),a(c),a(e)&&a(e),a(n),a(e),!xr(a(e))||a(c)}),ca(r,s,Yt),pa(r,a,2,mt,n,c),ei(t,n),ei(t,c),ei(t,e),y(),!0}function Xr(e,n){if(n>=Qa)return!1;var a=f(e,!0);if(kr(a))return k=!0,!1;if(yr(a))return k=!0,!1;for(var i=[],u=[],o=0;o<n;++o){for(var c=ti(t,e,o),v=ia(r,c+1),l=0;l<v;++l){var d=x(r,c+Qt+2*l);d!==e&&u.push(d)}i.indexOf(c)<0&&i.push(c)}kr(a)||s(e,Rr(0));for(var p=0,m=i.length;p<m;++p){var h=i[p];ca(r,h,Qt+2*ia(r,h+1))}for(var g=0,b=u.length;g<b;++g){ei(t,u[g])}return ei(t,e),y(),!0}function Zr(e,n){if(n>=Qa)return!1;var a=f(e,!0);if(yr(a))return k=!0,!1;if(kr(a))return k=!0,!1;for(var i=[],u=[],o=0;o<n;++o){for(var c=ti(t,e,o),v=ia(r,c+1),l=0;l<v;++l){var d=x(r,c+Qt+2*l);d!==e&&u.push(d)}i.indexOf(c)<0&&i.push(c)}xr(a)&&s(e,a=Vr(a,0));for(var p=0,m=i.length;p<m;++p){var h=i[p];ca(r,h,Qt+2*ia(r,h+1))}for(var g=0,b=u.length;g<b;++g){ei(t,u[g])}return ei(t,e),y(),!0}function ee(e,n){if(!_r(f(e)))return f(e),!1;if(n>=Qa)return!1;for(var a,i,u,o,s=[],c=[],v=0;v<n;++v){var d=ti(t,e,v);if(!d)break;var p=ta(r,d);if(2!==ia(r,d+1))return!1;var m=x(r,d+Kt),h=x(r,d+Zt),g=m===e?h:m;if(p===bt)s.push(d),c.push(g);else if(p===_t){if(i)return!1;i=d,o=g}else{if(a)return!1;a=d,u=g}}pa(r,a,2,_t,u,o),ca(r,i,Yt);for(var b=0,k=c.length;b<k;++b){var _=c[b];pa(r,s[b],2,gt,_,o),ei(t,_)}return l.push(function(r,n,t,a){c.map(function(r){return K(t(r))}),t(u),t(o),t(e),c.map(function(r){return K(t(e))+" !& "+K(t(r))}).join(", "),t(e),t(u),t(e),t(o);var i=t(u),f=t(o),s=t(e),v=!1,l=!1;kr(f)&&(v=!0),c.forEach(function(r){yr(t(r))&&(l=!0)}),v?s=Cr(s=Vr(s,0),lr(i)):l?s=Cr(s=Cr(s,0),lr(i)):Sr(s=Cr(s,lr(i)))&&(s=Vr(s,0)),a(e,s),yr(s)&&c.forEach(function(r){var e=t(r);a(r,e=Cr(e,0))}),a(u,i=Or(i,mr(s))),kr(s)&&a(o,f=Vr(f,0)),c.map(function(r){return K(t(e))+" !& "+K(t(r))}).join(", "),t(e),t(u),t(e),t(o),t(u),t(o),t(e),c.some(function(r){return!kr(t(r))&&!kr(t(e))}),t(e),t(e),yr(t(e))||t(o)}),ei(t,u),ei(t,o),ei(t,e),y(),!0}function ne(e,n){if(n>=Qa)return!1;for(var a,i,u,o,f=[],s=[],c=0;c<n;++c){var v=ti(t,e,c);if(!v)break;var d=ta(r,v);if(2!==ia(r,v+1))return!1;var p=x(r,v+Kt),m=x(r,v+Zt),h=p===e?m:p;if(d===bt)f.push(v),s.push(h);else if(d===_t){if(i)return!1;i=v,o=h}else{if(a)return!1;a=v,u=h}}pa(r,a,2,_t,u,o),ca(r,i,Yt);for(var g=0,b=s.length;g<b;++g){var k=s[g];pa(r,f[g],2,mt,k,o),ei(t,k)}return l.push(function(r,n,t,a){s.map(function(r){return K(t(r))}),t(u),t(o),t(e);var i=t(e),f=i;if(!kr(f))for(var c=0,v=s.length;c<v;++c){var l=s[c];if(yr(t(l))||0!==n(l)){f=Cr(f,0);break}}var d=t(o);Sr(d)&&(n(d),d=t(o)),kr(d)&&(f=Vr(f,0));var p=t(u);Sr(p)&&(n(p),p=t(u)),kr(p)&&(f=Cr(f,0)),i!==f&&a(e,f)}),ei(t,u),ei(t,o),ei(t,e),y(),!0}function te(e,n){if(n>4||n>=Qa)return!1;for(var a,i,u,o,f,s,c,v,d=0;d<n;++d){var p=ti(t,e,d),m=ta(r,p),h=x(r,p+Kt),g=x(r,p+Zt),b=h===e?g:h;m===bt?(c=b,o=p):m===_t?(s=b,u=p):h===e?(a=p,v=b):(i=p,f=b)}return pa(r,a,2,gt,f,v),pa(r,i,2,gt,c,v),pa(r,u,2,_t,s,v),pa(r,o,2,bt,f,c),l.push(function(r,n,t,a){var i=t(e);1===n(f)?a(e,i=Vr(i,0)):0===n(s)?a(e,i=Vr(i,0)):n(c)>0?a(e,i=Cr(i,0)):0===n(v)&&a(e,i=Cr(i,0))}),ei(t,f),ei(t,s),ei(t,c),ei(t,v),ei(t,e),y(),!0}function ae(e,n){if(4!==n||n>=Qa)return!1;for(var a,i,u,o,s,c,v,p,m=0;m<n;++m){var h=ti(t,e,m),g=ta(r,h),b=x(r,h+Kt),k=x(r,h+Zt);if(g===bt)v=b===e?k:b,o=h;else if(g===_t)c=b===e?k:b,u=h;else{var _=b===e?k:b;b===e?(a=h,p=_):(i=h,s=_)}}return!!(_r(f(s,!0))&&_r(f(c,!0))&&_r(f(v,!0))&&_r(f(p,!0)))&&(pa(r,a,2,mt,s,p),pa(r,i,2,mt,v,p),pa(r,u,2,_t,c,p),pa(r,o,2,bt,s,v),d.push(e),l.push(function(r,n,t,a){var i=t(e);1===n(s)?a(e,i=Vr(i,0)):0===n(c)?a(e,i=Vr(i,0)):n(v)>0?a(e,i=Cr(i,0)):0===n(p)&&a(e,i=Cr(i,0))}),ei(t,s),ei(t,c),ei(t,v),ei(t,p),ei(t,e),y(),!0)}function ie(e,n,a,i,u,o,f,s){var c=oe(f,s,a,e);sa(r,e+Qt+2*c,u);var v=ce(r,e,c);return l.push(function(r,e,n,t){var a=n(u),f=n(i),s=n(o);Sr(a)||(G(f,s)?(e(o),s=n(o),t(u,a=f===s?Vr(a,0):Cr(a,0))):t(u,a=Cr(a,0))),t(o,s=kr(a)?Vr(s,L(f)):G(s,f)),n(u),n(o),n(i),n(u),n(i),kr(n(u))||n(o),n(u),n(i),n(o)}),fe(i,v,f),ca(r,n,Xt),ei(t,u),ei(t,i),ei(t,o),y(),!0}function ue(r,e,n,t,a){switch(r){case ht:case gt:case qt:case Rt:case Mt:case Tt:case pt:case xt:return vi;case St:case wt:case mt:case kt:case dt:case bt:case _t:case yt:case It:return li;case Lt:return vi;case At:case Vt:if(!e)return di;for(var i=ia(n,t+1),u=0;u<i;++u)if(x(n,t+Qt+2*u)===a)return vi;return x(n,t+Qt+2*i),li;case Nt:case Dt:return e?x(n,t+1)===a||x(n,t+3)===a?vi:(x(n,t+5),li):di;case Et:case Ot:case jt:case Ct:return li;case lt:case Ut:case Ft:case Bt:case Pt:case Ht:case zt:case Jt:return o("should not be used for these ops");default:o("(ml_isBooly) unknown op: "+r)}}function oe(e,n,t,a){if(n>=0){if(n!==t-1){var i=x(r,a+Qt+2*(t-1));sa(r,a+Qt+2*n,i)}f(x(r,a+Qt+2*(t-1)),!0),sa(r,a+1,--t),fa(r,a+Qt+2*(t+1),Pt)}return t}function fe(r,e,n){e.map(f).reduce(function(r,e){return re(r,e)}),e.map(f).reduce(function(r,e){return re(r,e)}),f(r),e.map(f).map(K).join(" "),f(r),e.map(f).reduce(function(r,e){return re(r,e)}),f(r),l.push(function(t,a,i,u){for(var o=i(r),f=0,s=0,c=e.length;s<c;++s){a(e[s])&&++f}var v=X(o,f+n);o!==v&&u(r,v)})}function se(r,e){var n=f(e,!0);f(r),f(e);l.push(function(t,a,i,u){i(r);var o=a(r);u(e,0===o?Cr(n,0):Vr(n,0),!0,!0)}),c(e,r,"cutAddPseudoBoolyAlias")}function ce(r,e,n,a){void 0===a&&(a=-1);for(var i=[],u=0;u<n;++u){var o=x(r,e+Qt+2*u);o!==a&&i.push(o),ei(t,o)}return i}function ve(r,e,n){for(var a=0;a<n;++a){var i=x(r,e+Qt+2*a);ei(t,i)}}function le(r,e,n){switch(ta(r,e+n)){case Bt:case Pt:case Ht:case zt:case Ut:case Ft:va(r,e,n),m=e;break;default:m=e+n}}}var mi=0;function hi(r,e){0,r.length<50&&r.join(" ");var n=e.getDomain,t=e.setDomain,a=e.getAlias,i=e.addVar,o=e.addAlias,f=0,s={},c=!1;return function(){for(;f<r.length&&!c;){++mi;var e=r[f];switch(e){case mt:v("->");break;case kt:v("!->");break;case Nt:m("<?");break;case Dt:m("<=?");break;case Et:b("isall");break;case At:x("isdiff")||b("isdiff");break;case Ot:b("isnall");break;case Ct:b("isnone");break;case Vt:x("issame")||b("issame");break;case jt:b("issome");break;case dt:y("all");break;case pt:y("diff");break;case ht:v("<");break;case gt:v("<=");break;case bt:y("nall");break;case yt:y("none");break;case xt:y("same");break;case _t:y("some");break;case wt:y("xnor");break;case St:y("^");break;case qt:p("-");break;case Rt:p("/");break;case Mt:k("sum");break;case Tt:k("product");break;case lt:if(0!==f)return wa(r,f,"deduper problem found START");++f;break;case Jt:return s;case Lt:case It:f+=$t;break;case Ut:f+=$t+ia(r,f+1);break;case Ft:f+=Wt+oa(r,f+1);break;case Bt:++f;break;case Pt:f+=2;break;case Ht:f+=3;break;case zt:f+=4;break;default:wa(r,f,"(dd) unknown op")}}c||wa(r,f,"(dd) ML OOB")}(),u().log(" - dedupe removed",0,"constraints and aliased",0,"result vars, emptyDomain=",c,", processed",mi,"ops"),ci(e),c?-1:0;function v(e){var t=a(ia(r,f+Kt)),i=a(ia(r,f+Zt)),u=e+":"+t+","+i;n(t,!0),n(i,!0);("<"!==e&&"<="!==e||!function(r,e,n,t){return!!("<"===r&&l("<?","<",e,n)||"<"===r&&l("<=?","<",e,n)||"<="===r&&l("<=?","<=",e,n)||"<"===r&&d("<?","<",e,n)||"<="===r&&d("<?","<=",e,n)||"<"===r&&d("<=?","<",e,n))}(e,t,i))&&(void 0===s[u]?(s[u]=1,f+=Yt):ca(r,f,Yt))}function l(e,i,u,o,f){var c=s[e+":R="+u+","+o];if(c){var v=a(ia(r,c+5)),l=n(v,!0);return!!Sr(l)&&(ca(r,c,Gt),t(v,Vr(l,0)),!0)}return!1}function d(e,i,u,o,f){var c=s[e+":R="+o+","+u];if(c){var v=a(ia(r,c+5)),l=n(v,!0);return!!Sr(l)&&(ca(r,c,Gt),t(v,Cr(l,0)),!0)}return!1}function p(e){var i=a(ia(r,f+1)),u=a(ia(r,f+3)),v=a(ia(r,f+5)),l=e+":"+i+","+u,d=(n(v,!0),n(i,!0),n(u,!0),s[l]);if(void 0===d)s[l]=v,f+=Gt;else if(d=a(d),ca(r,f,Gt),v!==d){var p=G(n(v,!0),n(d,!0));if(!p)return c=!0;t(d,p),o(v,d)}}function m(e){var i=f,u=a(ia(r,f+1)),c=a(ia(r,f+3)),v=a(ia(r,f+5)),l=e+":"+v+"="+u+","+c;n(v,!0),n(u,!0),n(c,!0);if(void 0===s[l]){var d=n(v,!0);"<"===e.slice(0,-1)||e.slice(0,-1);var p=e.slice(0,-1)+":"+u+","+c;if(s[p]&&(e.slice(0,-1),!kr(d)))return ca(r,f,Gt),void t(v,Vr(d,0));if(!function(r,e,n,t,a,i){r.slice(0,-1);if(Sr(a)){if("<?"===r&&h("<?","<",e,n,t,a))return!0;if("<=?"===r&&h("<=?","<",e,n,t,a))return!0;if("<=?"===r&&h("<=?","<=",e,n,t,a))return!0;if("<?"===r&&g("<?","<",e,n,t,a))return!0;if("<?"===r&&g("<?","<=",e,n,t,a))return!0;if("<=?"===r&&g("<=?","<",e,n,t,a))return!0}return!1}(e,u,c,v,d)){var m=s[("<?"===e?"<=?":"<?")+":R="+c+","+u];if(m){var b=a(ia(r,m+5));return n(v),n(b),void ka(r,i,St,v,b)}if(wr(d)){var k=e+":["+d+"]="+u+","+c,y=s[k];if(void 0!==y)return y=a(y),ca(r,f,Gt),void(v===y||o(v,y));s[k]=v}s[l]=1,s[e+":R="+u+","+c]=i,f+=Gt}}else ca(r,f,Gt)}function h(e,n,a,i,u,o,c){return!!s[n+":"+a+","+i]&&(ca(r,f,Gt),t(u,Vr(o,0)),!0)}function g(e,n,a,i,u,o,c){return!!s[n+":"+i+","+a]&&(ca(r,f,Gt),t(u,Cr(o,0)),!0)}function b(e){var t=ia(r,f+1),i=Qt+2*t+2;Sa(r,f+Qt,t);for(var u="",c="",v=0;v<t;++v){var l=a(ia(r,f+Qt+2*v));u+=l+" ",c+=K(n(l,!0))}var d=a(ia(r,f+Qt+2*t)),p=e+":"+d+"="+u;n(d,!0);if(void 0===s[p]){s[p]=1;var m=n(d,!0);if(wr(m)){var h=e+":["+m+"]="+u,g=s[h];if(void 0!==g)return g=a(g),ca(r,f,i),void(d===g||(n(d),n(g),o(d,g)));s[h]=d}f+=i}else ca(r,f,i)}function k(e){var i=ia(r,f+1),u=Qt+2*i+2;Sa(r,f+Qt,i);for(var c="",v=0;v<i;++v){var l=a(ia(r,f+Qt+2*v));c+=l+" ",K(n(l,!0))}var d=a(ia(r,f+Qt+2*i)),p=e+":="+c,m=s[p];if(void 0===m)s[p]=d,f+=u;else if(m=a(m),ca(r,f,u),d!==m){var h=G(n(m,!0),n(d,!0));t(m,h),o(d,m)}}function y(e){var t=ia(r,f+1),i=Qt+2*t;Sa(r,f+Qt,t);for(var u="",o=0;o<t;++o){var c=a(ia(r,f+Qt+2*o));u+=c+" ",K(n(c,!0))}var v=e+":="+u;void 0===s[v]?(s[v]=1,f+=i):ca(r,f,i)}function x(e){var t=ia(r,f+1);if(2!==t)return!1;var u=a(ia(r,f+Kt)),c=a(ia(r,f+Zt)),v=a(ia(r,f+ea));if(c<u){var l=c;c=u,u=l}var d=n(u,!0),p=n(c,!0);if(2!==fr(d))return!1;var m=L(p);if(m<0||!q(d,m))return!1;var h=L(Vr(d,m)),g=i(void 0,h,!1,!1,!0);n(g);var b=("issame"===e?"isdiff":"issame")+":"+u+","+g,k=(n(v,!0),n(u,!0),n(c,!0),s[b]);if(void 0===k)return s[e+":"+u+","+c]=v,!1;var y=n(v,!0);return 2!==fr(y)||yr(y)||y!==n(k,!0)?(n(k,!0),ba(r,f,0,wt,v,k)):(v===k||o(v,k),ca(r,f,Xt)),!0}}var gi=38,bi=64,ki=33,yi=58,xi=44,_i=10,wi=13,Si=45,Ei=47,Ai=61,Ni=62,Di=35,Oi=91,Ci=40,Vi=60,ji=124,Mi=43,Ti=63,qi=32,Ri=93,Ii=41,Li=39,Ui=42,Fi=9,Bi=94,Pi=48,Hi=49,zi=50,Ji=51,$i=52,Wi=53,Gi=54,Qi=55,Yi=56,Xi=57,Ki=97,Zi=99,ru=100,eu=101,nu=102,tu=103,au=105,iu=108,uu=109,ou=110,fu=111,su=112,cu=114,vu=115,lu=116,du=120,pu=122,mu=65,hu=98;function gu(r,e,n){r.slice(0,100).replace(/ +/g," "),r.replace(/ +/g," "),e.input.varstrat="default",e.input.valstrat="default",e.input.dsl=r;var t,a=e.addVar,i=e.setDomain,o=e.name2index,c=0,v=-1,l=0,d=(t="undefined"==typeof Buffer?new window.TextEncoder("utf-8").encode(r):new Uint8Array(Buffer.from(r,"binary"))).length,p=Math.ceil(t.length/5),m=new Uint8Array(p).fill(0),h=0,g=-1,b=-1;for(x(lt);!I();)L();if(v>0&&nr(v),x(Jt),--h,v<0){var k=p-h-1;k>0&&nr(k)}function y(r){++c,x(r)}function x(r){h>=p&&w(),m[h++]=r}function _(r){r>65535&&ir("Need 32bit num support but missing it"),h>=p-1&&w(),m[h++]=r>>8&255,m[h++]=255&r}function w(r){var e=p;p+=r||Math.max(Math.ceil(.1*p),10),"undefined"==typeof Buffer?m=ArrayBuffer.transfer?new Uint8Array(ArrayBuffer.transfer(m.buffer,p)):new Uint8Array(function(r,e){if(!(r instanceof ArrayBuffer))throw new TypeError("Source must be an instance of ArrayBuffer");if(e<=r.byteLength)return r.slice(0,e);var n=new Uint8Array(r),t=new Uint8Array(new ArrayBuffer(e));return t.set(n),t.buffer}(m.buffer,p)):(m=new Uint8Array(Buffer.concat([m],p))).fill(0,e)}function S(){return t[l]}function E(r){return t[l+r]}function A(r,e){return String.fromCharCode.apply(String,t.slice(r,e))}function N(){++l}function D(r,e){e||(e=""),S()!==r&&ir("Expected "+e+" `"+r+"`, found `"+S()+"`"),N()}function O(){for(;l<d&&C(S());)N()}function C(r){return r===qi||r===Fi}function V(r){return r===_i||r===wi}function j(r){return V(r)||T(r)||I()}function M(r){return r===_i||r===wi||r===Di}function T(r){return r===Di}function q(r){return C(r)||V(r)}function R(){if(O(),l<d){var r=S();r===Di?H():V(r)?N():ir("Expected EOL but got `"+S()+"`")}}function I(){return l>=d}function L(){switch(function(){for(;!I();){var r=S();if(q(r))N();else{if(!T(r))break;H()}}}(),S()){case yi:return void function(){N(),O();var r=F();if(O(),S()===xi){r=[r];do{N(),O(),r.push(F()),O()}while(!I()&&S()===xi)}S()===Ai&&(N(),O());var e=P();O();var n=function(){if(S()!==bi)return;N();var r={},e="";for(;;){var n=S();if(!(n>=Ki&&n<=pu||n>=mu&&n<=hu))break;e+=String.fromCharCode(n),N()}switch(e){case"list":!function(r){O(),(E(0)!==su||E(1)!==cu||E(2)!==au||E(3)!==fu||E(4)!==Ci)&&ir("Expecting the priorities to follow the `@list`");l+=5,r.valtype="list",r.list=Z(),D(Ii,"list end")}(r);break;case"markov":!function(r){r.valtype="markov";var e=!0;for(;e;)switch(e=!1,O(),S()){case uu:if(E(1)===Ki&&E(2)===lu&&E(3)===cu&&E(4)===au&&E(5)===du&&E(6)===Ci){for(var n=l+=7;S()!==Ii&&!I();)N();I()&&ir("The matrix must be closed by a `)` but did not find any");var t=A(n,l),a="return "+t,i=Function(a);r.matrix=i(),D(Ii,"end of matrix"),e=!0}break;case iu:E(1)===eu&&E(2)===tu&&E(3)===eu&&E(4)===ou&&E(5)===ru&&E(6)===Ci&&(l+=7,O(),r.legend=Z(),O(),D(Ii,"legend closer"),e=!0);break;case eu:E(1)===du&&E(2)===su&&E(3)===Ki&&E(4)===ou&&E(5)===ru&&E(6)===Ci&&(l+=7,O(),r.expandVectorsWith=Y(),O(),D(Ii,"expand closer"),e=!0)}}(r);break;case"max":case"mid":case"min":case"naive":r.valtype=e;break;case"minMaxCycle":case"splitMax":case"splitMin":ir("TODO: implement this modifier ["+e+"]");break;default:ir("implement me (var mod) [`"+e+"`]")}return r.valtype=e,r}();R(),"string"==typeof r?U(r,e,n):r.forEach(function(r){return U(r,e,n)})}();case bi:return void function(){D(bi);var r=F();if("custom"===r){O();var n=F();switch(O(),S()===Ai&&(N(),O()),n){case"var-strat":!function(){var r=!1,n=!1,t=!1;if(S()===nu){var a=F();"fallback"!==a&&ir("Expecting var strat name, found ["+a+"]"),r=!0,O()}if(S()===au){var i=F();"inverted"!==i&&ir("Expecting var strat name, found ["+i+"]"),n=!0,O()}S()===Ai&&(N(),t=!0,O());if(S()===Ci)tr(r,n);else{var u=F();"naive"===u||"size"===u||"min"===u||"max"===u||"throw"===u?(n&&ir("The `inverted` keyword is only used with a list"),r?ar(u):e.input.varstrat=u):"list"===u?(O(),t&&ir("The `=` should not be used for a list"),S()!==Ci&&ir("Expecting list of idents now"),tr(r,n)):ir("Unknown var strat ["+u+"]")}O()}();break;case"val-strat":e.input.valstrat=F();break;case"set-valdist":O();var t=F(),a=function(){O(),S()===Ai&&(N(),O());return function(){var r="";for(;!I();){var e=S();if(V(e))break;r+=String.fromCharCode(e),N()}return r}()}();b=o(t,!0),k=JSON.parse(a),e.valdist[b]=k;break;case"noleaf":O();for(var i=rr(void 0),u=0,f=i.length;u<f;++u)for(var s=o(i[u]),c=0;c<3;++c)x(It),_(s);break;case"nobool":O();for(var d=rr(void 0),p=0,m=d.length;p<m;++p){var h=o(d[p]);x(Lt),_(h)}break;case"free":O();var g=Y();v=g;break;case"targets":!function(){O(),S()===Ai&&ir("Unexpected double eq sign");if(S()===Ki&&E(1)===iu&&E(2)===iu)l+=3;else{D(Ci,"ONLY_USE_WITH_SOME_TARGET_VARS; The @targets left-paren");var r=rr(Ii);e.freezeTargets(r),D(Ii,"The @targets right-paren")}R()}();break;default:ir("Unsupported custom rule: "+n)}}else ir("Unknown atrule ["+r+"]");var b,k;R()}();default:I()||function(){if(function(){var r=S();if(r===ru&&E(1)===au&&E(2)===vu&&E(3)===lu&&E(4)===au&&E(5)===ou&&E(6)===Zi&&E(7)===lu&&E(8)===Ci)return W(pt,9),!0;if(r===ru&&E(1)===au&&E(2)===nu&&E(3)===nu&&E(4)===Ci)return W(pt,5),!0;if(r===Ki&&E(1)===iu&&E(2)===iu&&E(3)===Ci)return W(dt,4),!0;if(r===ou&&E(1)===Ki&&E(2)===iu&&E(3)===iu&&E(4)===Ci)return W(bt,5),!0;if(r===vu&&E(1)===Ki&&E(2)===uu&&E(3)===eu&&E(4)===Ci)return W(xt,5),!0;if(r===vu&&E(1)===fu&&E(2)===uu&&E(3)===eu&&E(4)===Ci)return W(_t,5),!0;if(r===ou&&E(1)===fu&&E(2)===ou&&E(3)===eu&&E(4)===Ci)return W(yt,5),!0;if(r===du&&E(1)===ou&&E(2)===fu&&E(3)===cu&&E(4)===Ci)return W(wt,5),!0;return!1}())return;(function(){var r=Q(void 0,!0);O(),I()&&ir("Expected to parse a cop but reached eof instead");var e=function(){var r=S();switch(r){case Ai:return N(),S()===Ai?(N(),"=="):"=";case ki:N();var e=S();return e===Ai?(N(),"!="):e===gi?(N(),"!&"):e===Bi?(N(),"!^"):e===ji?(N(),"!|"):e===Si&&E(1)===Ni?(N(),N(),"!->"):ir("Unknown cop that starts with [!]");case Vi:return N(),S()===Ai?(N(),"<="):"<";case Ni:return N(),S()===Ai?(N(),">="):">";case Si:if(E(1)===Ni)return N(),N(),"->";break;case gi:return N(),"&";case ji:return N(),"|";case Bi:return N(),"^";case Di:return ir("Expected to parse a cop but found a comment instead")}I()&&ir("Expected to parse a cop but reached eof instead");ir("Unknown cop char: `"+r+"`")}();if(O(),"="===e)g=r,function(r){var e=Q(r);O();var n=S();if(!I()&&!M(n)){var t=$();t||ir("Expecting right paren or rop, got ["+t+"]"),O();var a=Q();return J(e,t,a,r)}e!==r&&z(e,"==",r)}(r);else{var n=Q();z(r,e,n)}})(),R()}()}}function U(r,e,n){return a(r,e,n,!1,!0,ir)}function F(){return S()===Li?function(){D(Li);var r="";for(;!I();){var e=S();if(e===Li)break;e!==Di&&M(e)&&ir("Quoted identifier wasnt closed at eol"),r+=String.fromCharCode(e),N()}I()&&ir("Quoted identifier wasnt closed at eof");r||ir("Expected to parse identifier, found none");return N(),r}():function(){var r=S(),e="";r>=Pi&&r<=Xi&&ir("Unquoted ident cant start with number");for(;!I()&&B(r=S());)e+=String.fromCharCode(r),N();e||ir("Expected to parse identifier, found none");return e}()}function B(r){switch(r){case Ci:case Ii:case xi:case Oi:case Ri:case Li:case Di:return!1}return!q(r)}function P(){var r,e=S();switch(e){case Oi:if(D(Oi,"domain start"),O(),r=[],S()===Oi)do{N(),O();var n=Y();O(),S()===xi&&(N(),O());var t=Y();O(),D(Ri,"range-end"),O(),r.push(n,t),S()===xi&&(N(),O())}while(S()===Oi);else for(;S()!==Ri;){O();var a=Y();O(),S()===xi&&(N(),O());var i=Y();O(),r.push(a,i),S()===xi&&(N(),O())}return D(Ri,"domain-end"),0===r.length&&ir("Empty domain [] in dsl, this problem will always reject"),r;case Ui:return N(),[f,s];case Pi:case Hi:case zi:case Ji:case $i:case Wi:case Gi:case Qi:case Yi:case Xi:var u=Y();return O(),[u,u]}ir("Expecting valid domain start, found `"+e+"`")}function H(){for(D(Di,"comment start");!I()&&!V(S());)N();I()||N()}function z(r,e,n){switch(e){case"==":y(xt),_(2),_(r<n?r:n),_(r<n?n:r);break;case"!=":y(pt),_(2),_(r<n?r:n),_(r<n?n:r);break;case"<":y(ht),_(2),_(r),_(n);break;case"<=":y(gt),_(2),_(r),_(n);break;case">":y(ht),_(2),_(n),_(r);break;case">=":y(gt),_(2),_(n),_(r);break;case"&":y(dt),_(2),_(r<n?r:n),_(r<n?n:r);break;case"!&":y(bt),_(2),_(r<n?r:n),_(r<n?n:r);break;case"|":y(_t),_(2),_(r<n?r:n),_(r<n?n:r);break;case"!|":y(yt),_(2),_(r<n?r:n),_(r<n?n:r);break;case"^":y(St),_(2),_(r<n?r:n),_(r<n?n:r);break;case"!^":y(wt),_(2),_(r<n?r:n),_(r<n?n:r);break;case"->":y(mt),_(2),_(r),_(n);break;case"!->":y(kt),_(2),_(r),_(n);break;default:ir("Unknown constraint op: ["+e+"]")}}function J(r,e,n,t){var a=!1;switch(e){case"==?":y(Vt),_(2),_(r<n?r:n),_(r<n?n:r),_(t),a=!0;break;case"!=?":y(At),_(2),_(r<n?r:n),_(r<n?n:r),_(t),a=!0;break;case"<?":y(Nt),_(r),_(n),_(t),a=!0;break;case"<=?":y(Dt),_(r),_(n),_(t),a=!0;break;case"&?":y(Et),_(2),_(r),_(n),_(t);break;case"!&?":y(Ot),_(2),_(r),_(n),_(t);break;case"|?":y(jt),_(2),_(r),_(n),_(t);break;case"!|?":y(Ct),_(2),_(r),_(n),_(t);break;case"+":y(Mt),_(2),_(r<n?r:n),_(r<n?n:r),_(t);break;case"-":y(qt),_(r),_(n),_(t);break;case"*":y(Tt),_(2),_(r<n?r:n),_(r<n?n:r),_(t);break;case"/":y(Rt),_(r),_(n),_(t);break;case">?":return J(n,"<?",r,t);case">=?":return J(n,"<=?",r,t);default:ir("Expecting right paren or rop, got ["+e+"]")}return a&&t===g&&t===b&&i(t,Ir(0,1)),t}function $(){switch(S()){case Ai:return N(),S()===Ai?(N(),D(Ti,"reifier suffix"),"==?"):"=";case ki:N();var r="";return S()===Ai?(D(Ai,"middle part of !=? op"),r="!=?"):S()===gi?(D(gi,"middle part of !&? op"),r="!&?"):S()===ji?(D(ji,"middle part of !|? op"),r="!|?"):ir("invalid rop that starts with a bang"),D(Ti,"reifier suffix"),r;case Vi:return N(),S()===Ai?(N(),D(Ti,"reifier suffix"),"<=?"):(D(Ti,"reifier suffix"),"<?");case Ni:return N(),S()===Ai?(N(),D(Ti,"reifier suffix"),">=?"):(D(Ti,"reifier suffix"),">?");case ji:return N(),D(Ti,"issome suffix"),"|?";case gi:return N(),D(Ti,"isall suffix"),"&?";case Mi:return N(),"+";case Si:return N(),"-";case Ui:return N(),"*";case Ei:return N(),"/";default:return""}}function W(r,e){l+=e,O();var n=G();y(r),_(n.length),n.forEach(_),O(),D(Ii,"parseCalledListConstraint call closer"),R()}function G(){var r=[];for(O();!I()&&S()!==Ii;){var e=Q();r.push(e),O(),S()===xi&&(N(),O())}return r.length||ir("Expecting at least one expression in the list"),r}function Q(r,e){var n,t=S();if(t>=Pi&&t<=Xi){var i=Y();n=a(void 0,i,!1,!1,!0)}else if(t===Ci)n=function(){D(Ci,"group open"),O();var r=Q();if(O(),S()!==Ii){var e=$();e||ir("Expecting right paren or rop"),O();var n=Q(),t=a(void 0,"?"===e[e.length-1]?[0,1]:void 0,!1,!1,!0);r=J(r,e,n,t),O()}return D(Ii,"group closer"),r}();else if(t===Oi){var u=P();n=a(void 0,u,!1,!1,!0)}else{var f=F();S()===Ci?"sum"===f?n=X(Mt,r,!1):"product"===f?n=X(Tt,r,!1):"all?"===f?n=X(Et,r,!0):"diff?"===f?n=X(At,r,!0):"nall?"===f?n=X(Ot,r,!0):"none?"===f?n=X(Ct,r,!0):"same?"===f?n=X(Vt,r,!0):"some?"===f?n=X(jt,r,!0):ir("Unknown reifier constraint func: "+f):(n=o(f,!1,!0))<0&&(e?b=n=a(f,void 0,!1,!1,!0):ir("CONSTRAINT_VARS_SHOULD_BE_DECLARED; Unknown var ["+f+"]"))}return n}function Y(){var r=K();return r||ir("Expecting to parse a number but did not find any digits c=[ord("+S()+")="+String.fromCharCode(S())+"]"),parseInt(r,10)}function X(r,e,n){D(Ci,"args call opener"),O();var t=G();return void 0===e?e=a(void 0,n?[0,1]:void 0,!1,!1,!0):e===g&&e===b&&n&&i(e,Ir(0,1)),y(r),_(t.length),t.sort(function(r,e){return r-e}),t.forEach(_),_(e),O(),D(Ii,"args closer"),e}function K(){for(var r="";!I();){var e=S();if(e<Pi||e>Xi)break;r+=String.fromCharCode(e),N()}return r}function Z(){var r=[];O();for(var e=K();e;)r.push(parseInt(e,10)),O(),S()===xi&&(++l,O()),e=K();return r.length||ir("Expected to parse a list of at least some numbers but found none"),r}function rr(r){var e=er(r);return e.length||ir("Expected to parse a list of at least some identifiers but found none"),e}function er(r){var e=[];for(O();!I();){var n=S();if(n===r)return e;if(M(n))break;n===xi&&(e.length||ir("Leading comma not supported"),N(),O(),j(S())&&ir("Trailing comma not supported"),(n=S())===xi&&ir("Double comma not supported"));var t=F();e.push(t),O()}if(void 0===r)return e;ir("Missing target char at eol/eof")}function nr(r){switch(r){case 0:break;case 1:x(Bt);break;case 2:x(Pt),x(0);break;case 3:x(Ht),x(0),x(0);break;case 4:x(zt),x(0),x(0),x(0);break;default:var e=h+r;if(p<=e)w(e/10|0+(e-p));r<65535?(x(Ut),_(r-$t),h+=r-$t):(x(Ft),(n=r-Wt)>4294967295&&ir("This requires 64bit support"),h>=p-3&&w(),m[h++]=n>>24&255,m[h++]=n>>16&255,m[h++]=n>>8&255,m[h++]=255&n,h+=r-Wt)}var n}function tr(r,n){D(Ci,"List open"),O();var t=er(Ii);O(),D(Ii,"List must be closed");var a={type:"list",inverted:n,priorityByName:t};r?ar(a):e.input.varstrat=a}function ar(r){var n=e.input.varstrat;for("string"==typeof n&&(n=e.input.varstrat={type:n});n.fallback;)n="string"==typeof n.fallback?n.fallback={type:n.fallback}:n.fallback;n.fallback=r}function ir(r){throw n&&(String.fromCharCode.apply(String,t.slice(0,l)),String.fromCharCode.apply(String,t.slice(l))),r+=", source at "+l+" #|#: `"+String.fromCharCode.apply(String,t.slice(Math.max(0,l-20),l))+"#|#"+String.fromCharCode.apply(String,t.slice(l,Math.min(t.length,l+20)))+"`",Error(r)}x(Jt),p-h&&m.splice(h),e.ml=m,e.input.targets||(e.input.targets="all"),u().log("# dsl2ml: parsed",c,"constraints and",e.domains.length,"vars")}function bu(r,e,n,t,a,i){return r.length<50&&r.join(" "),function(r,e,n,t,a,i){r.length<50&&r.join(" "),e.domains.length>100||e.domains.map(function(r,n){return n+" : "+e.varNames[n]+" : "+K(e.getDomain(n))}).join(">, <");var f=!0,s=!1,c=!1,v=0,l=0,d=0,p=0,k=0,y=!1,x=u(),_=e.addVar,w=e.addAlias,S=e.getAlias,E=e.getDomain,A=e.setDomain,N=e.solveStack;for(;!s&&(f||y);){x.time("-> min_loop "+ ++p),f=!1,s=!0,y=!1,d=0,k=0;var D=M();if(c&&(x.log("Empty domain at",v,"for opcode",l,[_a(r,v,1,e)],r.slice(v,v+10)),x.log("Empty domain, problem rejected")),x.timeEnd("-> min_loop "+p),x.log("   - ops this loop:",D,"constraints:",k),c)return b;if(s)return g;if(ci(e),i)break}return 1===p?m:h;function O(r,e){var n=ia(r,e),t=S(n);return t!==n&&sa(r,e,t),t}function C(r){S(r),S(r);var e=E(r,!0);return e||j(r),e}function V(r,e,n){return E(r),!e||E(r),E(r),A(r,e,!1,!0),e?f=!0:c=!0,c}function j(r,e){c=!0,r>=0&&V(r,Ur())}function M(){var e=0;s=!0;for(var n=!1;d<r.length&&!c;){++e,++k,n=!1;var t=d;v=d;var a=r[d];switch(l=a,a){case lt:if(0!==d)return r.slice(Math.max(d-100,0),d),r.slice(d,d+100),o(" ! optimizer problem @",d);n=!0,++d,--k;break;case Jt:return n=!0,--k,e;case ht:R(r,d);break;case gt:I(r,d);break;case yt:dr(r,d);break;case St:pr(r,d);break;case wt:hr(r,d);break;case mt:gr(r,d);break;case kt:Er(r,d);break;case pt:$(r,d);break;case dt:vr(r,d);break;case At:er(r,d);break;case bt:U(r,d);break;case xt:q(r,d);break;case _t:F(r,d);break;case Nt:tr(r,d);break;case Dt:ir(r,d);break;case Et:B(r,d);break;case Ot:H(r,d);break;case Vt:rr(r,d);break;case jt:z(r,d);break;case Ct:J(r,d);break;case qt:Y(r,d);break;case Rt:Z(r,d);break;case Mt:or(r,d);break;case Tt:cr(r,d);break;case Lt:case It:d+=$t,n=!0;break;case Bt:T(r,d,1),--k,n=!0;break;case Pt:T(r,d,2),--k,n=!0;break;case Ht:T(r,d,3),--k,n=!0;break;case zt:T(r,d,4),--k,n=!0;break;case Ut:T(r,d,$t+ia(r,d+1)),--k,n=!0;break;case Ft:T(r,d,Wt+oa(r,d+1)),--k,n=!0;break;default:o("(mn) unknown op: 0x"+a.toString(16)," at",d)}d!==t||c||(n||(y=!0),--k)}return c?e:o("Derailed; expected to find STOP before EOF")}function T(r,e,n){switch(ta(r,e+n)){case Bt:case Pt:case Ht:case zt:case Ut:case Ft:va(r,e,n),d=e;break;default:d=e+n}}function q(r,e){var n=ia(r,e+1);if(2!==n||O(r,e+Kt)!==O(r,e+Zt)){if(n>1)for(var t=O(r,e+Qt),a=E(t,!0),i=1;i<n;++i){var u=O(r,e+Qt+2*i);if(u!==t){var o=E(u,!0);if(!(a=W(u,t,o,a)))break}}ca(r,e,Qt+2*n)}else ca(r,e,Yt)}function R(r,e){var n=e+Kt,t=e+Zt,a=O(r,n),i=O(r,t),u=C(a),o=C(i);if(a===i)return j(a);if(u&&o){var f=u;if((u=Nr(u,mr(o)))===f||!V(a,u)){var c=o;(o=Dr(o,lr(u)))!==c&&V(i,o)||(mr(u)<lr(o)?ca(r,e,Yt):(s=!1,d=e+Yt))}}}function I(r,e){var n=e+Kt,t=e+Zt,a=O(r,n),i=O(r,t),u=C(a),o=C(i);if(u&&o)if(a!==i){var f=u;if((u=Cr(u,mr(o)))===f||!V(a,u)){var c=o;(o=Or(o,lr(u)))!==c&&V(i,o)||(mr(u)<=lr(o)?ca(r,e,Yt):wr(u)&&wr(o)&&mr(u)<=mr(o)?(pa(r,e,2,mt,a,i),N.push(function(r,e,n,t){n(a),n(i);var u=n(a),o=n(i);yr(u)?t(i,o=Vr(o,0)):(kr(o)||Sr(u))&&t(a,u=Cr(u,0)),n(a),n(i),n(a),n(i)})):(s=!1,d=e+Yt))}}else ca(r,e,Yt)}function U(r,e){var n=e+1,t=ia(r,n),a=e+Qt,i=Qt+2*t;if(r.slice(e,e+i).join(" "),Array.from(Array(t)).map(function(e,n){return O(r,a+2*n)}),Array.from(Array(t)).map(function(e,n){return K(C(O(r,a+2*n)))}),!t)return j(-1);if(2!==t||!function(r,e){var n=e+Zt,t=O(r,e+Kt),a=O(r,n),i=C(t),u=C(a);if(!i||!u)return!0;if(t===a){var o=i;return(i=Cr(i,0))!==o&&V(t,i),ca(r,e,Yt),!0}if(kr(i)||kr(u))return ca(r,e,Yt),!0;if(yr(i)){var f=u;return(u=Cr(u,0))!==f&&V(a,u),ca(r,e,Yt),!0}if(yr(u)){var s=i;return(i=Cr(i,0))!==s&&V(t,i),ca(r,e,Yt),!0}return!1}(r,e)){for(var u,o=t,f=-1,c=t-1;c>=0;--c){var v=O(r,a+2*c),l=C(v);if(!l)return;if(lr(l)>0||f===v)sr(r,a,t,c,!1),--t;else{if(kr(l))return void ca(r,e,Qt+2*o);f=v,u=l}}if(0===t)return j(f);if(1===t){var p=Cr(u,0);if(u!==p&&V(f,p))return;ca(r,e,Qt+2*o)}else if(o!==t){sa(r,n,t);var m=2*(o-t);la(r,e+i-m,m)}else s=!1,d=e+i}}function F(r,e){var n=e+1,t=ia(r,n),a=e+Qt,i=Qt+2*t;if(r.slice(e,e+i).join(" "),Array.from(Array(t)).map(function(e,n){return O(r,a+2*n)}),Array.from(Array(t)).map(function(e,n){return K(C(O(r,a+2*n)))}),!t)return j(-1);if(2!==t||!function(r,e){var n=e+Zt,t=O(r,e+Kt),a=O(r,n),i=C(t),u=C(a);if(!i||!u)return!0;if(t===a){var o=Vr(i,0);return i!==o&&V(t,o),void ca(r,e,Yt)}if(kr(i)){var f=u;return(u=Vr(f,0))!==f&&V(a,u),ca(r,e,Yt),!0}if(kr(u)){var s=i;return(i=Vr(s,0))!==s&&V(t,i),ca(r,e,Yt),!0}if(yr(i)||yr(u))return ca(r,e,Yt),!0;return!1}(r,e)){for(var u,o=t,f=-1,c=t-1;c>=0;--c){var v=O(r,a+2*c),l=C(v);if(!l)return;if(kr(l)||f===v)sr(r,a,t,c,!1),--t;else{if(yr(l))return void ca(r,e,Qt+2*o);f=v,u=l}}if(0===t)return j(f);if(1===t){var p=Vr(u,0);if(u!==p&&V(f,p))return;ca(r,e,Qt+2*o)}else if(o!==t){sa(r,n,t);var m=2*(o-t);la(r,e+i-m,m)}else s=!1,d=e+i}}function B(r,e){var n=e+1,t=ia(r,n),a=Qt+2+2*t,i=e+Qt,u=e+a-2,o=O(r,u),f=C(o);if(r.slice(e,e+a).join(" "),[].concat(Array(t)).map(function(e,n){return O(r,i+2*n)}),[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}),f){if(kr(f))return fa(r,e,bt),void la(r,e+a-2,2);if(yr(f)){for(var c=0;c<t;++c){var v=O(r,i+2*c),l=C(v);if(!l)return;var p=Vr(l,0);if(p!==l&&V(v,p))return}ca(r,e,a)}else{for(var m=!0,h=!1,g=!1,b=0;b<t;++b){var k=O(r,i+2*b),y=C(k);if(kr(y)){h=!0;break}0===lr(y)?m=!1:g=!0}if(h){var x=f;return(f=Cr(f,0))!==x&&V(o,f),void ca(r,e,a)}if(m){var _=f;return(f=Vr(f,0))!==_&&V(o,f),void ca(r,e,a)}if(g){for(var w=0,S=t-1;S>=0;--S){var E=O(r,i+2*S),A=C(E);yr(A)&&(sr(r,i,t,S,!0),--t,++w)}sa(r,e+1,t);var N=a-2*w;return la(r,e+N,a-N),r.slice(e,e+a).join(" "),void(1===t&&P(r,e,t,i,o))}if(1===t)return P(r,e,t,i,o);s=!1,d=e+a}}}function P(r,e,n,t,a){var i=O(r,t);ba(r,e,0,wt,a,i),f=!0}function H(r,e){var n=e+1,t=ia(r,n),a=Qt+2*t+2,i=e+Qt,u=e+a-2,o=O(r,u),f=C(o);if(r.slice(e,e+a).join(" "),[].concat(Array(t)).map(function(e,n){return O(r,i+2*n)}),[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}),f)if(kr(f)){for(var c=0;c<t;++c){var v=O(r,i+2*c),l=C(v);if(!l)return;var p=Vr(l,0);if(p!==l&&V(v,p))return}ca(r,e,a)}else{if(yr(f))return fa(r,e,bt),void la(r,e+a-2,2);for(var m=!0,h=!1,g=0;g<t;++g){var b=O(r,i+2*g),k=C(b);if(kr(k)){h=!0;break}0===lr(k)&&(m=!1)}if(h){var y=f;(f=Vr(f,0))!==y&&V(o,f),ca(r,e,a)}else if(m){var x=f;(f=Cr(f,0))!==x&&V(o,f),ca(r,e,a)}else s=!1,d=e+a}}function z(r,e){var n=e+1,t=ia(r,n),a=Qt+2*t+2,i=e+Qt,u=e+a-2,o=O(r,u),f=C(o);if(r.slice(e,e+a).join(" "),[].concat(Array(t)).map(function(e,n){return O(r,i+2*n)}),[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}),f)if(kr(f)){for(var c=0;c<t;++c){var v=O(r,i+2*c),l=C(v);if(!l)return;var p=Cr(l,0);if(p!==l&&V(v,p))return}ca(r,e,a)}else{if(yr(f))return fa(r,e,_t),void la(r,e+a-2,2);for(var m=!1,h=!0,g=!1,b=0;b<t;++b){var k=O(r,i+2*b),y=C(k);if(yr(y)){m=!0;break}kr(y)?g=!0:h=!1}if(m){var x=f;(f=Vr(f,0))!==x&&V(o,f),ca(r,e,a)}else if(h){var _=f;(f=Cr(f,0))!==_&&V(o,f),ca(r,e,a)}else if(g){Sa(r,d+Qt,t);var w=i+2*t-2;E(O(r,i)),E(O(r,w)),E(O(r,w)),E(O(r,w)),E(O(r,i)),E(O(r,i));for(var S=t;kr(E(O(r,w)));)w-=2,--S;if(O(r,w),E(O(r,w)),1===S){var A=O(r,i);ba(r,e,0,wt,o,A)}else sa(r,e+1,S),sa(r,w+2,o),la(r,w+4,2*(t-S))}else s=!1,d=e+a}}function J(r,e){var n=e+1,t=ia(r,n),a=Qt+2*t+2,i=e+Qt,u=e+a-2,o=O(r,u),f=C(o);if(r.slice(e,e+a).join(" "),[].concat(Array(t)).map(function(e,n){return O(r,i+2*n)}),[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}),f)if(yr(f)){for(var c=0;c<t;++c){var v=O(r,i+2*c),l=C(v);if(!l)return;var p=Cr(l,0);if(p!==l&&V(v,p))return}ca(r,e,a)}else{if(kr(f))return fa(r,e,_t),void la(r,e+a-2,2);for(var m=!1,h=!0,g=0;g<t;++g){var b=O(r,i+2*g),k=C(b);if(yr(k)){m=!0;break}kr(k)||(h=!1)}if(m){var y=f;(f=Cr(f,0))!==y&&V(o,f),ca(r,e,a)}else if(h){var x=f;(f=Vr(f,0))!==x&&V(o,f),ca(r,e,a)}else s=!1,d=e+Qt+2*t+2}}function $(r,e){var n=ia(r,e+1),t=e+Qt,a=Qt+2*n;if(r.slice(e,e+a).join(" "),[].concat(Array(n)).map(function(e,n){return O(r,t+2*n)}).join(", "),[].concat(Array(n)).map(function(e,n){return K(C(O(r,t+2*n)))}).join(", "),!n)return j(-1);for(var i=n,u=n-1;u>=0;--u){var o=O(r,t+2*u),f=C(o);if(!f)return;var c=L(f);if(c>=0){for(var v=0;v<n;++v)if(v!==u){var l=O(r,t+2*v),p=C(l);if(o===l)return V(o,Ur());var m=Vr(p,c);if(m!==p&&V(l,m))return}sr(r,t,n,u,!0),--n}}n<=1?ca(r,e,a):n!==i?(sa(r,e+1,n),la(r,t+2*n,2*(i-n))):2===n&&function(r,e){var n=e+Zt,t=O(r,e+Kt),a=O(r,n),i=C(t),u=C(a);if(!i||!u)return!0;if(t===a)return j(t),!0;var o=!1,f=L(i);if(f>=0){var s=u;if(s!==(u=Vr(u,f))&&V(a,u))return!0;o=!0}else{var c=L(u);if(L(u)>=0){var v=i;if((i=Vr(i,c))!==v&&V(t,i))return!0;o=!0}}o||G(i,u)||(o=!0);if(o)return ca(r,e,Yt),!0;return!1}(r,e)||(s=!1,d=e+a)}function W(r,e,n,t){E(r),E(e);var a=G(n,t);return n!==t&&V(e,a),a&&!br(n)&&w(r,e),a}function Q(e,n,t,a,i,u,o,s,c,v){return 0===s?(W(a,n,o,u),ca(r,e,Xt),f=!0,!0):!(!_r(u)||2!==fr(o)||lr(o)!==s)&&(ga(r,e,2,At,a,t,n),f=!0,!0)}function Y(r,e){var n=e+1,t=e+3,a=e+5,i=O(r,n),u=O(r,t),o=O(r,a),c=C(i),v=C(u),l=C(o);if(c&&v&&l){var p,m,h,g=c,b=v,k=l,y=0;do{++y,p=c,m=v,h=l,v=G(v,fe(c=G(c,re(l=G(l,fe(c,v)),v)),l))}while(c!==p||v!==m||l!==h);y>1&&(c!==g&&V(i,c),v!==b&&V(u,v),l!==k&&V(o,l),!(c&&v&&l))||(br(l)&&br(c)?ca(r,e,Gt):0===L(c)?(W(o,u,l,v),ca(r,e,Gt),f=!0):0===L(v)?(W(o,i,l,c),ca(r,e,Gt),f=!0):(s=!1,d=e+Gt))}}function Z(r,e){var n=e+1,t=e+3,a=e+5,i=O(r,n),u=O(r,t),o=O(r,a),f=C(i),c=C(u),v=C(o);if(f&&c&&v){var l=v;(v=G(v,ar(f,c)))!==l&&V(o,v),f&&c&&v&&(br(c)&&br(f)?ca(r,e,Gt):(s=!1,d=e+Gt))}}function rr(r,e){var n=ia(r,e+1);if(2!==n)return s=!1,void(d=e+Qt+2*n+2);var t=e+Kt,a=e+Zt,i=e+ea,u=O(r,t),o=O(r,a),c=O(r,i),v=C(u),l=C(o),p=C(c);if(v&&l&&p){if(u===o){var m=p;return(p=Vr(p,0))!==m&&V(c,p),void ca(r,e,Xt)}var h=L(v),g=L(l);if(h>=0&&g>=0){var b=p;return v===l?(p=Vr(p,0))!==b&&V(c,p):(p=X(p,0))!==b&&V(c,p),void ca(r,e,Xt)}if(kr(p))return ba(r,e,0,pt,u,o),void(f=!0);if(yr(p))return W(u,o,v,l),ca(r,e,Xt),void(f=!0);if(u===o){var k=p;return(p=Vr(p,0))!==k&&V(c,p),void ca(r,e,Xt)}if(!G(v,l)){var y=p;return(p=Cr(p,0))!==y&&V(c,p),void ca(r,e,Xt)}if(_r(p)){if(h>=0&&h<=1&&_r(l))return 0===h?ba(r,e,0,pt,o,c):(W(c,o,p,l),ca(r,e,Xt)),void(f=!0);if(g>=0&&g<=1&&_r(v))return 0===g?ba(r,e,0,pt,u,c):(W(c,u,p,v),ca(r,e,Xt)),void(f=!0)}if(0===h)return ba(r,e,0,St,c,o),void(f=!0);if(0===g)return ba(r,e,0,St,c,u),void(f=!0);s=!1,d=e+Xt}}function er(r,e){var n=ia(r,e+1);if(2!==n)return s=!1,void(d=e+Qt+2*n+2);var t=e+Kt,a=e+Zt,i=e+ea,u=O(r,t),o=O(r,a),c=O(r,i),v=C(u),l=C(o),p=C(c);if(v&&l&&p){if(br(v)&&br(l)){var m=p;return v===l?(p=Cr(p,0))!==m&&V(c,p):(p=Vr(p,0))!==m&&V(c,p),void ca(r,e,Xt)}if(kr(p))return W(u,o,v,l),ca(r,e,Xt),void(f=!0);if(yr(p))return ba(r,e,0,pt,u,o),void(f=!0);s=!1,d=e+Xt}}function tr(r,e){var n=e+1,t=e+3,a=e+5,i=O(r,n),u=O(r,t),o=O(r,a),c=C(i),v=C(u),l=C(o);if(c&&v&&l){var p=l;if(br(l)||(mr(c)<lr(v)?l=Vr(l,0):lr(c)>=mr(v)&&(l=Cr(l,0))),l===p||V(o,l))return kr(l)?(ka(r,e,gt,u,i),void(f=!0)):yr(l)?(ka(r,e,ht,i,u),void(f=!0)):kr(c)?(ka(r,e,wt,o,u),void(f=!0)):void(kr(v)?ca(r,e,Gt):(s=!1,d=e+Gt))}}function ir(r,e){var n=e+1,t=e+3,a=e+5,i=O(r,n),u=O(r,t),o=O(r,a),c=C(i),v=C(u),l=C(o);if(c&&v&&l){var p=l;if(mr(c)<=lr(v)?l=Vr(l,0):lr(c)>mr(v)&&(l=Cr(l,0)),l===p||!V(o,l)){var m=kr(l),h=!m&&yr(l);if(m)return ka(r,e,ht,u,i),void(f=!0);if(h)return ka(r,e,gt,i,u),void(f=!0);if(_r(l)&&mr(c)<=1&&mr(v)<=1){if(_r(c)&&kr(v))return ka(r,e,pt,i,o),void(f=!0);if(_r(c)&&v===Rr(1))return W(i,o,c,l),ca(r,e,Gt),void(f=!0);if(_r(v)&&c===Rr(1))return W(u,o,v,l),ca(r,e,Gt),void(f=!0)}s=!1,d=e+Gt}}}function or(r,e){var n=e+1,t=ia(r,n);if(2!==t||!function(r,e){var n=e+Zt,t=e+ea,a=O(r,e+Kt),i=O(r,n),u=O(r,t),o=C(a),f=C(i),s=C(u);if(!o||!f||!s)return!1;var c,v,l,d=o,p=f,m=s,h=0;do{++h,c=o,v=f,l=s,f=G(f,fe(s=G(s,re(o,f)),o=G(o,fe(s,f))))}while(o!==c||f!==v||s!==l);if(h>1&&(o!==d&&V(a,o),f!==p&&V(i,f),s!==m&&V(u,s),!o||!f||!s))return!1;var g=L(o),b=L(f);if(g>=0&&b>=0)return ca(r,e,Xt),!0;if(g>=0&&Q(e,i,a,u,o,f,s,g,"A","B"))return!0;if(b>=0&&Q(e,a,i,u,f,o,s,b,"B","A"))return!0;return!1}(r,e)){var a=Qt+2*t+2,i=e+Qt,u=e+a-2,o=O(r,u),f=C(o);if(r.slice(e,e+a).join(" "),[].concat(Array(t)).map(function(e,n){return O(r,i+2*n)}).join(", "),[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}).join(", "),f){for(var c=Rr(0),v=0,l=0,p=0;p<t;++p){var m=i+2*p,h=O(r,m),g=C(h),b=L(g);b>=0&&(++v,l+=b),c=re(c,g)}var k=f;if(v===t)return(f=X(f,l))!==k&&V(o,f),void ca(r,e,a);if((f=G(c,f))===k||!V(o,f)){var y=l?fe(f,Rr(l)):f;v=0,l=0;for(var x=lr(y),w=mr(y),S=-1,A=0;A<t;++A){var N=O(r,i+2*A),D=C(N),j=L(D);if(j>=0)++v,l+=j;else{var M=Or(D,x);if((M=Cr(D,w))!==D&&V(N,M))return;(j=L(M))>=0?(++v,l+=j):-1===S&&(S=N)}}[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}).join(" ");var T=t-v+(0===l?0:1);if(1===T){if(l>0){var q=X(f,l);q!==f&&V(o,q)}else W(o,S,f,E(S,!0));ca(r,e,a)}else if(v>1||1===v&&0===l){for(var R=a-2*(v-(l>0?1:0)),I=t-1;I>=0&&v;--I){var U=i+2*I,F=O(r,U),B=C(F);if(br(B)){if(1===v&&0!==l){var P=_(void 0,l,!1,!1,!0);sa(r,i+2*I,P);break}sr(r,i,t,I,!0),--t,--v}}sa(r,e+1,t),la(r,e+R,a-R),r.slice(e,e+a).join(" ")}else s=!1,d=e+a}}}}function sr(r,e,n,t,a){var i=n;a&&++i;for(var u=t+1;u<i;++u){var o=e+2*u,f=e+2*(u-1);r[f]=r[o],r[f+1]=r[o+1]}}function cr(r,e){var n=e+1,t=ia(r,n);if(2!==t||!function(r,e){var n=e+Zt,t=e+ea,a=O(r,e+Kt),i=O(r,n),u=O(r,t),o=C(a),f=C(i),s=C(u);if(!o||!f||!s)return!0;var c,v,l,d=o,p=f,m=s,h=0;do{++h,c=o,v=f,l=s,s=G(s,nr(o,f)),o=G(o,ur(s,f)),f=G(f,ur(s,o))}while(o!==c||f!==v||s!==l);if(h>1&&(o!==d&&V(a,o),f!==p&&V(i,f),s!==m&&V(u,s),!o||!f||!s))return!0;if(br(s)&&br(o))return ca(r,e,Xt),!0;return!1}(r,e)){var a=Qt+2*t+2,i=e+Qt,u=e+a-2,o=O(r,u),f=C(o);if(r.slice(e,e+a).join(" "),[].concat(Array(t)).map(function(e,n){return O(r,i+2*n)}).join(", "),[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}).join(", "),f){for(var c=Rr(1),v=0,l=1,p=0;p<t;++p){var m=O(r,i+2*p),h=C(m),g=L(h);g>=0&&(++v,l*=g),c=nr(c,h)}var b=f;if(v===t)return(f=X(f,l))!==b&&V(o,f),void ca(r,e,a);if(0===l)return(f=X(f,0))!==b&&V(o,f),void ca(r,e,a);if((f=G(c,f))===b||!V(o,f)){if(kr(f))return fa(r,e,bt),void la(r,e+a-2,2);ur(f,l);for(var k=1===l?f:ur(f,Rr(l)),y=lr(k),x=mr(k),w=!1,S=-1,A=0;A<t;++A){var N=O(r,i+2*A),D=C(N),j=L(D);if(0===j&&(w=!0),j<0){!w&&xr(D)&&(w=!0);var M=Or(D,y);if((M=Cr(D,x))!==D&&V(N,M))return;(j=L(M))>=0?(++v,l+=j):-1===S&&(S=N)}}[].concat(Array(t)).map(function(e,n){return K(C(O(r,i+2*n)))}).join(" ");var T=t-v+(1===l?0:1);if(1===T){if(1!==l)if(w){var q=G(f,Fr(l));q!==f&&V(o,q)}else{var R=X(f,l);R!==f&&V(o,R)}else W(o,S,f,E(S,!0));ca(r,e,a)}else if(v>1){for(var I=a-2*(v-1),U=t-1;U>=0&&v;--U){var F=O(r,i+2*U),B=C(F);if(br(B)){if(1===v){var P=_(void 0,l,!1,!1,!0);sa(r,i+2*U,P)}else sr(r,i,t,U,!0),--t;--v}}var H=a-I;sa(r,e+1,t),la(r,e+I,H),r.slice(e,e+a).join(" ")}else s=!1,d=e+a}}}}function vr(r,e){for(var n=ia(r,e+1),t=0;t<n;++t){var a=O(r,e+Qt+2*t),i=E(a,!0),u=Vr(i,0);i!==u&&V(a,u)}ca(r,e,Qt+2*n)}function dr(r,e){for(var n=ia(r,e+1),t=0;t<n;++t){var a=O(r,e+Qt+2*t),i=E(a,!0),u=Cr(i,0);i!==u&&V(a,u)}ca(r,e,Qt+2*n)}function pr(r,e){var n=e+Kt,t=e+Zt,a=O(r,n),i=O(r,t),u=C(a),o=C(i);if(u&&o){if(a===i)return j(a),void(c=!0);if(kr(u)){var f=o;return(o=Vr(o,0))!==f&&V(i,o),void ca(r,e,Yt)}if(kr(o)){var v=u;return(u=Vr(u,0))!==v&&V(a,u),void ca(r,e,Yt)}if(yr(u)){var l=o;return(o=Cr(o,0))!==l&&V(i,o),void ca(r,e,Yt)}if(yr(o)){var p=u;return(u=Cr(u,0))!==p&&V(a,u),void ca(r,e,Yt)}s=!1,d=e+Yt}}function hr(r,e){var n=ia(r,e+1);if(2!==n)return s=!1,void(d=e+Qt+2*n);var t=e+Kt,a=e+Zt,i=O(r,t),u=O(r,a),o=C(i),c=C(u);if(o&&c)if(i!==u){if(kr(o)){var v=c;return(c=Cr(c,0))!==v&&V(u,c),void ca(r,e,Yt)}if(kr(c)){var l=o;return(o=Cr(o,0))!==l&&V(i,o),void ca(r,e,Yt)}if(yr(o)){var p=c;return(c=Vr(c,0))!==p&&V(u,c),void ca(r,e,Yt)}if(yr(c)){var m=o;return(o=Vr(o,0))!==m&&V(i,o),void ca(r,e,Yt)}if(o===c&&2===fr(o))return w(i,u),void(f=!0);s=!1,d=e+Yt}else ca(r,e,Yt)}function gr(r,e){var n=e+Kt,t=e+Zt,a=O(r,n),i=O(r,t),u=C(a),o=C(i);if(u&&o)if(a!==i)if(kr(u))ca(r,e,Yt);else{if(yr(u)){var f=o;return f!==(o=Vr(f,0))&&V(i,o),void ca(r,e,Yt)}if(kr(o)){var c=u;return c!==(u=Cr(c,0))&&V(a,u),void ca(r,e,Yt)}yr(o)?ca(r,e,Yt):(s=!1,d=e+Yt)}else ca(r,e,Yt)}function Er(r,e){var n=e+Kt,t=e+Zt,a=O(r,n),i=O(r,t),u=C(a),o=C(i);if(u&&o){var f=u;f!==(u=Vr(f,0))&&V(a,u);var s=o;s!==(o=Cr(s,0))&&V(i,o),ca(r,e,Yt)}}}(r,e,0,0,0,i)}var ku=65535;function yu(r,e,n,t,a,i,u,c,v,l,d,p,m,h,g){var b;"number"==typeof l&&(d=l,l=void 0);var k=L(d="number"==typeof d?Rr(d):void 0===d?Ir(f,s):Kr(d));if("string"==typeof l||k<0||m){var y=void 0===l;y?l="__"+u():"_"===l[0]&&"_"===l[1]&&l==="__"+parseInt(l.slice(2),10)&&o("Dont use `__xxx` as var names, that structure is preserved for internal/anonymous var names");var x=Ve(r,l,b=e.length);x>=0&&(g&&g("CONSTRAINT_VARS_SHOULD_BE_DECLARED; Dont declare a var ["+l+"] after using it",l,x),o("CONSTRAINT_VARS_SHOULD_BE_DECLARED; Dont declare a var ["+l+"] after using it",l,x)),e.push(l),n.push(d),c[b]=!y&&!v()}if(k>=0&&!m){var _=wu(a,k);b>=0&&i(b,_,"$addvar"),b=_}if(p)switch(t[b]=p,p.valtype){case"list":case"max":case"mid":case"min":case"minMaxCycle":case"naive":case"splitMax":case"splitMin":break;default:g&&g("implement me (var mod ["+p.valtype+"])"),o("implement me (var mod ["+p.valtype+"])")}return h?b:m?l:void 0}function xu(r,e,n,t,a){a||(t=n(t)),n(t),n(t);var i=e[t];return void 0!==i?Rr(i):r[t]}function _u(r,e,n,t,a,i,u,f,s,c){if(a(i),a(i),!u){if(s)return;o("Cannot set to empty domain")}!function(r,e,n,t,a,i,u){xu(r,e,n,t,!1)}(r,e,a,i);var v=L(u);return v>=0?function(r,e,n,t){if(void 0!==r[n]){if(r[n]===t)return;o("Cant update a constant (only to an empty domain, which should be handled differently)")}var a=wu(r,t);e(n,a,"$setDomain; because var is now constant "+t)}(e,t,i,v):function(r,e,n,t,a,i,u){u?n[a]=void 0:a=t(a);a<r.length&&(r[a]=i)}(r,0,n,a,i,u,f)}function wu(r,e){var n=r["v"+e];return n>=0?n:(n=ku-r._count++,r["v"+e]=n,r[n]=e,n)}function Su(){var r=0,e=[],n=Ae(),t=[],a={_count:0},i={},u=[],f=[],s=function(r,e,n,t,a,i,u,o){n[i]!==u&&(n[i]=u,r[i]=!1,!e[u]&&e[i]&&(e[u]=e[i]))}.bind(void 0,t,f,i,u,a),c=function(r,e){for(var n=r[e];void 0!==n;)n===e&&o("alias is itself?",n,e),n=r[e=n];return e}.bind(void 0,i),v=function(r,e,n,t,a){var i=qe(r,n);return!a&&i<0&&o("cant use this on constants or vars that have not (yet) been declared",n,i),!t&&i>=0&&(i=e(i)),i}.bind(void 0,n,c),l=[],d=!1;return{varTrie:n,varNames:e,domains:t,valdist:f,aliases:i,solveStack:u,leafs:[],input:{varstrat:"default",valstrat:"default",dsl:""},ml:void 0,mapping:void 0,addVar:yu.bind(void 0,n,e,t,f,a,s,function(e){return++r},l,function(r){return d}),getVar:v,name2index:v,addAlias:s,getAlias:c,getDomain:xu.bind(void 0,t,a,c),setDomain:_u.bind(void 0,t,a,i,s,c),isConstant:function(r){return void 0!==a[r]},freezeTargets:function(r){d&&o("Only one `targets` directive supported"),d=!0,l.fill(!1),r.forEach(function(r){return l[v(r,!0)]=!0})},targeted:l}}function Eu(r,e,n,t,a,i,o,f,s,c){var v=u();v.time("- run_cycle #"+s),v.time("- minimizer cycle #"+s);var l=bu(r,c);if(v.timeEnd("- minimizer cycle #"+s),l===g)return l;if(l===b)return l;v.time("- deduper cycle #"+s);var d=hi(r,c);if(v.timeEnd("- deduper cycle #"+s),d<0)l=b;else{v.time("- cutter cycle #"+s);var p=pi(r,c,!1);v.timeEnd("- cutter cycle #"+s),p>1||d?l=h:p<0&&(l=b)}return v.timeEnd("- run_cycle #"+s),l}function Au(r,e,n,a){u().time("createSolution()");var i=n.flattened,f=void 0!==i&&i,s=r.varNames,c=r.domains,v=r.solveStack,l=r.getAlias,d=r.targeted,p=r.getDomain,m=r.setDomain;function h(r,n){if(n||(r=l(r)),e){var t=e["$"+r.toString(36)+"$"];if("number"==typeof t)return Rr(t);if(void 0!==t)return Kr(t)}return p(r,!0)}function g(r,n,t,a){if(a||p(r),p(r),t||(r=l(r)),m(r,n,!0,!1,a),e){var i="$"+r.toString(36)+"$";if(void 0!==e[i]){var u=L(n);e[i]=u>=0?u:Pr(n)}}}function b(e,n){var t=l(e),a=h(t,!0),i=L(a);if(i<0){n&&(a=n);var u=r.valdist[e];if(u)switch(u.valtype){case"list":u.list.some(function(r){return q(a,r)&&(i=r)>=0}),i<0&&(i=lr(a));break;case"max":i=mr(a);break;case"min":case"naive":i=lr(a);break;case"mid":i=vr(a);break;case"markov":case"minMaxCycle":case"splitMax":case"splitMin":o("implement me (var mod) ["+u.valtype+"]"),i=lr(a);break;default:o("Unknown dist name: ["+u.valtype+"]",u)}else i=lr(a);g(e,Rr(i),!0)}return i}c.length<50&&t(e).replace(/\n/g,""),c.length<50&&c.map(function(e,n){return"{index="+n+",name="+r.varNames[n]+","+K(r.getDomain(n))+"}"}).join(", "),c.length<50||c.map(function(r,e){return e+": "+K(r)+", "+K(p(e))+", "+K(h(e))}),function(){for(var e=v.reverse(),n=0;n<e.length;++n)(0,e[n])(c,b,h,g),c.length<50&&c.map(function(e,n){return"{index="+n+",name="+r.varNames[n]+","+K(r.getDomain(n))+"}"}).join(", ");c.length<50||c.map(function(r,e){return e+": "+K(r)+", "+K(p(e))+", "+K(h(e))})}(),c.forEach(function(r,e){return!1===c[e]&&l(e),void l(e)}),function(){for(var e=0;e<c.length;++e)if(f||r.valdist[e])m(e,Rr(b(e)),!0);else{var n=h(e);L(n)>=0&&m(e,n,!0)}}(),c.length<50||c.map(function(r,e){return e+": "+K(r)+", "+K(p(e))+", "+K(h(e))}),c.forEach(function(r,e){return!1===r&&l(e),void l(e)}),function(){for(var r=0;r<c.length;++r)if(!1===c[r]){var e=b(l(r));m(r,Rr(e),!0)}}(),c.length<50||c.map(function(r,e){return e+": "+K(r)+", "+K(p(e))+", "+K(h(e))});var k=function(){for(var r={},e=0;e<s.length;++e)if(d[e]){var n=s[e],t=h(e),a=L(t);r[n]=t=a>=0?a:f?lr(t):Pr(t)}return r}();return u().timeEnd("createSolution()"),k}var Nu={solve:function(r,e,n,t){void 0===n&&(n={}),void 0===t&&(t={log:1,vars:"all"}),t.logger&&i(t.logger);var a=u();a.log("<pre>"),a.time("</pre>");var f=function(r,e,n,t){var a=u();a.log("<pre-solving>"),a.time("</pre-solving total>");var i=n.hashNames,f=void 0===i||i,s=n.debugDsl,c=void 0!==s&&s,v=n.indexNames,l=void 0!==v&&v,d=n.groupedConstraints,p=void 0===d||d;void 0===n.hashNames&&(n.hashNames=f),void 0===n.debugDsl&&(n.debugDsl=c),void 0===n.indexNames&&(n.indexNames=l),void 0===n.groupedConstraints&&(n.groupedConstraints=p);var m=Su();r.slice(0,1e3);var k,y,x,_=function(r,e,n){void 0===n&&(n={});var t=n.singleCycle,a=void 0!==t&&t,i=n.repeatUntilStable,o=void 0===i||i,f=u();f.time("- dsl->ml"),gu(r,e);var s,c=e.ml;if(f.timeEnd("- dsl->ml"),f.log("Parsed dsl ("+r.length+" bytes) into ml ("+c.length+" bytes)"),n.printDslBefore){var v=Za(e.ml,e),l=si(c,e,v,n);"function"==typeof n.printDslBefore?n.printDslBefore(l):(f.log("#### <DSL> after parsing before crunching"),f.log(l),f.log("#### </DSL>"))}if(a){if(f.time("- first minimizer cycle (single loop)"),s=bu(c,e,0,0,0,!o),f.timeEnd("- first minimizer cycle (single loop)"),s!==b){f.time("- deduper cycle #");var d=hi(c,e);f.timeEnd("- deduper cycle #"),d>=0&&(f.time("- cutter cycle #"),pi(c,e,!o),f.timeEnd("- cutter cycle #"))}}else{var p=0;f.time("- all run cycles");do{s=Eu(c,0,0,0,0,0,0,0,p++,e)}while(s===h);f.timeEnd("- all run cycles")}return s}(r,m,n);if(_===b||(a.time("ml->dsl"),k=Za(m.ml,m),y=si(m.ml,m,k,{debugDsl:!1,hashNames:!0}),a.timeEnd("ml->dsl")),a.timeEnd("</pre-solving total>"),_===b&&a.log("REJECTED"),(_===g||_!==b&&!da(m.ml))&&(a.time("- generating early solution"),x=Au(m,null,n),a.timeEnd("- generating early solution")),_!==b&&(y&&y.length<1e3||n.printDslAfter)){var w=si(m.ml,m,k,n),S="\nResult dsl (debugDsl="+c+", hashNames="+f+", indexNames="+l+"):\n"+w;"function"==typeof n.printDslAfter?n.printDslAfter(S):(a.log("#### <DSL> after crunching before FD"),a.log(S),a.log("#### </DSL>"))}if(x)return a.log("<solved without fdq>"),x;if(_===b)return a.log("<rejected without fdq>"),"rejected";"throw"===m.input.varstrat&&o("Forcing a choice with strat=throw"),a.log("\n\nSolving remaining problem through fdq now..."),a.log("<FD>"),a.time("</FD>");var E=e(y,t);return a.timeEnd("</FD>"),a.log("\n"),a.log("fd result:","string"==typeof E?E:"SOLVED"),E&&"string"!=typeof E?(a.log("<solved after fdq>"),Array.isArray(E)?E.map(function(r){return Au(m,r,n)}):Au(m,E,n)):(a.log("<"+E+" during fdq>"),"rejected")}(r,e,n,t);return a.timeEnd("</pre>"),f}};i({log:Cu,warn:Cu,error:Cu,trace:Cu,time:Cu,timeEnd:Cu});var Du={log:0,logger:Cu,beforeSpace:Cu,afterSpace:Cu,_debug:!1,_debugConfig:!1,_debugSpace:!1,_debugSolver:!1},Ou={log:0,debugDsl:!1,printDslBefore:Cu,printDslAfter:Cu,indexNames:!1,hashNames:!1,groupConstraints:!0};function Cu(){return!1}return{FDO:ct,FDP:Nu,setTerm:i,solve:function(r,n,t){return void 0===n&&(n={}),void 0===t&&(t={}),Nu.solve(r,ct.solve,e({},Ou,n),e({},Du,t))}}});
